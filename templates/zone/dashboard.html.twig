{% extends 'base.html.twig' %}

{% block title %}{#Genset {{smartMod.name|capitalize}} #}Home{% endblock %}

{% block stylesheets %}
    {#{{ encore_entry_link_tags('app') }}#}
    <link href="/plugins/daterangepicker/daterangepicker.css" rel="stylesheet" />

    <!-- Sweet Alert -->
    <link href="/plugins/sweet-alert2/sweetalert2.min.css" rel="stylesheet" type="text/css">

    <!-- DataTables -->
    <link href="/plugins/datatables/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css" />
    <link href="/plugins/datatables/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css" />
    <!-- Responsive datatable examples -->
    <link href="/plugins/datatables/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css" /> 

{% endblock %}
        
{% block breadcrumbItem %}
<li class="breadcrumb-item"><a href="javascript:void(0);">{{zone.name}}</a></li>
{# {% if smartMod %}<li class="breadcrumb-item"><a href="javascript:void(0);">{{smartMod.name}}</a></li>{% endif %} #}
<li class="breadcrumb-item active">Home</li>
{% endblock %}

{% block pageTitle %}Home{% endblock %}

{% block body %}
    <!-- Nav tabs -->
    <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#overview" role="tab">Overview</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#historical" role="tab">Historicals</a>
        </li>
        {% if zone.type == 'No PUE Calculation' %}
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#energybilling" role="tab">Billing</a>
        </li>
        {% endif %}                                                
        {# <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#alarm" role="tab">Alarm</a>
        </li> #}
        
    </ul>

    <!-- Tab panes -->
    <div class="tab-content">
        
        <div class="tab-pane active p-3" id="overview" role="tabpanel">
            {# {{dump(type)}} #}
            {% if zone.type == 'PUE Calculation' %}
                <div class="row">
                    <div class="col-12 col-sm-9">
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="header-title mt-0 mb-4"></h4>
                                        <div class="chart-demo">
                                            <div id="apex_mixed_pue_power_overview" class="apex-charts"></div>
                                        </div>                                        
                                    </div><!--end card-body-->
                                </div><!--end card-->
                            </div><!--end col-->                            
                        </div><!--end row-->
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="header-title mt-0 mb-4"></h4>
                                        <div class="chart-demo">
                                            <div id="apex_mixed_climate_overview" class="apex-charts"></div>
                                        </div>                                        
                                    </div><!--end card-body-->
                                </div><!--end card-->
                            </div><!--end col-->
                        </div><!--end row-->
                    </div>

                    <div class="col-12 col-sm-3">
                        
                        <div class="card crm-data-card bg-soft-warning">
                            <div class="card-body"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-spa bg-soft-warning rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="instPUE">0</span></h3>
                                        <p class="text-white font-weight-bold mb-0">PUE</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card--> 
                        
                        <div class="card crm-data-card bg-soft-blue">
                            <div class="card-body"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-flash bg-soft-blue rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="it_power">0</span> kW</h3>
                                        <p class="text-white font-weight-bold mb-0">IT Power</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card--> 
                        <div class="card crm-data-card bg-soft-blue">
                            <div class="card-body"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-flash bg-soft-blue rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="datacenter_power">0</span> kW</h3>
                                        <p class="font-weight-bold text-white mb-0">DataCenter</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card--> 
                        
                        {# <div class="float-left mt-0">
                        </div> #}
                        <small>Last update <span id="update">{{lastDate}}</span></small>

                        <div class="card crm-data-card bg-soft-pink">
                            <div class="card-body text-center"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-thermometer-lines bg-soft-pink rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="temp_indoor">{{inTemp}}</span> °C</h3>
                                        <p class="text-white font-weight-bold mb-0">Temperature Indoor</p>
                                    </div><!-- end col-->
                                
                                </div>
                            </div><!--end card-body--> 
                        </div><!--end card-->

                        <div class="card crm-data-card bg-soft-pink">
                            <div class="card-body text-center"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-thermometer-lines bg-soft-pink rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="temp_outdoor">{{outTemp}}</span> °C</h3>
                                        <p class="text-white font-weight-bold mb-0">Temperature Outdoor</p>
                                    </div><!-- end col-->
                                </div><!--end card-body--> 
                                
                                </div>
                        </div><!--end card-->

                        <div class="card crm-data-card bg-soft-success">
                            <div class="card-body text-center"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-opacity bg-soft-success rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="hum_indoor">{{inHum}}</span> %</h3>
                                        <p class="text-white font-weight-bold mb-0">Humidity Indoor</p>
                                    </div><!-- end col-->
                                    
                                </div>
                            </div><!--end card-body--> 
                        </div><!--end card-->

                        <div class="card crm-data-card bg-soft-success">
                            <div class="card-body text-center"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-opacity bg-soft-success rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="hum_outdoor">{{outHum}}</span> %</h3>
                                        <p class="text-white font-weight-bold mb-0">Humidity Outdoor</p>
                                    </div><!-- end col-->
                                
                                </div>
                            </div><!--end card-body--> 
                        </div><!--end card-->                        
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_pue_energy_overview" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->

                {# <div class="row ">
                    <div class="col">
                        <div class="card crm-data-card">
                            <div class="card-body"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-spa rounded-circle bg-soft-primary"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8">
                                        <h3 class="text-primary"><span id="instPUE">0</span></h3>
                                        <p class="text-muted font-14 mb-0">Instant PUE</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card-->                                      
                    </div>
                    <div class="col">
                        <div class="card crm-data-card">
                            <div class="card-body"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">{ mdi mdi-spa }
                                            <i class="mdi mdi-spa rounded-circle bg-soft-success"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8">
                                        <h3 class="text-success"><span id="intPUE">0</span></h3>
                                        <p class="text-muted font-14 mb-0">Interval PUE</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card-->                                      
                    </div>
                </div> #}
            {% elseif zone.type == 'No PUE Calculation' %}
                <div class="row">
                    <div class="col-12 col-sm-9">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_PSCosfi_overview" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div>

                    <div class="col-12 col-sm-3">
                        <div class="card crm-data-card bg-soft-blue ">
                            <div class="card-body mt-2 mb-2"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-flash bg-soft-blue rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="p_overview">0</span> W</h3>
                                        <p class="text-white font-weight-bold mb-0">Current Power</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card--> 
                        
                        <div class="card crm-data-card bg-soft-blue ">
                            <div class="card-body mt-2 mb-2"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-flash bg-soft-warning rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="ea_overview">0</span> kWh</h3>
                                        <p class="text-white font-weight-bold mb-0">This month consumption</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card--> 

                        <div class="card crm-data-card bg-soft-pink mt-4">
                            <div class="card-body mt-2 mb-2"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-spa bg-soft-pink rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="emission_overview">0</span> kgCO<sub>2</sub></h3>
                                        <p class="font-weight-bold text-white mb-0">This Month Carbon Footprint</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card--> 
                        
                        {# <div class="float-left mt-0">
                        </div> #}
                        <small>Last update <span id="update">Y-m-d HH:mm:ss</span></small>
                   
                    </div>
                </div>

                <div class="row">
                    <div class="col-12 col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Active Energy Flow</h4>
                                <div class="">
                                    <div id="apex_pie_active_energy_flow_overview" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->

                    <div class="col-12 col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Reactive Energy Flow</h4>
                                <div class="">
                                    <div id="apex_pie_reactive_energy_flow_overview" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div>
                </div>
                
                {# <div class="row">
                    <div class="col-12 col-sm-6">
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="header-title mt-0 mb-4">Active Energy Flow</h4>
                                        <div class="">
                                            <div id="apex_pie_active_energy_flow_overview" class="apex-charts"></div>
                                        </div>                                        
                                    </div><!--end card-body-->
                                </div><!--end card-->
                            </div><!--end col-->
                        </div>
                        <div class="row">    
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="header-title mt-0 mb-4">Reactive Energy Flow</h4>
                                        <div class="">
                                            <div id="apex_pie_reactive_energy_flow_overview" class="apex-charts"></div>
                                        </div>                                        
                                    </div><!--end card-body-->
                                </div><!--end card-->
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-sm-6">
                        <div class="row">
                            <div class="col">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="header-title mt-0 mb-4"></h4>
                                        <div class="table-responsive shopping-cart">
                                           
                                            <table class="table mb-0">
                                                <thead>
                                                    <tr>
                                                        <th class="text-center">P (kW)</th>                                                        
                                                        <th class="text-center">S (kVA)</th>                                                        
                                                        <th class="text-center">CosPhi </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td class="text-center"><span id="p_overview">0.00</span></td>
                                                        <td class="text-center"><span id="ea_overview">0.00</span></td>
                                                        <td class="text-center"><span id="emission_overview">0.00</span></td>                                                        
                                                                                            
                                                    </tr>
                                                    { {% for smartMod in zone.smartMods %}
                                                        {% if smartMod.modType ==  'Load Meter' %}
                                                        <tr>
                                                            <td>
                                                                <p class="d-inline-block align-middle mb-0 product-name">{{smartMod.name}}</p> 
                                                            </td>
                                                            <td class="text-center"><span id="p_{{smartMod.id}}_overview">0.00</span></td>
                                                            <td class="text-center"><span id="s_{{smartMod.id}}_overview">0.00</span></td>
                                                            <td class="text-center"><span id="fp_{{smartMod.id}}_overview">0.00</span></td>                                                        
                                                                                                
                                                        </tr>
                                                        {% endif %}
                                                    {% endfor %} }
                                                    
                                                </tbody>
                                            </table>
                                        </div><!--end re-table-->                                        
                                    </div><!--end card-body-->
                                </div><!--end card-->
                                
                                <div class="row float-right">
                                    <small>Last update <span id="update"> YYYY-MM-DD HH:mm:ss</span></small>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="header-title mt-0 mb-4"></h4>
                                        <div class="chart-demo">
                                            <div id="apex_mixed_PSCosfi_overview" class="apex-charts"></div>
                                        </div>                                        
                                    </div><!--end card-body-->
                                </div><!--end card-->
                            </div><!--end col-->
                        </div><!--end row-->
                    </div>
                </div> #}

            {% elseif zone.type == 'Air Conditioner' %}
                {% if zone.smartMods|length > 0 %}
                <div class="row">
                    {% for smartMod in zone.smartMods %}
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-3">{{smartMod.name}}</h4>
                                <div class="table-responsive">
                                    <table class="table mb-0">                                        
                                        <tbody>
                                            <tr>
                                                <td class="border-top-0">
                                                    <!-- <i class="data-icon mdi mdi-thermometer-lines bg-soft-pink rounded-circle mr-1"></i> -->
                                                    <span class="text-info">Unit State</span>
                                                </td>
                                                <td class="border-top-0">
                                                    <span class="badge badge-boxed font-14" id="uovsl_0_{{loop.index}}">-</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <!-- <i class="data-icon mdi mdi-thermometer-lines bg-soft-pink rounded-circle mr-1"></i> -->
                                                    <span class="text-info">Unit State</span>
                                                </td>
                                                <td>
                                                    <span class="badge badge-boxed font-14" id="dpstrv_0_{{loop.index}}_1013">-</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <!-- <i class="data-icon mdi mdi-thermometer-lines bg-soft-pink rounded-circle mr-1"></i> -->
                                                    <span class="text-info">Return Air Temperature</span>
                                                </td>
                                                <td>
                                                    <span class="badge badge-boxed font-14 badge-soft-warning"><span id="dpstrv_0_{{loop.index}}_1192">-</span> °C</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <!-- <i class="mdi mdi-opacity bg-soft-success rounded-circle mr-1"></i> -->
                                                    <span class="text-info">Return Air Humidity</span>
                                                </td>
                                                <td>
                                                    <span class="badge badge-boxed font-14 badge-soft-warning"><span id="dpstrv_0_{{loop.index}}_1194">-</span> %rH</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <!-- <img src="/images/widgets/project3.jpg" alt="" class="thumb-sm rounded-circle mr-1"> -->
                                                    <span class="text-info">Compressor 1</span>
                                                </td>
                                                <td>
                                                    <span class="badge badge-boxed font-14" id="dpstrv_0_{{loop.index}}_4403">-</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <!-- <img src="/images/widgets/project3.jpg" alt="" class="thumb-sm rounded-circle mr-1"> -->
                                                    <span class="text-info">Compressor 2</span>
                                                </td>
                                                <td>
                                                    <span class="badge badge-boxed font-14" id="dpstrv_0_{{loop.index}}_4503">-</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <!-- <img src="/images/widgets/project3.jpg" alt="" class="thumb-sm rounded-circle mr-1"> -->
                                                    <span class="text-info">Fan speed 1</span>
                                                </td>
                                                <td>
                                                    <span class="badge badge-boxed font-14 badge-soft-warning"><span id="dpstrv_0_{{loop.index}}_6932">-</span> %</span>
                                                </td>
                                            </tr>
                                            
                                        </tbody>
                                    </table> <!--end row-->
                                </div><!--end table-responsive-->                          
                            </div><!--end card-body-->                                                                                                        
                        </div><!--end card-->
                    </div><!--end col-->
                    {% endfor %}
                </div><!--end row-->
                <div class="row ml-2">
                    <small>Last update <span id="update">{{lastDate}}</span></small>
                </div>
                
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Unit 1-1</h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_unit_1-1_overview" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Unit 1-2</h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_unit_1-2_overview" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->
                {% endif %}

            {% elseif zone.type == 'AVR' %}
                <div class="row">
                    <div class="col-12 col-sm-9">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_voltage_overview" class="apex-charts"></div>
                                </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div>

                    <div class="col-12 col-sm-3">
                        <div class="card crm-data-card bg-soft-blue ">
                            <div class="card-body mt-2 mb-2">
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-flash bg-soft-blue rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="vr_overview">-</span> V</h3>
                                        <p class="text-white font-weight-bold mb-0">Phase R</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->
                            </div><!--end card-body-->
                        </div><!--end card-->

                        <div class="card crm-data-card bg-soft-warning ">
                            <div class="card-body mt-2 mb-2">
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-flash bg-soft-warning rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="vs_overview">-</span> V</h3>
                                        <p class="text-white font-weight-bold mb-0">Phase S</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->
                            </div><!--end card-body-->
                        </div><!--end card-->

                        <div class="card crm-data-card bg-soft-pink mt-4">
                            <div class="card-body mt-2 mb-2">
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-flash bg-soft-pink rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="vt_overview">-</span> V</h3>
                                        <p class="text-white font-weight-bold mb-0">Phase T</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->
                            </div><!--end card-body-->
                        </div><!--end card-->

                        {# <div class="float-left mt-0">
                        </div> #}
                        <small>Last update <span id="update">Y-m-d HH:mm:ss</span></small>

                    </div>
                </div>

            {% elseif zone.type == 'Genset' %}
                <div class="row">
                    <div class="col-sm-3 col-12">
                        <div class="card">
                            <div class="card-body">
                                <p class=" float-right"><span id="genset-status" class="badge badge-danger">STOP</span></p>
                                <div id="fuel_level" class="gauge text-center mt-0"></div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                        <div class="float-right mt-0"><small>Last update <span id="last_update">Y-m-d HH:mm:ss</span></small></div>
                    </div><!--end col-->

                    {# Conso Fuel du mois #}
                    <div class="col-sm-3 col-12">
                        <div class="card bg-soft-blue">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-12 align-self-center">
                                        <div class="">
{#                                            <h4 class="mt-0 header-title">This Month Revenue</h4>#}
                                            <h4 class="mt-0 text-white"><span id="conso-fuel-value">0.0</span> L | <span id="conso-fuel-xaf-value">0</span> XAF</h4>
                                            <p class="mb-0 text-muted">Fuel consumption of This Month</p>
                                        </div>
                                    </div><!--end col-->
                                </div><!--end row-->
                            </div><!--end card-body-->
                            <div class="card-body overflow-hidden p-0">
                                <div class="d-flex mb-0 h-100 dash-info-box">
                                    <div class="w-100">
                                        <div class="apexchart-wrapper">
                                            <div id="w-conso-fuel" class="chart-gutters"></div>
                                        </div>
                                    </div>
                                </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->

                    {# Appro Fuel du mois #}
                    <div class="col-sm-3 col-12">
                        <div class="card bg-soft-blue">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-12 align-self-center">
                                        <div class="">
                                            <h4 class="mt-0 text-white"><span id="approv-fuel-value">0.0</span> L <span id="approv-fuel-progress-color" class="text-danger" style="font-size:13px;letter-spacing: 0px;margin-bottom: 0;"><span id="approv-fuel-progress-value">+INF</span>%
                                            <svg id="approv-fuel-progress-up-icon" style="vertical-align: baseline;width: 14px;height: 14px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up d-none"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                            <svg id="approv-fuel-progress-down-icon" style="vertical-align: baseline;width: 14px;height: 14px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                            </span></h4>
                                            <p class="mb-0 text-muted">Fuel Supply of The Month</p>
                                        </div>
                                    </div><!--end col-->
                                </div><!--end row-->
                            </div><!--end card-body-->
                            <div class="card-body overflow-hidden p-0">
                                <div class="d-flex mb-0 h-100 dash-info-box">
                                    <div class="w-100">
                                        <div class="apexchart-wrapper">
                                            <div id="w-appro-fuel" class="chart-gutters"></div>
                                        </div>
                                    </div>
                                </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->

                    {# Durée de fonctionnement GE du mois #}
                    <div class="col-sm-3 col-12">
                        <div class="card bg-soft-blue">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-12 align-self-center">
                                        <div class="">
                                            <h4 class="mt-0 text-white"><span id="duree-fonct">00:00:00 </span><span id="duree-fonct-progress-color" class="text-danger" style="font-size:13px;letter-spacing: 0px;margin-bottom: 0;"><span id="duree-fonct-progress-value">+INF</span>%
                                            <svg id="duree-fonct-progress-up-icon" style="vertical-align: baseline;width: 14px;height: 14px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up d-none"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                            <svg id="duree-fonct-progress-down-icon" style="vertical-align: baseline;width: 14px;height: 14px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                            </span></h4>
                                            <p class="mb-0 text-muted">Running Time of The Month</p>
                                        </div>
                                    </div><!--end col-->
                                </div><!--end row-->
                            </div><!--end card-body-->
                            <div class="card-body overflow-hidden p-0">
                                <div class="d-flex mb-0 h-100 dash-info-box">
                                    <div class="w-100">
                                        <div class="apexchart-wrapper">
                                            <div id="w-df" class="chart-gutters"></div>
                                        </div>
                                    </div>
                                </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->

                </div>
            {% endif %}

            {# {% if type == 'zone sans' %}
                
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_total_active_power" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->                            
                </div><!--end row-->
                
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_total_energy" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_total_power_factor" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->                            
                </div><!--end row-->
            {% elseif type == 'zone avec' %}
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_power" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->                            
                </div><!--end row-->
                
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_energy" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_power_factor" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->                            
                </div><!--end row-->
                { <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Column Chart with Datalabels</h4>
                                <div class="chart-demo">
                                    <div id="apex_column2" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->    
                </div> }
                {% if smartMod %}
                    {% if smartMod.nbPhases == 3 %}
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title mt-0 mb-4"></h4>
                                    <div class="chart-demo">
                                        <div id="apex_mixed_active_power" class="apex-charts"></div>
                                    </div>                                        
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->                            
                    </div><!--end row-->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title mt-0 mb-4"></h4>
                                    <div class="chart-demo">
                                        <div id="apex_mixed_cosfi" class="apex-charts"></div>
                                    </div>                                        
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->                            
                    </div><!--end row-->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title mt-0 mb-4"></h4>
                                    <div class="chart-demo">
                                        <div id="apex_mixed_voltage" class="apex-charts"></div>
                                    </div>                                        
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->                            
                    </div><!--end row-->
                    {% elseif smartMod.nbPhases == 1 %}
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title mt-0 mb-4"></h4>
                                    <div class="chart-demo">
                                        <div id="apex_mixed_PSCos" class="apex-charts"></div>
                                    </div>                                        
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->                            
                    </div><!--end row-->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title mt-0 mb-4"></h4>
                                    <div class="chart-demo">
                                        <div id="apex_voltage" class="apex-charts"></div>
                                    </div>                                        
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->                            
                    </div><!--end row-->
                    {% endif %}
                {% endif %}
                
                { <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Zoomable Timeseries</h4>
                                <div class="chart-demo">
                                    <div id="apex_line3" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row--> }
            {% elseif type == 'load meter' %}
            {% endif %} #}
            
            
        </div>
        <div class="tab-pane p-3" id="historical" role="tabpanel">
            {# {{dump(type)}} #}
            {% if zone.type != 'Genset' %}
            <div class="row">
                <div class="col">
                    <label class="my-3">Pick Date Ranges</label>
                    <div class="input-group mb-3">
                        <input type="text" id="daterange" class="form-control" value="">
                        <div class="input-group-append">
                            <span class="input-group-text"><i class="dripicons-calendar"></i></span>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            {% if zone.type == 'PUE Calculation' %}
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_pue_power" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->                            
                </div><!--end row-->

                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_climate" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->
                
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_pue_energy" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->

                {# <div class="row ">
                    <div class="col">
                        <div class="card crm-data-card">
                            <div class="card-body"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-spa rounded-circle bg-soft-primary"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8">
                                        <h3 class="text-primary"><span id="instPUE">0</span></h3>
                                        <p class="text-muted font-14 mb-0">Instant PUE</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card-->                                      
                    </div>
                    <div class="col">
                        <div class="card crm-data-card">
                            <div class="card-body"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">{ mdi mdi-spa }
                                            <i class="mdi mdi-spa rounded-circle bg-soft-success"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8">
                                        <h3 class="text-success"><span id="intPUE">0</span></h3>
                                        <p class="text-muted font-14 mb-0">Interval PUE</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card-->                                      
                    </div>
                </div> #}
            {% elseif zone.type == 'No PUE Calculation' %}
                <div class="row">
                    <div class="col-12 col-sm-9">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_PSCosfi" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div>

                    <div class="col-12 col-sm-3">
                        <div class="card crm-data-card bg-soft-blue ">
                            <div class="card-body mt-2 mb-2"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-flash bg-soft-warning rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="ea">0</span> kWh</h3>
                                        <p class="text-white font-weight-bold mb-0">Consumption</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card--> 

                        <div class="card crm-data-card bg-soft-pink mt-4">
                            <div class="card-body mt-2 mb-2"> 
                                <div class="row">
                                    <div class="col-sm-4 align-self-center">
                                        <div class="data-icon">
                                            <i class="mdi mdi-spa bg-soft-pink rounded-circle"></i>
                                        </div>
                                    </div><!-- end col-->
                                    <div class="col-sm-8 text-center">
                                        <h3 class="text-white"><span id="emission">0</span> kgCO<sub>2</sub></h3>
                                        <p class="font-weight-bold text-white mb-0">Carbon Footprint</p>
                                    </div><!-- end col-->
                                </div><!-- end row-->                                                                                     
                            </div><!--end card-body--> 
                        </div><!--end card-->                         
                    </div>
                </div>

                <div class="row">

                    <div class="col-12 col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Active Energy Flow</h4>
                                <div class="">
                                    <div id="apex_pie_active_energy_flow" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                    
                    <div class="col-12 col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Reactive Energy Flow</h4>
                                <div class="">
                                    <div id="apex_pie_reactive_energy_flow" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div>

                </div>
                
                <div class="row">
                    <div class="col">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="table-responsive shopping-cart">
                                    {# {{dump(smartModsProduction)}} #}
                                    <table class="table mb-0">
                                        <thead>
                                            <tr>
                                                <th></th>
                                                <th class="text-center">Smax (kVA)</th>                                                        
                                                <th class="text-center">CosPhi </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for smartMod in zone.smartMods %}
                                                {% if smartMod.modType ==  'Load Meter' %}
                                                <tr>
                                                    <td>
                                                        <p class="d-inline-block align-middle mb-0 product-name">{{smartMod.name}}</p> 
                                                    </td>
                                                    <td class="text-center"><span id="smax_{{smartMod.id}}">0</span></td>
                                                    <td class="text-center"><span id="fp_{{smartMod.id}}">0</span></td>                                                        
                                                                                        
                                                </tr>
                                            {% endif %}
                                            {% endfor %}
                                            
                                        </tbody>
                                    </table>
                                </div><!--end re-table-->                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                        
                    </div>
                </div>
            {% elseif zone.type == 'Air Conditioner' %}
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Unit 1-1</h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_unit_1-1" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Unit 1-2</h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_unit_1-2" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->

            {% elseif zone.type == 'AVR' %}
                <div class="row">
                    <div class="col-12 col-sm-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_voltage" class="apex-charts"></div>
                                </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div>
                </div>

            {% elseif zone.type == 'Genset' %}
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="table-responsive mb-4 mt-4">
                                    <table id="historic-dataTable" class="table table-hover" style="width:100%">
                                        <thead>
                                        <tr class="text-center" >
                                            <th style="text-transform: none">Mois</th>
                                            <th style="text-transform: none">Conso (L)</th>
                                            <th style="text-transform: none">Appro (L)</th>
                                            <th style="text-transform: none">Durée (HH:mm:ss)</th>
                                            <th style="text-transform: none">Tx d'utilisation (%)</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for key, data in monthDataTable %}
                                            <tr class="text-center">
                                                <td>{{key}}</td>
                                                <td>{{data['consoFuel']}}</td>
                                                <td>{{data['approFuel']}}</td>
                                                <td>{{data['TRH']}}</td>
                                                <td>{{data['Tx']}}</td>
                                            </tr>
                                        {% endfor %}
                                        {# <tr class="text-center">
                                <td>Fév</td>
                                <td>10</td>
                                <td>5:30</td>
                                <td>20</td>
                                <td>5</td>
                            </tr> #}

                                        </tbody>
                                        {# <tfoot>
                            <tr class="text-center">
                                <th>Mois</th>
                                <th>Conso (kWh)</th>
                                <th>Émission (kgCO<sub>2</sub>)</th>
                                <th>Conso Moy (kWh/jr)</th>
                                <th>Puissance Max (W)</th>
                                <th>Talon de puissance (W)</th>
                            </tr>
                        </tfoot> #}
                                    </table>
                                </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->

                {# Sélecteur de date #}
                <div class="row">
                    <div class="col">
                        <label class="my-3">Pick Date Ranges</label>
                        <div class="input-group mb-3">
                            <input type="text" id="daterange" class="form-control" value="">
                            <div class="input-group-append">
                                <span class="input-group-text"><i class="dripicons-calendar"></i></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Fuel Level Chart</h4>
                                <div class="chart-demo">
                                    <div id="fuel-level-chart-histo"></div>
                                </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->

                <div class="row">
                    <div class="col-xl-9 col-lg-9 col-md-9 col-sm-12 col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Diagram Fuel Consumption - Supply, Running Time</h4>
                                <div class="chart-demo">
                                    <div id="mixed-duree-conso"></div>
                                </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->

                    <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12 col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Statistics Running Time</h4>
                                <div class="table-responsive">
                                        <table class="table">
                                            {# <caption>List of all users</caption> #}
                                            <thead >
                                            {# <tr class="text-center">
                                            <th></th>
                                            <th></th>
                                        </tr> #}
                                            </thead>
                                            <tbody class="text-center">
                                            <tr>
                                                <td class="text-right">Total : </td>
                                                <td class="text-left">
                                                    {# <span id="t-duree-totale">{{dataAnalysis['monotonePower']['stats']['mean']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-duree-totale-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['meanProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-totale-progress-value">{% if dataAnalysis['monotonePower']['stats']['meanProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['meanProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['meanProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['meanProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['meanProgress']}}{% endif %}</span>%
                                                <svg id="t-duree-totale-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['meanProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-totale-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['meanProgress'] > 0 or dataAnalysis['monotonePower']['stats']['meanProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                    <span id="t-duree-totale">-</span>
                                                    {# <span id="t-duree-totale-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-totale-progress-value">1</span>%
                                                <svg id="t-duree-totale-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-totale-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="text-right">Mean : </td>
                                                <td class="text-left">
                                                    {# <span id="t-duree-moy">{{dataAnalysis['monotonePower']['stats']['median']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-duree-moy-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['medianProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-moy-progress-value">{% if dataAnalysis['monotonePower']['stats']['medianProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['medianProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['medianProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['medianProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['medianProgress']}}{% endif %}</span>%
                                                <svg id="t-duree-moy-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['medianProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-moy-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['medianProgress'] > 0 or dataAnalysis['monotonePower']['stats']['medianProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                    <span id="t-duree-moy">-</span>
                                                    {# <span id="t-duree-moy-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-moy-progress-value">1</span>%
                                                <svg id="t-duree-moy-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-moy-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="text-right">Median : </td>
                                                <td class="text-left">
                                                    {# <span id="t-duree-mediane">{{dataAnalysis['monotonePower']['stats']['min']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-duree-mediane-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['minProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-mediane-progress-value">{% if dataAnalysis['monotonePower']['stats']['minProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['minProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['minProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['minProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['minProgress']}}{% endif %}</span>%
                                                <svg id="t-duree-mediane-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['minProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-mediane-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['minProgress'] > 0 or dataAnalysis['monotonePower']['stats']['minProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                    <span id="t-duree-mediane">-</span>
                                                    {# <span id="t-duree-mediane-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-mediane-progress-value">1</span>%
                                                <svg id="t-duree-mediane-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-mediane-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="text-right">Min : </td>
                                                <td class="text-left">
                                                    {# <span id="t-duree-min">{{dataAnalysis['monotonePower']['stats']['max']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-duree-min-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['maxProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-min-progress-value">{% if dataAnalysis['monotonePower']['stats']['maxProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['maxProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['maxProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['maxProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['maxProgress']}}{% endif %}</span>%
                                                <svg id="t-duree-min-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['maxProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-min-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['maxProgress'] > 0 or dataAnalysis['monotonePower']['stats']['maxProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                    <span id="t-duree-min">-</span>
                                                    {# <span id="t-duree-min-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-min-progress-value">1</span>%
                                                <svg id="t-duree-min-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-min-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="text-right">Max : </td>
                                                <td class="text-left">
                                                    {# <span id="t-duree-max">{{dataAnalysis['monotonePower']['stats']['Prang10']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-duree-max-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['Prang10Progress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-max-progress-value">{% if dataAnalysis['monotonePower']['stats']['Prang10Progress'] >= 0 or dataAnalysis['monotonePower']['stats']['Prang10Progress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['Prang10Progress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['Prang10Progress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['Prang10Progress']}}{% endif %}</span>%
                                                <svg id="t-duree-max-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['Prang10Progress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-max-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['Prang10Progress'] > 0 or dataAnalysis['monotonePower']['stats']['Prang10Progress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                    <span id="t-duree-max">-</span>
                                                    {# <span id="t-duree-max-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-max-progress-value">1</span>%
                                                <svg id="t-duree-max-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-max-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="text-right">Q1 : </td>
                                                <td class="text-left">
                                                    {# <span id="t-duree-Q1">{{dataAnalysis['monotonePower']['stats']['nbDepassement']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-duree-Q1-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-Q1-progress-value">{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['nbDepassementProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['nbDepassementProgress']}}{% endif %}</span>%
                                                <svg id="t-duree-Q1-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-Q1-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] > 0 or dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                    <span id="t-duree-Q1">-</span>
                                                    {# <span id="t-duree-Q1-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-Q1-progress-value">1</span>%
                                                <svg id="t-duree-Q1-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-Q1-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="text-right">Q3 : </td>
                                                <td class="text-left">
                                                    {# <span id="t-duree-Q3">{{dataAnalysis['monotonePower']['stats']['nbDepassement']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-duree-Q3-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-Q3-progress-value">{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['nbDepassementProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['nbDepassementProgress']}}{% endif %}</span>%
                                                <svg id="t-duree-Q3-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-Q3-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] > 0 or dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                    <span id="t-duree-Q3">-</span>
                                                    {# <span id="t-duree-Q3-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-duree-Q3-progress-value">1</span>%
                                                <svg id="t-duree-Q3-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-duree-Q3-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                                </td>
                                            </tr>

                                            </tbody>
                                        </table>
                            </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->

                {# Diagramme du nombre de démarrage #}
                <div class="row">
                    <div class="col-xl-9 col-lg-9 col-md-9 col-sm-12 col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Diagram Number of Start-ups</h4>
                                <div class="chart-demo">
                                    <div id="nps-chart"></div>
                                </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->

                    <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12 col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Statistics Number of Start-ups</h4>
                                <div class="table-responsive">
                                    <table class="table">
                                        {# <caption>List of all users</caption> #}
                                        <thead >
                                        {# <tr class="text-center">
                                            <th></th>
                                            <th></th>
                                        </tr> #}
                                        </thead>
                                        <tbody class="text-center">
                                        <tr>
                                            <td class="text-right">Total : </td>
                                            <td class="text-left">
                                                {# <span id="t-nps-totale">{{dataAnalysis['monotonePower']['stats']['mean']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-nps-totale-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['meanProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-totale-progress-value">{% if dataAnalysis['monotonePower']['stats']['meanProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['meanProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['meanProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['meanProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['meanProgress']}}{% endif %}</span>%
                                                <svg id="t-nps-totale-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['meanProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-totale-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['meanProgress'] > 0 or dataAnalysis['monotonePower']['stats']['meanProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                <span id="t-nps-totale">-</span>
                                                {# <span id="t-nps-totale-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-totale-progress-value">1</span>%
                                                <svg id="t-nps-totale-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-totale-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-right">Mean : </td>
                                            <td class="text-left">
                                                {# <span id="t-nps-moy">{{dataAnalysis['monotonePower']['stats']['median']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-nps-moy-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['medianProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-moy-progress-value">{% if dataAnalysis['monotonePower']['stats']['medianProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['medianProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['medianProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['medianProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['medianProgress']}}{% endif %}</span>%
                                                <svg id="t-nps-moy-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['medianProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-moy-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['medianProgress'] > 0 or dataAnalysis['monotonePower']['stats']['medianProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                <span id="t-nps-moy">-</span>
                                                {# <span id="t-nps-moy-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-moy-progress-value">1</span>%
                                                <svg id="t-nps-moy-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-moy-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-right">Median : </td>
                                            <td class="text-left">
                                                {# <span id="t-nps-mediane">{{dataAnalysis['monotonePower']['stats']['min']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-nps-mediane-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['minProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-mediane-progress-value">{% if dataAnalysis['monotonePower']['stats']['minProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['minProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['minProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['minProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['minProgress']}}{% endif %}</span>%
                                                <svg id="t-nps-mediane-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['minProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-mediane-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['minProgress'] > 0 or dataAnalysis['monotonePower']['stats']['minProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                <span id="t-nps-mediane">-</span>
                                                {# <span id="t-nps-mediane-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-mediane-progress-value">1</span>%
                                                <svg id="t-nps-mediane-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-mediane-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-right">Min : </td>
                                            <td class="text-left">
                                                {# <span id="t-nps-min">{{dataAnalysis['monotonePower']['stats']['max']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-nps-min-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['maxProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-min-progress-value">{% if dataAnalysis['monotonePower']['stats']['maxProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['maxProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['maxProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['maxProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['maxProgress']}}{% endif %}</span>%
                                                <svg id="t-nps-min-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['maxProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-min-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['maxProgress'] > 0 or dataAnalysis['monotonePower']['stats']['maxProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                <span id="t-nps-min">-</span>
                                                {# <span id="t-nps-min-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-min-progress-value">1</span>%
                                                <svg id="t-nps-min-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-min-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-right">Max : </td>
                                            <td class="text-left">
                                                {# <span id="t-nps-max">{{dataAnalysis['monotonePower']['stats']['Prang10']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-nps-max-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['Prang10Progress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-max-progress-value">{% if dataAnalysis['monotonePower']['stats']['Prang10Progress'] >= 0 or dataAnalysis['monotonePower']['stats']['Prang10Progress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['Prang10Progress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['Prang10Progress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['Prang10Progress']}}{% endif %}</span>%
                                                <svg id="t-nps-max-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['Prang10Progress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-max-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['Prang10Progress'] > 0 or dataAnalysis['monotonePower']['stats']['Prang10Progress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                <span id="t-nps-max">-</span>
                                                {# <span id="t-nps-max-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-max-progress-value">1</span>%
                                                <svg id="t-nps-max-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-max-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-right">Q1 : </td>
                                            <td class="text-left">
                                                {# <span id="t-nps-Q1">{{dataAnalysis['monotonePower']['stats']['nbDepassement']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-nps-Q1-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-Q1-progress-value">{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['nbDepassementProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['nbDepassementProgress']}}{% endif %}</span>%
                                                <svg id="t-nps-Q1-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-Q1-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] > 0 or dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                <span id="t-nps-Q1">-</span>
                                                {# <span id="t-nps-Q1-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-Q1-progress-value">1</span>%
                                                <svg id="t-nps-Q1-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-Q1-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-right">Q3 : </td>
                                            <td class="text-left">
                                                {# <span id="t-nps-Q3">{{dataAnalysis['monotonePower']['stats']['nbDepassement']|number_format(2, '.', ' ')}}</span>
                                                <span id="t-nps-Q3-progress-color" class="text-{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] < 0 %}success{% else %}danger{% endif %}" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-Q3-progress-value">{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] >= 0 or dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] == 'INF'  %}+{% endif %}{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] matches '/^[-+]?[0-9]*\\.?[0-9]+$/' %}{{dataAnalysis['monotonePower']['stats']['nbDepassementProgress']|number_format(2, '.', ' ')}}{% else %}{{dataAnalysis['monotonePower']['stats']['nbDepassementProgress']}}{% endif %}</span>%
                                                <svg id="t-nps-Q3-progress-up-icon" class="{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] <= 0 %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-Q3-progress-down-icon" class="{% if dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] > 0 or dataAnalysis['monotonePower']['stats']['nbDepassementProgress'] == 'INF' %}d-none{% endif %}" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
                                                </span> #}

                                                <span id="t-nps-Q3">-</span>
                                                {# <span id="t-nps-Q3-progress-color" class="text-success" style="font-size:10px;letter-spacing: 0px;margin-bottom: 0;"><span id="t-nps-Q3-progress-value">1</span>%
                                                <svg id="t-nps-Q3-progress-up-icon" class="" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                                                <svg id="t-nps-Q3-progress-down-icon" class="d-none" style="vertical-align: baseline;width: 10px;height: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg> #}
                                            </td>
                                        </tr>

                                        </tbody>
                                    </table>
                                </div>
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->
            {% endif %}

            {# {% if type == 'zone sans' %}
                
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_total_active_power" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->                            
                </div><!--end row-->
                
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_total_energy" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_total_power_factor" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->                            
                </div><!--end row-->
            {% elseif type == 'zone avec' %}
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_power" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->                            
                </div><!--end row-->
                
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_energy" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row-->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4"></h4>
                                <div class="chart-demo">
                                    <div id="apex_mixed_power_factor" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->                            
                </div><!--end row-->
                { <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Column Chart with Datalabels</h4>
                                <div class="chart-demo">
                                    <div id="apex_column2" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->    
                </div> }
                {% if smartMod %}
                    {% if smartMod.nbPhases == 3 %}
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title mt-0 mb-4"></h4>
                                    <div class="chart-demo">
                                        <div id="apex_mixed_active_power" class="apex-charts"></div>
                                    </div>                                        
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->                            
                    </div><!--end row-->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title mt-0 mb-4"></h4>
                                    <div class="chart-demo">
                                        <div id="apex_mixed_cosfi" class="apex-charts"></div>
                                    </div>                                        
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->                            
                    </div><!--end row-->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title mt-0 mb-4"></h4>
                                    <div class="chart-demo">
                                        <div id="apex_mixed_voltage" class="apex-charts"></div>
                                    </div>                                        
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->                            
                    </div><!--end row-->
                    {% elseif smartMod.nbPhases == 1 %}
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title mt-0 mb-4"></h4>
                                    <div class="chart-demo">
                                        <div id="apex_mixed_PSCos" class="apex-charts"></div>
                                    </div>                                        
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->                            
                    </div><!--end row-->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title mt-0 mb-4"></h4>
                                    <div class="chart-demo">
                                        <div id="apex_voltage" class="apex-charts"></div>
                                    </div>                                        
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->                            
                    </div><!--end row-->
                    {% endif %}
                {% endif %}
                
                { <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Zoomable Timeseries</h4>
                                <div class="chart-demo">
                                    <div id="apex_line3" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                </div><!--end row--> }
            {% elseif type == 'load meter' %}
            {% endif %} #}
            
            
        </div>

        {% if zone.type == 'No PUE Calculation' %}
        <div class="tab-pane p-3" id="energybilling" role="tabpanel">
            
            <div class="card">
                <div class="card-body">
                    {# <h5 class="mt-0 mb-3 "><a href="#" id="histo" class="text-decoration"><u>Consulter l'historique</u> <i class="dripicons-arrow-up"></i></a></h5>
                    <h5 class="mt-0 mb-3 d-none"><a href="#" id="fact" class="text-decoration"><u>Voir Facture</u></a></h5> #}
                    
                    {# <div class="table-responsive shopping-cart">
                        <table class="table mb-0">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th class="text-center">Pointe</th>                                                        
                                    <th class="text-center">Hors Pointe</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <p class="d-inline-block align-middle mb-0 product-name">Energie active (kWh)</p> 
                                    </td>
                                    <td class="text-center">2</td>
                                    <td class="text-center">198</td>                                                        
                                </tr>
                                <tr>
                                    <td>
                                        <p class="d-inline-block align-middle mb-0 product-name">Energie reactive (kVARh)</p> 
                                    </td>
                                    <td class="text-center">2</td>
                                    <td class="text-center">15</td>                                                       
                                </tr>                                                  
                            </tbody>
                        </table>
                    </div><!--end re-table--> #}
                    <div class="row rowFact">
                        <div class="col-4">
                            <div class="row">
                                <label class="my-3">Pick Date Ranges</label>
                                <div class="input-group mb-3">  
                                    <input type="text" id="daterangebilling" class="form-control" value="">
                                    <div class="input-group-append">
                                        <span class="input-group-text"><i class="dripicons-calendar"></i></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row rowFact">
                        <div class="col-2"></div>
                        <div class="col-8">

                            {# <h4 class="header-title mt-0 mb-3 text-center">Données de puissance</h4> #}
            
                            {# <div class="total-payment">
                                <table class="table mb-0">
                                    <tbody>
                                        <tr>
                                            <td class="payment-title">Puissance souscrite zone (kVA)</td>
                                            <td>{{zone.powerSubscribed}}</td>
                                        </tr>
                                        <tr>
                                            <td class="payment-title">Facteur de puissance</td>
                                            <td><span id="PF">0.85</span></td>
                                        </tr>
                                        <tr>
                                            <td class="payment-title">Nombre d'heures d'utilisation Psous</td>
                                            <td><span id="NHU_Psous">0</span> heures</td>
                                        </tr>
                                        <tr>
                                            <td class="payment-title">Nb d'heures d'utilisation source AC GRID</td>
                                            <td ><span id="NHU_Grid">0</span> heures</td>
                                        </tr>
                                        <tr>
                                            <td class="payment-title">Nb d'heures d'utilisation source GE</td>
                                            <td ><span id="NHU_GE">0</span> heures</td>
                                        </tr>
                                        <!-- <tr>
                                            <td class="payment-title">Nb d'heures d'utilisation source DC</td>
                                            <td ><span id="NHU_DC">0</span> heures</td>
                                        </tr> -->
                                        <tr>
                                            <td class="payment-title">Durée de dépassement</td>
                                            <td ><span id="DuréeDépassement">0</span> heures</td>
                                        </tr>
                                        <tr>
                                            <td class="payment-title">Puissance Max lue (kVA)</td>
                                            <td><span id="SmaxLue">0</span> </td>
                                        </tr>
                                    </tbody>
                                </table><!--end table-->
                            </div><!--end total-payment--> #}
                            {# <table id="billing" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;"> #}
                            <table id="billing" class="table table-striped table-fixed dt-responsive nowrap table-bordered" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th></th>
                                    </tr>
                                </thead>

                                <tbody>
                                    
                                    <tr>
                                        <th>Puissance souscrite {{zone.name}} (VA)</th>
                                        <td class="text-center" id="">{{zone.powerSubscribed}}</td>
                                       
                                    </tr>
                                    <tr>
                                        <td class="payment-title">Puissance Max lue (VA)</td>
                                        <td class="text-center"><span id="SmaxLue">0</span> </td>
                                    </tr>
                                    <tr>
                                        <td class="payment-title">Dépassement (VA)</td>
                                        <td class="text-center"><span id="puissanceDépassement">0</span> </td>
                                    </tr>
                                    <tr>
                                        <td class="payment-title">Nombre d'heures de dépassement (heures)</td>
                                        <td class="text-center"><span id="DuréeDépassement">0</span></td>
                                    </tr>
                                    <tr>
                                        <td class="payment-title">Tarif de dépassement (F CFA/KVA)</td>
                                        <td class="text-center"><span id="primeFixe">{{zone.site.tarification.primeFixe}}</span></td>
                                    </tr>
                                    <tr>
                                        <td class="payment-title text-right text-warning">Montant à payer (F CFA)</td>
                                        <td class="text-center text-warning"><span id="amount">0</span></td>
                                    </tr>
                                    
                                </tbody>
                            </table>
                        </div>
                        <div class="col-2"></div>
                        {# <div class="col">
                            <div class="table-responsive shopping-cart">
                                <table class="table mb-0">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th class="text-center">Consommation (kWh)</th>                                                        
                                            <th class="text-center">Tarif (XAF/kWh)</th>
                                            <th class="text-center">Montant (XAF)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>
                                                <p class="d-inline-block align-middle mb-0 product-name">Energie Active Pointe</p> 
                                            </td>
                                            <td class="text-center"><span id="EAP">0</span></td>
                                            <td class="text-center"><span id="EAP_tarif">{{zone.site.tarification.tarifAcGridP}}</span></td>                                                        
                                            <td class="text-center"><span id="EAP_Amount">0</span></td>                                                        
                                        </tr>
                                        <tr>
                                            <td>
                                                <p class="d-inline-block align-middle mb-0 product-name">Energie Active Hors Pointe</p> 
                                            </td>
                                            <td class="text-center"><span id="EAHP">0</span></td>
                                            <td class="text-center"><span id="EAHP_tarif">{{zone.site.tarification.tarifAcGridHp}}</span></td>                                                       
                                            <td class="text-center"><span id="EAHP_Amount">0</span></td>                                                       
                                        </tr>
                                    </tbody>
                                </table>
                            </div><!--end re-table-->
                            <div class="total-payment">
                                <table class="table mb-0">
                                    <tbody>
                                        <tr>
                                            <td class="payment-title">Sous-total</td>
                                            <td class="text-center"><span id="sTotal">0</span></td>
                                        </tr>
                                        <tr>
                                            <td class="payment-title">Prime Fixe</td>
                                            <td class="text-center"><span id="primeFixe">{{zone.powerSubscribed * zone.site.tarification.primeFixe}}</span></td>
                                        </tr>
                                        <tr>
                                            <td class="payment-title">Total HT</td>
                                            <td class="text-center"><span id="Amount_HT">0</span></td>
                                        </tr>
                                        <tr>
                                            <td class="payment-title">Taxes(TVA={{zone.site.tarification.tva}}%)</td>
                                            <td class="text-center"><span id="taxes">0</span></td>
                                        </tr>
                                        <tr>
                                            <td class="payment-title">Total TTC</td>
                                            <td class="text-center text-white"><span id="Amount_TTC">0</span></td>
                                        </tr>
                                    </tbody>
                                </table><!--end table-->
                            </div><!--end total-payment-->
                        </div> #}
                    </div>

                    <div class="row rowHisto d-none">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
    
                                    
                                    <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                        <thead>
                                            <tr class="text-center">
                                                <th></th>
                                                <th>Montant TTC</th>
                                                <th>Conso Pointe (kWh)</th>
                                                <th>Conso HP(kWh)</th>
                                                <th>Psous (kVA)</th>
                                                <th>Pmax (kVA)</th>
                                                <th>CosPhi (kVA)</th>
                                            </tr>
                                        </thead>
    
    
                                        <tbody>
                                            <tr>
                                                <th>Jan-2020</th>
                                                <td class="text-center">7500</td>
                                                <td class="text-center">11</td>
                                                <td class="text-center">5</td>
                                                <td class="text-center">20</td>
                                                <td class="text-center">9</td>
                                                <td class="text-center">0.86</td>
                                            </tr>
                                            <tr>
                                                <th>Fév-2020</th>
                                                <td class="text-center">5500</td>
                                                <td class="text-center">8</td>
                                                <td class="text-center">3</td>
                                                <td class="text-center">20</td>
                                                <td class="text-center">5</td>
                                                <td class="text-center">0.861</td>
                                            </tr>
                                            <tr>
                                                <th>Mars-2020</th>
                                                <td class="text-center">6800</td>
                                                <td class="text-center">10</td>
                                                <td class="text-center">4</td>
                                                <td class="text-center">20</td>
                                                <td class="text-center">6</td>
                                                <td class="text-center">0.87</td>
                                            </tr>
                                            <tr>
                                                <th>Avr-2020</th>
                                                <td class="text-center">7200</td>
                                                <td class="text-center">10.5</td>
                                                <td class="text-center">3</td>
                                                <td class="text-center">20</td>
                                                <td class="text-center">5.25</td>
                                                <td class="text-center">0.86</td>
                                            </tr>
                                            <tr>
                                                <th>Mai-2020</th>
                                                <td class="text-center">7600</td>
                                                <td class="text-center">11.5</td>
                                                <td class="text-center">5</td>
                                                <td class="text-center">20</td>
                                                <td class="text-center">7</td>
                                                <td class="text-center">0.88</td>
                                            </tr>
                                            <tr>
                                                <th>Juin-2020</th>
                                                <td class="text-center">7100</td>
                                                <td class="text-center">9.5</td>
                                                <td class="text-center">3</td>
                                                <td class="text-center">20</td>
                                                <td class="text-center">5.5</td>
                                                <td class="text-center">0.865</td>
                                            </tr>
                                            <tr>
                                                <th>Juil-2020</th>
                                                <td class="text-center">6500</td>
                                                <td class="text-center">8.25</td>
                                                <td class="text-center">2.5</td>
                                                <td class="text-center">20</td>
                                                <td class="text-center">3.75</td>
                                                <td class="text-center">0.8</td>
                                            </tr>
                                            <tr>
                                                <th>Août-2020</th>
                                                <td class="text-center">7000</td>
                                                <td class="text-center">10.75</td>
                                                <td class="text-center">4</td>
                                                <td class="text-center">20</td>
                                                <td class="text-center">6.25</td>
                                                <td class="text-center">0.86</td>
                                            </tr>
                                        </tbody>
                                    </table>        
                                </div>
                            </div>
                        </div> <!-- end col -->
                    </div> <!-- end row -->
                    
                </div><!--end card-body-->
            </div>  
        </div>
        {% endif %}

        {# <div class="tab-pane p-3" id="alarm" role="tabpanel">
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">

                            <h4 class="mt-0 header-title">Alarm Reporting</h4>

                            <div class="row">
                                <div class="col">
                                    <label class="my-3">Pick Date Ranges</label>
                                    <div class="input-group mb-3">  
                                        <input type="text" id="daterangeAlarm" class="form-control" value="">
                                        <div class="input-group-append">
                                            <span class="input-group-text"><i class="dripicons-calendar"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            
                            <table id="datatable-buttons-alarm" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Alarm Label</th>
                                        <th class="text-center">Occurrence</th>
                                        <th class="text-center">Actions</th>
                                    </tr>
                                </thead>

                                <tbody>
                                    {% for alarm in alarms %}
                                    <tr>
                                        <th>{{alarm.label}}</th>
                                        <td class="text-center" id="alarm_{{alarm.id}}">0</td>
                                        <td class="text-center"><a href="#" class="alarmDetails text-decoration" data-alarm={{alarm.id}}><u>Details</u></a></td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>        
                        </div>
                    </div>
                </div> <!-- end col -->
            </div> <!-- end row -->
        </div>    #}                                            
                    
    </div>     
{% endblock %}


{% block javascripts %}
    {# <script src="/plugins/justgage/justgage.js"></script>
    <script src="/plugins/justgage/raphael-2.1.4.min.js"></script> #}
    {# <script src="/pages/jquery.justgage.init.js"></script> #}
    {#{{ encore_entry_script_tags('app') }}#}

    {% if zone.type == 'No PUE Calculation' or zone.type == 'Genset' %}
        <!-- Required datatable js -->
        <script src="/plugins/datatables/jquery.dataTables.min.js"></script>
        <script src="/plugins/datatables/dataTables.bootstrap4.min.js"></script>
        <!-- Buttons examples -->
        <script src="/plugins/datatables/dataTables.buttons.min.js"></script>
        <script src="/plugins/datatables/buttons.bootstrap4.min.js"></script>
        <script src="/plugins/datatables/jszip.min.js"></script>
        <script src="/plugins/datatables/pdfmake.min.js"></script>
        <script src="/plugins/datatables/vfs_fonts.js"></script>
        <script src="/plugins/datatables/buttons.html5.min.js"></script>
        <script src="/plugins/datatables/buttons.print.min.js"></script>
        <script src="/plugins/datatables/buttons.colVis.min.js"></script>
        <!-- Responsive examples -->
        <script src="/plugins/datatables/dataTables.responsive.min.js"></script>
        <script src="/plugins/datatables/responsive.bootstrap4.min.js"></script>
        {# <script src="/pages/jquery.datatable.init.js"></script> #}
    {% endif %}

    <script src="/plugins/moment/moment.js"></script>
    <script src="/plugins/daterangepicker/daterangepicker.js"></script>
    <!--  bootstrap-datetimepicker -->
    <script src="/js/bootstrap-datetimepicker.min.js"></script>
    <script src="/pages/jquery.forms-advanced1.js"> </script>

    <script src="/plugins/apexcharts/apexcharts.min.js"></script>
    <script src="https://apexcharts.com/samples/assets/irregular-data-series.js"></script>
    <script src="https://apexcharts.com/samples/assets/ohlc.js"></script>
    <script src="/pages/jquery.apexcharts.init.js"></script>

    {# {% if zone.type == 'Air Conditioner' %}
        <script src="/plugins/morris/morris.min.js"></script>
        <script src="/plugins/raphael/raphael.min.js"></script>
        <script src="/plugins/moment/moment.js"></script>
        <script src="/pages/jquery.projects_dashboard.init.js"></script>
    {% endif %} #}

    {% if zone.type == 'Genset' %}
        <script src="/plugins/justgage/justgage.js"></script>
        <script src="/plugins/justgage/raphael-2.1.4.min.js"></script>
    {% endif %}

    <!-- Sweet-Alert  -->
    <script src="/plugins/sweet-alert2/sweetalert2.min.js"></script>

    {# 
        <!-- Required datatable js -->
        <script src="/plugins/datatables/jquery.dataTables.min.js"></script>
        <script src="/plugins/datatables/dataTables.bootstrap4.min.js"></script>
        <!-- Buttons examples -->
        <script src="/plugins/datatables/dataTables.buttons.min.js"></script>
        <script src="/plugins/datatables/buttons.bootstrap4.min.js"></script>
        <script src="/plugins/datatables/jszip.min.js"></script>
        <script src="/plugins/datatables/pdfmake.min.js"></script>
        <script src="/plugins/datatables/vfs_fonts.js"></script>
        <script src="/plugins/datatables/buttons.html5.min.js"></script>
        <script src="/plugins/datatables/buttons.print.min.js"></script>
        <script src="/plugins/datatables/buttons.colVis.min.js"></script>
        <!-- Responsive examples -->
        <script src="/plugins/datatables/dataTables.responsive.min.js"></script>
        <script src="/plugins/datatables/responsive.bootstrap4.min.js"></script>
        <script src="/pages/jquery.datatable.init.js"></script> 
    #}
    
    {% if zone.type == 'No PUE Calculation' %}
    <script>
        var drp_ = $('#daterangebilling').data('daterangepicker');
        endDate = drp_.endDate.format('YYYY-MM-DD');
        var start_ = drp_.startDate.format('DD-MM-YYYY');
        var end_ = drp_.endDate.format('DD-MM-YYYY');
        var FileName = 'Facturation du ' + start_ + ' au ' + end_;
              
        $('#daterangebilling').on('apply.daterangepicker', function (ev, picker) {
            start_ = picker.startDate.format('DD-MM-YYYY');
            end_ = picker.endDate.format('DD-MM-YYYY');
            FileName = 'Facturation du ' + start_ + ' au ' + end_;
            //alert(FileName)
            
        });

        function getExportFileName(){ return FileName;}

        //Buttons examples
        var table = $('#datatable-buttons').DataTable({
            //lengthChange: false,
            //buttons: ['copy', 'excel', 'pdf', 'colvis']
            buttons: ['excel', 'pdf'],
            searching: false, 
            //paging: false, 
            //info: false,
            ordering: false,
            lengthChange: false,
            //buttons: ['copy', 'excel', 'pdf', 'colvis']
            
        });
        {# var table = $('#datatable-buttons').DataTable({
            //sDom: 'lrtip',
            searching: false, 
            paging: false, 
            info: false,
            ordering: false,
            lengthChange: false,
            //buttons: ['copy', 'excel', 'pdf', 'colvis']
            buttons: ['excel', 'pdf']
        });
        table.buttons().container().appendTo('#datatable-buttons_wrapper .col-md-6:eq(0)'); #}
        var now = new Date();
        var jsDate = now.getDate()+'-'+(now.getMonth()+1)+'-'+now.getFullYear();
        
        var tableBilling = $('#billing').DataTable({
            //sDom: 'lrtip',
            searching: false, 
            //paging: false, 
            //info: false,
            ordering: false,
            lengthChange: false,
            //buttons: ['copy', 'excel', 'pdf', 'colvis']
            buttons: [
                {
                    //text: 'Exporter Disponibilité',
                    extend: 'pdfHtml5',
                    filename: function () { return getExportFileName();},//FileName,
                    exportOptions: {
                        //columns: [ 0, 1, 4 ],
                        //columns: ':visible'
                        search: 'applied',
                        order: 'applied'
                    },
                    title: function( thead, data, start, end, display ) {
                        return "{{app.user.enterprise.socialReason}}\r\n" + FileName;
                    },
                    customize: function (doc) {
                        //Remove the title created by datatTables
                        {# {% if app.user.enterprise.logo != null %}
                        var logo = getBase64FromImageUrl("{{ '/images/uploads/logo/' ~ app.user.enterprise.logo }}");
                        {% endif %}
                        //doc.content.splice(0,1);
                        doc.content.splice( 1, 0, {
                            margin: [ 0, 0, 0, 12 ],
                            alignment: 'center',
                            {% if app.user.enterprise.logo != null %}image: logo{% endif %}
                        } ); #}
                        //Create a date string that we use in the footer. Format is dd-mm-yyyy
                        var now = new Date();
                        var jsDate = now.getDate()+'-'+(now.getMonth()+1)+'-'+now.getFullYear();
                        // Logo converted to base64
                        // var logo = getBase64FromImageUrl('https://datatables.net/media/images/logo.png');
                        // The above call should work, but not when called from codepen.io
                        // So we use a online converter and paste the string in.
                        // Done on http://codebeautify.org/image-to-base64-converter
                        // It's a LONG string scroll down to see the rest of the code !!!
                        //var logo = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAICAgICAQICAgIDAgIDAwYEAwMDAwcFBQQGCAcJCAgHCAgJCg0LCQoMCggICw8LDA0ODg8OCQsQERAOEQ0ODg7/2wBDAQIDAwMDAwcEBAcOCQgJDg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg7/wAARCAAwADADASIAAhEBAxEB/8QAGgAAAwEAAwAAAAAAAAAAAAAABwgJBgIFCv/EADUQAAEDAgQDBgUDBAMAAAAAAAECAwQFBgAHESEIEjEJEyJBUXEUI0JhgRVSYhYXMpEzcrH/xAAYAQADAQEAAAAAAAAAAAAAAAAEBQYHAv/EAC4RAAEDAgMGBQQDAAAAAAAAAAECAxEABAUGEhMhMUFRcSIyYaHBFkKB0ZGx8P/aAAwDAQACEQMRAD8Avy44hlhTrqw22kEqUo6BIG5JPkMSxz67RlFPzFquWnDParOaN4QVlmqXDKcKKLS19CCsf8qh6A6e+OfaK573LDTanDJllVV0q8r3ZVIuGqR1fMpdJSdHCCOinN0j7e+FjymydjRKdSbGsikpbSlG5O3/AHfeX5nU6knck6DFdg+DovkquLlWllHE8yeg+f4FBPvluEpEqNC657/4yr4ecm3ZxH1OghzxfptpQERI7X8QrqdPXGNpucXGLltU0SbZ4jazW0tHX4C6IiJcd37HUEj8YoHNtTKOzwuHVPj79rTfhkfCudxEbUOqQQd9Pc4HlaoGRt2JVAcptRsOe54WZZkd6yFHpzakgD3098ahYWuVVDQ/YrKD9wJnvGqfb8UAHH584npWw4eu0+iVO+6Vl3xO2zHy1uKa4GafdcBwqos5w7AOE6lgk+epT68uK8MvNPxmnmHEvMuJCm3EKCkqSRqCCNiCPPHmbzdyWcozkq1rpitVSkzGyqHNbT4HU+S0H6Vp22/9Bw8XZkcQ1wuzLg4V8yqq5U69a0X42zalJXq5NpeuhZJO5LWo0/idPpxI5ryszgyG77D3Nrau+U8weh/cDgQRI3sGXi54VCCKXK6Ku5fnbOcTt2znO/8A0SfFtymcx17llpGqgPTUjDj5WOIOUmYFPpLgjXQ5ES627r43I6R40I9D16fuGEfzPZeyq7afiRtec0W03O/GuSj82wdbdb8ZB89FEjb0xvrIzGk2pmnSrgcdUttl3lkoB2UyrZadPbf8DFFhGHuX+W0bASUyY6kKJg96XPK0XJmt9MrkFuIQw2XNup8IwFbruVaWXkttMgadCCcEfNuPTbbzPkiK87+jVRsTqctlIKVNubkD2J/0RgBVFDVQUpTTEksjdTjpG4xc4TYOvBu5AhB3yf8AcfmgTIUUmiMxcs27+CG42Koy3JqFqym3YLytebuVfRr9gVD2AwvOWt5u2f2qXDle0FK4UhVwijzgFbPMSUlBSftqdcMAqN/TfCVV0yGBDl3O+huMwvZXw6Oqzr67n8jC85VWw/fnakZD2tAaL/wtwGsSuTfu2YyCeY+6ikY5x1yzVlDECB4C8Nn3lEx6SFe9MWtW3R1jfVTu0l4a7lv6wbaz8yqp6p2Z2X6FmXT2U6uVelq8TrQA3UtG6gPMFQG+mJe2Xf8ASL5s1qp0p35qfDLhuHR2M4P8kLT5aH/ePUSpIUnQjUemJh8SXZs2fmVf8/MvJevKyfzNkEuTPhGeamVNZ3JeZGnKonqpPXqQTjE8tZmdwF4hSdbSjvHMHqP1zo24tw8J4EUn9MvWz7iymo9tX27PgTqQ4tMCfGY735SuiFdenTTTyGOIrGV1DSJLCqndb7Z1aamIDEZJHQqGg5vyDga3Fw28bVhS1wqrlHAzAjtkhFSt2sIQHR5HkXoQftjrqJw5cYt81BESDkuxaCVnRU24K0Fpb+/I3qT7Y1b6kygptSi88lKiSWxIEkyRygE8tUUDsbieA71mM2M0mZxlVytTQ0w0jkQlIIQ2PpabR1JJ6Abk4oP2bHDhW6O9WuITMKlLplxV9hMeg06Sn5lPgjdIUPJayedX4HljvOHvs16VbF7Uy/c86/8A3DuyIoOwoAaDdPgL66ts7gqH7lan2xVaJEjQaezFiMIjx2khLbaBoEgYyzMmZTjWi2t0bK3b8qfk+v8AW/jNMGWdn4lGVGv/2SAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA=';
                        // A documentation reference can be found at
                        // https://github.com/bpampuch/pdfmake#getting-started
                        // Set page margins [left,top,right,bottom] or [horizontal,vertical]
                        // or one number for equal spread
                        // It's important to create enough space at the top for a header !!!
                        doc.pageMargins = [60,60,60,30];
                        // Set the font size fot the entire document
                        doc.defaultStyle.fontSize = 12;
                        // Set the fontsize for the table header
                        doc.styles.tableHeader.fontSize = 13;
                        //doc.styles.tableBodyOdd.fillColor = "yellow";
                        doc.styles.tableBodyOdd.alignment = function (rowIndex, node, columnIndex) {
                                                        return (rowIndex >= 0) ? 'center' : null;
                                                    };
                        doc.styles.tableHeader.fillColor = "#6c757d";
                        console.log(doc);
                        var objTable = {};
                        //objTable['heights'] = (function(i) { return 100; });
                        //objTable['widths'] = ['*', 'auto', '*', 'auto', 'auto', 'auto'];
                        //objTable['widths']   = (function(i) { return ['*', 'auto', '*', 'auto', 'auto', 'auto']; });
                        //doc.content[1].table = objTable; 
                        doc.content[1].table.widths = ['auto', '*']; 
                        //doc.content[1].table.heights = (function(i) { return 100; }); 
                        doc.content[1].layout = {
                                                    fillColor: function (rowIndex, node, columnIndex) {
                                                        return (rowIndex % 2 === 0) ? '#CCCCCC' : null;
                                                    }
                                                }; 
                            
                        // Create a header object with 3 columns
                        // Left side: Logo
                        // Middle: brandname
                        // Right side: A document title
                        /*doc['header']=(function() {
                            return {
                                columns: [
                                    {
                                        //image: logo,
                                        "width": 24
                                    },
                                    {
                                        alignment: 'left',
                                        italics: true,
                                        text: 'dataTables',
                                        fontSize: 18,
                                        margin: [10,0]
                                    },
                                    {
                                        alignment: 'right',
                                        fontSize: 14,
                                        text: 'Custom PDF export with dataTables'
                                    }
                                ],
                                margin: 20
                            }
                        });*/
                        // Create a footer object with 2 columns
                        // Left side: report creation date
                        // Right side: current page and total pages
                        doc['footer']=(function(page, pages) {
                            return {
                                columns: [
                                    {
                                        alignment: 'left',
                                        text: ['Crée le : ', { text: jsDate.toString() }]
                                    },
                                    {
                                        alignment: 'center',
                                        text: ['{{app.user.enterprise.socialReason}} {% if app.user.enterprise.niu is not empty %}- NIU : {{app.user.enterprise.niu}} {% endif %} {% if app.user.enterprise.rccm is not empty %}- RCCM : {{app.user.enterprise.rccm}}{% endif %}']
                                    },
                                    {
                                        alignment: 'right',
                                        text: ['page ', { text: page.toString() },	' de ',	{ text: pages.toString() }]
                                    }
                                ],
                                margin: 20
                            }
                        });
                        // Change dataTable layout (Table styling)
                        // To use predefined layouts uncomment the line below and comment the custom lines below
                        // doc.content[0].layout = 'lightHorizontalLines'; // noBorders , headerLineOnly
                        var objLayout = {};
                        objLayout['hLineWidth']   = (function(i) { return .5; });
                        objLayout['vLineWidth']   = (function(i) { return .5; });
                        objLayout['hLineColor']   = (function(i) { return '#ccc'; });
                        objLayout['vLineColor']   = (function(i) { return '#ccc'; });
                        objLayout['paddingLeft']  = (function(i) { return 4; });
                        objLayout['paddingRight'] = (function(i) { return 4; });
                        doc.content[0].layout = objLayout;
                    } 
                },
                {
                    //text: 'Exporter Disponibilité',
                    extend: 'excel',
                    filename: FileName,
                    exportOptions: {
                        //columns: [ 0, 1, 4 ],
                        //columns: ':visible'
                        search: 'applied',
                        order: 'applied'
                    },
                }
            ]
        });
        tableBilling.buttons().container().appendTo('#billing_wrapper .col-md-6:eq(0)');

        $('#histo').click(function(){
            $(this).parent().addClass('d-none');
            $('.rowFact').addClass('d-none');
            $('.rowHisto').removeClass('d-none');
            $('#fact').parent().removeClass('d-none');
        })
        
        $('#fact').click(function(){
            $(this).parent().addClass('d-none');
            $('.rowHisto').addClass('d-none');
            $('.rowFact').removeClass('d-none');
            $('#histo').parent().removeClass('d-none');
        })

                
    </script>

    <script>
        
        var urlBilling = "{{ path('update_bill') }}";
        var startDate;
        var endDate;
        
        $('#daterangebilling').on('apply.daterangepicker', function (ev, picker) {
            //console.log(picker.startDate.format('YYYY-MM-DD'));
            //console.log(picker.endDate.format('YYYY-MM-DD'));
        
            startDate = picker.startDate.format('YYYY-MM-DD');
            endDate = picker.endDate.format('YYYY-MM-DD');
            
            console.log('startDate = ' + startDate);
            console.log('endDate = ' + endDate);
            updateBilling();
            // block of code that runs when the click event triggers
        });
                
        function updateBilling(){
            
            $data = JSON.stringify({
                //"selectedDate": $dat,
                "startDate": startDate + ' 00:00:00',
                "endDate": endDate + ' 23:59:59',
                //"type": "zone",
                "id":{{smartMod.id ?? 0}},
                "zoneId": {{zone.id}},
            });
            // Danger
            swal.queue([{
                title: 'The Bill will be updated for the date range :',
                confirmButtonText: 'Confirm',
                text: 'From ' + startDate + ' To ' + endDate,
                showCancelButton: true,
                showLoaderOnConfirm: true,
                confirmButtonClass: 'btn btn-primary',
                cancelButtonClass: 'btn btn-danger ml-2',
                preConfirm: function () {
                    return new Promise(function (resolve) { 
                        
                        $.ajax({
                            type: "POST", // method type
                            contentType: "application/json; charset=utf-8",
                            url: urlBilling, // /Target function that will be return result
                            data: $data, // parameter pass data is parameter name param is value
                            dataType: "json",
                            timeout: 120000, // 64241
                            success: function (result) {
                                // $('.fa-sync').removeClass('fa-spin');
                                console.log(result);
                                
                                swal({
                                    type: 'success', 
                                    title: 'The Bill have been updated !',
                                    // html: 'Submitted email: ' + email
                                });
                                setTimeout(function () {
                                    resolve()
                                }, 2000);
                                if( Object.keys(result).length > 0 ){
                                    //var dateLabel = Object.values(result['date']);
                                    //console.log(Object.values(result['CourbeCroisé']));
                                    //console.log(result);
                                    {# console.log(Object.values(result['SymI']));
                                    console.log(Object.values(result['SymV'])); #}
                                    {# $('#PF').text(result['FP']); 
                                    $('#NHU_Psous').text(result['NHU_Psous']); 
                                    $('#NHU_Grid').text(result['NHU_Grid']); 
                                    $('#NHU_GE').text(result['NHU_FUEL']);  #}
                                    {# $('#DuréeDépassement').text(result['NHD_Psous']);  #}
                                    {# $('#SmaxLue').text(result['Smax']);  #}
                                    var Smax = parseFloat(result['Smax']);
                                    {# $('#EAP').text(result['EAP']); 
                                    $('#EAP_Amount').text(result['amountEAP']); 
                                    $('#EAHP').text(result['EAHP']); 
                                    $('#EAHP_Amount').text(result['amountEAHP']); 
                                    $('#sTotal').text(result['amountEA']); #}
                                    var prime = parseFloat($('#primeFixe').text());
                                    console.log("Prime Fixe = " + prime);
                                    var amount = 0.0;
                                    var diffP = 0.0;
                                    console.log("Prime Fixe = " + prime);
                                    if( Smax > {{zone.powerSubscribed}}){
                                        diffP = Smax - {{zone.powerSubscribed}};
                                        amount = (diffP/1000.0)*prime;
                                        //$('#amount').text(amount.toFixed(2))
                                    }
                                    else{
                                        //$('#amount').text(0);
                                        amount = 0;
                                        diffP = 0.0;
                                    }
                                    //tableBilling.cell(0,1).data(value['AVG']).draw();
                                    tableBilling.cell(1,1).data(Smax.toFixed(2)).draw();
                                    tableBilling.cell(2,1).data(diffP.toFixed(2)).draw();
                                    tableBilling.cell(3,1).data(result['NHD_Psous']).draw();
                                    //tableBilling.cell(3,1).data(data['available'][index]['av']).draw();
                                    tableBilling.cell(5,1).data(amount.toFixed(0)).draw();
                                            
                                    {# var amountHT = parseFloat(result['amountEA']) + prime;
                                     
                                    $('#Amount_HT').text(amountHT.toFixed(2)); 
                                    var taxes = (amountHT*{{zone.site.tarification.tva}})/100.0;
                                    $('#taxes').text(taxes.toFixed(2)); 
                                    var amountTTC = amountHT + taxes;
                                    $('#Amount_TTC').text(amountTTC.toFixed(2));  #}
                                                                        
                                    
                                }
                            },
                            error: function (result) {
                                // console.log("Error");
                                // console.log(result);
                                swal('Oops...', 'Something went wrong!', 'error'
                                // footer: '<a href>Why do I have this issue?</a>'
                                );
                                setTimeout(function () {
                                    resolve()
                                }, 5000);
                            }
                        });
                    })
                },
                allowOutsideClick: false
            }]);
        }
    </script>
    {% endif %}
    
    {# <script src="/pages/jquery.crypto-dashboard.init.js"></script> #}
    {# Overview panel script #}
    <script>
        {% if zone.type == 'No PUE Calculation' %}
            var options = {
                chart: {
                    height: 320,
                    type: 'pie',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                stroke: {
                    show: true,
                    width: 2,
                    colors: ['transparent']
                },
                series: [{% for smartMod in zone.smartMods %}{% if smartMod.modType ==  'Load Meter' %}{{ random(0, 0) }}{% if loop.last == false %},{% endif %}{% endif %}{% endfor %}],
                labels: [{% for smartMod in zone.smartMods %}{% if smartMod.modType ==  'Load Meter' %}"{{smartMod.name}}"{% if loop.last == false %},{% endif %}{% endif %}{% endfor %}],
                //colors: ["#a3cae0", "#232f5b","#f06a6c", "#f1e299", "#08aeb0"],
                legend: {
                    show: true,
                    position: 'bottom',
                    horizontalAlign: 'center',
                    verticalAlign: 'middle',
                    floating: false,
                    fontSize: '14px',
                    offsetX: 0,
                    offsetY: -10
                },
                tooltip: {
                    theme: "dark",
                    style: {
                        color: '#fff',
                    }
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        chart: {
                            height: 240
                        },
                        legend: {
                            show: false
                        },
                    }
                }]
            }
            var ActiveEnergy_Piechart_overview = new ApexCharts(
                document.querySelector("#apex_pie_active_energy_flow_overview"),
                options
            );
            ActiveEnergy_Piechart_overview.render();
            
            var options = {
                chart: {
                    height: 320,
                    type: 'pie',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                stroke: {
                    show: true,
                    width: 2,
                    colors: ['transparent']
                },
                series: [{% for smartMod in zone.smartMods %}{% if smartMod.modType ==  'Load Meter' %}{{ random(0, 0) }}{% if loop.last == false %},{% endif %}{% endif %}{% endfor %}],
                labels: [{% for smartMod in zone.smartMods %}{% if smartMod.modType ==  'Load Meter' %}"{{smartMod.name}}"{% if loop.last == false %},{% endif %}{% endif %}{% endfor %}],
                //colors: ["#a3cae0", "#232f5b","#f06a6c", "#f1e299", "#08aeb0"],
                legend: {
                    show: true,
                    position: 'bottom',
                    horizontalAlign: 'center',
                    verticalAlign: 'middle',
                    floating: false,
                    fontSize: '14px',
                    offsetX: 0,
                    offsetY: -10
                },
                tooltip: {
                    theme: "dark",
                    style: {
                        color: '#fff',
                    },
                    
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        chart: {
                            height: 240
                        },
                        legend: {
                            show: false
                        },
                    }
                }]
            }
            var ReactiveEnergy_Piechart_overview = new ApexCharts(
                document.querySelector("#apex_pie_reactive_energy_flow_overview"),
                options
            );
            ReactiveEnergy_Piechart_overview.render();
        {% endif %}
                
        {% if zone.type == 'PUE Calculation' %}
            //Mixed IT Active Power Zone - Active Power Equipments - PUE charts
            var options = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            position: 'top', // top, center, bottom
                        },
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                series: [{
                    name: 'IT Power',
                    type: 'line',
                    data: []
                    //data: [1.4, 2, 2.5, 1.5, 2.5, 2.8, 3.8, 4.6]
                }, {
                    name: 'DataCenter Power',
                    type: 'line',
                    data: []
                    //data: [1.1, 3, 3.1, 4, 4.1, 4.9, 6.5, 8.5]
                }, {
                    name: 'PUE',
                    type: 'line',
                    data: []
                    //data: [1.20, 1.829, 1.37, 1.36, 1.44, 1.45, 1.50, 1.58]
                }],
                fill: {
                    opacity: [1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                colors: ["#fbb624", "#77d0ba", "#e02040"], //
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM YYYY').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            }
                        },
                        title: {
                            text: "IT Power (kW)"
                        },
                    },
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#77d0ba'
                        },
                        labels: {
                            style: {
                                color: '#77d0ba',
                            },
                            offsetX: 10
                        },
                        title: {
                            text: "DataCenter Power (kW)",
                        },
                    },
                    {
                        opposite: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#e02040'
                        },
                        labels: {
                            style: {
                                color: '#e02040',
                            }
                        },
                        title: {
                            text: "PUE"
                        }
                    },
                ],
                tooltip: {
                    theme: "dark",
                    followCursor: true,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2)
                            } 
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                },
                legend: {
                    offsetY: -10,
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        yaxis: {
                            show: false
                        },
                        legend: {
                            show: false
                        }
                    }
                }]
            }
            
            var Mixed_Pue_Power_Linechart_overview = new ApexCharts(
                document.querySelector("#apex_mixed_pue_power_overview"),
                options
            );
            Mixed_Pue_Power_Linechart_overview.render();

            //Mixed Temperature Indoor-Outdoor - Humidity Indoor-Outdoor
            var options = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            position: 'top', // top, center, bottom
                        },
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [2, 2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                series: [{
                    name: 'Temperature Indoor',
                    type: 'line',
                    data: []
                    //data: [25, 24.8, 25.2, 25.8, 25.4, 25.6, 25.1, 25.7]
                }, {
                    name: 'Temperatue Outdoor',
                    type: 'line',
                    data: []
                    //data: [28, 30.1, 29.3, 29.5, 28.7, 29.7, 30.5, 31]
                }, {
                    name: 'Humidity Indoor',
                    type: 'line',
                    data: []
                    //data: [84, 90, 94, 97, 95, 93, 80, 82]
                }, {
                    name: 'Humidity Outdoor',
                    type: 'line',
                    data: []
                    //data: [90, 84, 97, 94, 93, 95, 84, 87]
                }],
                fill: {
                    opacity: [1, 1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                colors: ["rgb(0, 143, 251)","#fbb624", "#77d0ba", "#e02040"], //
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        {# axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: 'rgb(0, 143, 251)'
                        },
                        labels: {
                            style: {
                                color: 'rgb(0, 143, 251)',
                            }
                        }, #}
                        title: {
                            text: "Temperature (°C)"
                        },
                    },
                    {
                        show: false,
                        {# axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            }
                        },
                        title: {
                            text: "Temperature Outdoor (°C)"
                        }, #}
                    },
                    {
                        opposite: true,
                        {# axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#77d0ba'
                        },
                        labels: {
                            style: {
                                color: '#77d0ba',
                            },
                            offsetX: 10
                        }, #}
                        title: {
                            text: "Humidity (%)",
                        },
                    },
                    {
                        opposite: true,
                        show: false,
                        {# axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#e02040'
                        },
                        labels: {
                            style: {
                                color: '#e02040',
                            }
                        },
                        title: {
                            text: "Humidity Outdoor (%)"
                        } #}
                    },
                ],
                tooltip: {
                    theme: "dark",
                    followCursor: true,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2)
                            } 
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm:ss")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                },
                legend: {
                    offsetY: -10,
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        yaxis: {
                            show: false
                        },
                        legend: {
                            show: false
                        }
                    }
                }]
            }
            
            var Mixed_Climate_Linechart_overview = new ApexCharts(
                document.querySelector("#apex_mixed_climate_overview"),
                options
            );
            Mixed_Climate_Linechart_overview.render();

            //Mixed Energy - Interval PUE charts
            var options = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            position: 'top', // top, center, bottom
                        },
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                series: [{
                    name: 'Active Energy of {{zone.name}}',
                    type: 'column',
                    data: []
                    //data: [1.4, 2, 2.5, 1.5, 2.5, 2.8, 3.8, 4.6]
                }, {
                    name: 'Active Energy of Production equipments',
                    type: 'column',
                    data: []
                    //data: [1.1, 3, 3.1, 4, 4.1, 4.9, 6.5, 8.5]
                }, {
                    name: 'Interval PUE',
                    type: 'area',
                    data: []
                    //data: [20, 29, 37, 36, 44, 45, 50, 58]
                }],
                fill: {
                    opacity: [1, 1, 0.25],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                colors: ["#fbb624", "#77d0ba", "#e02040"],
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM YYYY').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            }
                        },
                        title: {
                            text: "Active Energy of {{zone.name}} (kWh)"
                        },
                    },
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#77d0ba'
                        },
                        labels: {
                            style: {
                                color: '#77d0ba',
                            },
                            offsetX: 10
                        },
                        title: {
                            text: "Active Energy of Production Equipments (kWh)",
                        },
                    },
                    {
                        opposite: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#e02040'
                        },
                        labels: {
                            style: {
                                color: '#e02040',
                            }
                        },
                        title: {
                            text: "Interval PUE"
                        }
                    },
                ],
                tooltip: {
                    theme: "dark",
                    followCursor: true,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2) + ""
                            } 
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH") + "h"
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                },
                legend: {
                    offsetY: -10,
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        yaxis: {
                            show: false
                        },
                        legend: {
                            show: false
                        }
                    }
                }]
            }
            var Mixed_Pue_Energy_Linechart_overview = new ApexCharts(
                document.querySelector("#apex_mixed_pue_energy_overview"),
                options
            );
            Mixed_Pue_Energy_Linechart_overview.render();
        {% elseif zone.type == 'AVR' %}
            //Mixed Voltage per phase charts
            var options = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                plotOptions: {
                    bar: {
                        columnWidth: '50%'
                    }
                },
                colors: ["#1ecab8", "#fbb624", "#f93b7a"],
                series: [{
                    name: 'Phase R ',
                    type: 'line',
                    // data: [23, 11, 22, 27, 13, 22, 37, 21, 44, 22, 30]
                    data: []
                }, {
                    name: 'Phase S ',
                    type: 'line',
                    // data: [44, 55, 41, 67, 22, 43, 21, 41, 56, 27, 43]
                    data: []
                }, {
                    name: 'Phase T ',
                    type: 'line',
                    // data: [30, 25, 36, 30, 45, 35, 64, 52, 59, 36, 39]
                    data: []
                }],
                fill: {
                    opacity: [1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                // labels: ['01/01/2003', '02/01/2003', '03/01/2003', '04/01/2003', '05/01/2003', '06/01/2003', '07/01/2003', '08/01/2003', '09/01/2003', '10/01/2003', '11/01/2003'],
                labels: [],
                markers: {
                    size: 0
                },
                legend: {
                    offsetY: -10,
                    position: 'bottom',
                },
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM YYYY').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            // color: '#1ecab8'
                        },
                        labels: {
                            style: {
                                // color: '#1ecab8',
                            }
                        },
                        title: {
                            text: "Volt"
                        },
                    },
                ],    
                tooltip: {
                    shared: true,
                    intersect: false,
                    theme: "dark",
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2) + " V";
                            }
                            return y;

                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                }
            }
            
            var Mixed_Voltage_Linechart_overview = new ApexCharts(
                document.querySelector("#apex_mixed_voltage_overview"),
                options
            );

            Mixed_Voltage_Linechart_overview.render();
        {% else %}
        //Mixed Apparent Power - Active Power - Cosphi charts
        var options = {
            chart: {
                height: 380,
                type: 'line',
                stacked: false,
                toolbar: {
                    show: true
                }
            },
            stroke: {
                width: [2, 2, 2],
                curve: 'smooth'
            },
            noData: {
                text: 'Data not yet ',
                align: 'center',
                verticalAlign: 'middle',
                offsetX: 0,
                offsetY: 0,
                style: {
                    color: undefined,
                    fontSize: '14px',
                    fontFamily: undefined
                }
            },
            plotOptions: {
                bar: {
                    columnWidth: '50%'
                }
            },
            colors: ["#1ecab8", "#fbb624", "#f93b7a"],
            series: [{
                name: 'Apparent Power',
                type: 'line',
                //data: [23, 11, 22, 27, 13, 22, 37, 21, 44, 22, 30]
                data: []
            }, {
                name: 'Active Power',
                type: 'line',
                //data: [44, 55, 41, 67, 22, 43, 21, 41, 56, 27, 43]
                data: []
            }, {
                name: 'CosPhi',
                type: 'line',
                //data: [30, 25, 36, 30, 45, 35, 64, 52, 59, 36, 39]
                data: []
            }],
            fill: {
                opacity: [1, 1, 1],
                gradient: {
                    inverseColors: false,
                    shade: 'light',
                    type: "vertical",
                    opacityFrom: 0.85,
                    opacityTo: 0.55,
                    stops: [0, 100, 100, 100]
                }
            },
            //labels: ['01/01/2003', '02/01/2003', '03/01/2003', '04/01/2003', '05/01/2003', '06/01/2003', '07/01/2003', '08/01/2003', '09/01/2003', '10/01/2003', '11/01/2003'],
            labels: [],
            markers: {
                size: 0
            },
            legend: {
                offsetY: -10,
                position: 'bottom',
            },
            xaxis: {
                type: 'datetime',
                categories: [],
                labels: {
                    datetimeFormatter: {
                        year: 'yyyy',
                        month: 'MMM \'yy',
                        day: 'dd MMM',
                        hour: 'HH:mm'
                    }
                },
                title: {
                    text: moment().format('DD MMMM YYYY').toString(),
                    style: {
                        fontSize: '14px',
                        fontWeight: 'bold',
                        fontFamily: undefined,
                        color: '#444'
                    },
                }
            },
            yaxis: [
                {
                    axisTicks: {
                        show: true,
                    },
                    axisBorder: {
                        show: true,
                        color: '#1ecab8'
                    },
                    labels: {
                        style: {
                            color: '#1ecab8',
                        }
                    },
                    title: {
                        text: "VA"
                    },
                },

                {
                    axisTicks: {
                        show: true,
                    },
                    axisBorder: {
                        show: true,
                        color: '#fbb624'
                    },
                    labels: {
                        style: {
                            color: '#fbb624',
                        },
                        offsetX: 10
                    },
                    title: {
                        text: "Watts",
                    },
                },
                {
                    opposite: true,
                    axisTicks: {
                        show: true,
                    },
                    axisBorder: {
                        show: true,
                        color: '#f93b7a'
                    },
                    labels: {
                        style: {
                            color: '#f93b7a',
                        }
                    },
                    title: {
                        text: ""
                    }
                },

            ],
            tooltip: {
                shared: true,
                intersect: false,
                theme: "dark",
                y: {
                    formatter: function (y) {
                        if (typeof y !== "undefined") {
                            return parseFloat(y).toFixed(2) + "";
                        }
                        return y;

                    }
                },
                x: {
                    formatter: function (val, timestamp) {
                        return moment(new Date(val)).format("DD MMM YYYY HH:mm")
                    }
                }
            },
            grid: {
                borderColor: '#f1f3fa'
            }
        }

        var Mixed_PSCosfi_Linechart_overview = new ApexCharts(
            document.querySelector("#apex_mixed_PSCosfi_overview"),
            options
        );

        Mixed_PSCosfi_Linechart_overview.render();

        {% endif %}

        {% if zone.type == 'Air Conditioner' %}
            //Mixed Unit 1-1 Return Air Temperature - Return Air Humidity - Fan Speed 1
            var options11 = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            position: 'top', // top, center, bottom
                        },
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                series: [{
                    name: 'Return Air Temperature',
                    type: 'line',
                    data: []
                    //data: [25, 24.8, 25.2, 25.8, 25.4, 25.6, 25.1, 25.7]
                }, {
                    name: 'Return Air Humidity',
                    type: 'line',
                    data: []
                    //data: [28, 30.1, 29.3, 29.5, 28.7, 29.7, 30.5, 31]
                }, {
                    name: 'Fan Speed 1',
                    type: 'line',
                    data: []
                    //data: [84, 90, 94, 97, 95, 93, 80, 82]
                }],
                fill: {
                    opacity: [1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                colors: ["rgb(0, 143, 251)","#fbb624", "#77d0ba"], //
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: 'rgb(0, 143, 251)'
                        },
                        labels: {
                            style: {
                                color: 'rgb(0, 143, 251)',
                            }
                        }, 
                        title: {
                            text: "Return Air Temperature (°C)"
                        },
                    },
                    {
                        show: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            }
                        },
                        title: {
                            text: "Return Air Humidity (%rH)"
                        }, 
                    },
                    {
                        opposite: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#77d0ba'
                        },
                        labels: {
                            style: {
                                color: '#77d0ba',
                            },
                            offsetX: 10
                        }, 
                        title: {
                            text: "Fan Speed (%)",
                        },
                    },
                ],
                tooltip: {
                    theme: "dark",
                    followCursor: true,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2)
                            } 
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm:ss")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                },
                legend: {
                    offsetY: -10,
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        yaxis: {
                            show: false
                        },
                        legend: {
                            show: false
                        }
                    }
                }]
            }
            
            var Mixed_Unit_1_1_Linechart_overview = new ApexCharts(
                document.querySelector("#apex_mixed_unit_1-1_overview"),
                options11
            );
            Mixed_Unit_1_1_Linechart_overview.render();

            //Mixed Unit 1-2 Return Air Temperature - Return Air Humidity - Fan Speed 1
            var options12 = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            position: 'top', // top, center, bottom
                        },
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                series: [{
                    name: 'Return Air Temperature',
                    type: 'line',
                    data: []
                    //data: [25, 24.8, 25.2, 25.8, 25.4, 25.6, 25.1, 25.7]
                }, {
                    name: 'Return Air Humidity',
                    type: 'line',
                    data: []
                    //data: [28, 30.1, 29.3, 29.5, 28.7, 29.7, 30.5, 31]
                }, {
                    name: 'Fan Speed 1',
                    type: 'line',
                    data: []
                    //data: [84, 90, 94, 97, 95, 93, 80, 82]
                }],
                fill: {
                    opacity: [1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                colors: ["rgb(0, 143, 251)","#fbb624", "#77d0ba"], //
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: 'rgb(0, 143, 251)'
                        },
                        labels: {
                            style: {
                                color: 'rgb(0, 143, 251)',
                            }
                        }, 
                        title: {
                            text: "Return Air Temperature (°C)"
                        },
                    },
                    {
                        show: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            }
                        },
                        title: {
                            text: "Return Air Humidity (%rH)"
                        }, 
                    },
                    {
                        opposite: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#77d0ba'
                        },
                        labels: {
                            style: {
                                color: '#77d0ba',
                            },
                            offsetX: 10
                        }, 
                        title: {
                            text: "Fan Speed (%)",
                        },
                    },
                ],
                tooltip: {
                    theme: "dark",
                    followCursor: true,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2)
                            } 
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm:ss")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                },
                legend: {
                    offsetY: -10,
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        yaxis: {
                            show: false
                        },
                        legend: {
                            show: false
                        }
                    }
                }]
            }
            
            var Mixed_Unit_1_2_Linechart_overview = new ApexCharts(
                document.querySelector("#apex_mixed_unit_1-2_overview"),
                options12
            );
            Mixed_Unit_1_2_Linechart_overview.render();
        {% endif %}

        {% if zone.type == 'Genset' %}

            var fuel_level = new JustGage({
                id: "fuel_level",
                value: 0,
                min: 0,
                max: 100,
                title: "Fuel Level",
                label: "Fuel Level",
                pointer: true,
                textRenderer: function (val) {
                    return val + ' %';
                },
                onAnimationEnd: function () {
                    console.log('f: onAnimationEnd()');
                }
            });

            // conso fuel Chart
            var conso_options = {
                chart: {
                    id: 'consoFuel',
                    group: 'Conso',
                    height:135,
                    animations: {
                        enabled: false
                    },
                    sparkline: {
                        enabled: true
                    },
                    type:"bar"
                },
                plotOptions: {
                    bar: {
                        horizontal: false,
                        endingShape: "rounded",
                        columnWidth: "70%"
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    show: true,
                    width: 2,
                    colors: ["transparent"]
                },
                // colors: ["#4ac7ec"],
                colors: ['#1b55e2'],
                series:[ {
                    name: "Fuel Consumption ",
                    {# data: [50, 60, 70, 80, 90, 100, 95, 85, 75, 65, 55, 65, 75, 85, 95, 105, 80, 70, 60, 50, 40, 30, 45, 55, 65, 75, 85, 95, 100, 80, 60] #}
                    data: []
                }
                ],
                xaxis: {
                    type: 'datetime',
                    {# categories: ['1-Jan','2-Jan','3-Jan','4-Jan','5-Jan','6-Jan','7-Jan','8-Jan','9-Jan','10-Jan','11-Jan','12-Jan','13-Jan','14-Jan','15-Jan','16-Jan','17-Jan','18-Jan','19-Jan','20-Jan','21-Jan','22-Jan','23-Jan','24-Jan','25-Jan','26-Jan','27-Jan','28-Jan','29-Jan','30-Jan','31-Jan'], #}
                    categories: [],
                    crosshairs: {
                        show: false,
                    },
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                fill: {
                    opacity: 0.5
                },

                tooltip: {
                    theme: 'dark',
                    y: {
                        formatter:function(y) {
                            //console.log(y)
                            if (typeof y !== "undefined") {
                                return y.toFixed(2) + " L"
                            }
                            return y;
                        },
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY")
                        }
                    }
                }

            }
            var w_consoChart = new ApexCharts(
                document.querySelector("#w-conso-fuel"),
                conso_options
            );

            w_consoChart.render();

            // appro fuel Chart
            var approChart_options = {
                chart: {
                    id: 'approv',
                    group: 'Conso',
                    height:135,
                    animations: {
                        enabled: false
                    },
                    sparkline: {
                        enabled: true
                    },
                    type:"bar"
                },
                plotOptions: {
                    bar: {
                        horizontal: false,
                        endingShape: "rounded",
                        columnWidth: "70%"
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    show: true,
                    width: 2,
                    colors: ["transparent"]
                },
                // colors: ["#4ac7ec"],
                colors: ['#8dbf42'],
                series:[ {
                    name: "Fuel Supply ",
                    {# data: [50, 60, 70, 80, 90, 100, 95, 85, 75, 65, 55, 65, 75, 85, 95, 105, 80, 70, 60, 50, 40, 30, 45, 55, 65, 75, 85, 95, 100, 80, 60] #}
                    data: []
                }
                ],
                xaxis: {
                    type: 'datetime',
                    {# categories: ['1-Jan','2-Jan','3-Jan','4-Jan','5-Jan','6-Jan','7-Jan','8-Jan','9-Jan','10-Jan','11-Jan','12-Jan','13-Jan','14-Jan','15-Jan','16-Jan','17-Jan','18-Jan','19-Jan','20-Jan','21-Jan','22-Jan','23-Jan','24-Jan','25-Jan','26-Jan','27-Jan','28-Jan','29-Jan','30-Jan','31-Jan'],#}
                    categories: [],
                    crosshairs: {
                        show: false,
                    },
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                fill: {
                    opacity: 0.5
                },

                tooltip: {
                    theme: 'dark',
                    y: {
                        formatter:function(y) {
                            //console.log(y)
                            if (typeof y !== "undefined") {
                                return y.toFixed(2) + " L"
                            }
                            return y;
                        },
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY")
                        }
                    }
                }

            }
            var w_approChart = new ApexCharts(
                document.querySelector("#w-appro-fuel"),
                approChart_options
            );

            w_approChart.render();

        // w-df Chart
        var dfChart_options = {
            chart: {
                id: 'df',
                group: 'Conso',
                height:135,
                animations: {
                    enabled: false
                },
                sparkline: {
                    enabled: true
                },
                type:"bar"
            },
            plotOptions: {
                bar: {
                    horizontal: false,
                    endingShape: "rounded",
                    columnWidth: "70%"
                }
            },
            dataLabels: {
                enabled: false
            },
            stroke: {
                show: true,
                width: 2,
                colors: ["transparent"]
            },
            // colors: ["#4ac7ec"],
            colors: ['#e7515a'],
            series:[ {
                name: "Running Time ",
                {# data: [50, 60, 70, 80, 90, 100, 95, 85, 75, 65, 55, 65, 75, 85, 95, 105, 80, 70, 60, 50, 40, 30, 45, 55, 65, 75, 85, 95, 100, 80, 60] #}
                data: []
            }
            ],
            xaxis: {
                type: 'datetime',
                {# categories: ['1-Jan','2-Jan','3-Jan','4-Jan','5-Jan','6-Jan','7-Jan','8-Jan','9-Jan','10-Jan','11-Jan','12-Jan','13-Jan','14-Jan','15-Jan','16-Jan','17-Jan','18-Jan','19-Jan','20-Jan','21-Jan','22-Jan','23-Jan','24-Jan','25-Jan','26-Jan','27-Jan','28-Jan','29-Jan','30-Jan','31-Jan'], #}
                categories: [],
                crosshairs: {
                    show: false,
                },
                labels: {
                    datetimeFormatter: {
                        year: 'yyyy',
                        month: 'MMM \'yy',
                        day: 'dd MMM',
                        hour: 'HH:mm'
                    }
                },
                title: {
                    text: moment().format('DD MMMM').toString(),
                    style: {
                        fontSize: '14px',
                        fontWeight: 'bold',
                        fontFamily: undefined,
                        color: '#444'
                    },
                }
            },
            fill: {
                opacity: 0.5,
                /*type:"gradient",
                gradient: {
                    type: "vertical",
                    shadeIntensity: 1,
                    inverseColors: !1,
                    opacityFrom: .40,
                    opacityTo: .05,
                    stops: [45, 100]
                }*/
            },

            tooltip: {
                theme: 'dark',
                y: {
                    formatter:function(y) {
                        //console.log(y)
                        if (typeof y !== "undefined") {
                            {# return y.toFixed(2) + " h" #}
                            {# var time = parseInt(y, 10); // don't forget the hour param
                                    var hours   = Math.floor(time);
                                    var minutes = Math.floor((time - (hours)) / 60);
                                    var seconds = time - (hours) - (minutes * 60); #}

                            var seconds = y * 60 * 60;
                            var hours = Math.floor(seconds / 3600);
                            var minutes = Math.floor((seconds / 60) % 60);
                            seconds =  Math.floor(seconds % 60);

                            if (hours   < 10) {hours   = "0"+hours;}
                            if (minutes < 10) {minutes = "0"+minutes;}
                            if (seconds < 10) {seconds = "0"+seconds;}
                            {# console.log(hours+':'+minutes+':'+seconds) #}
                            return hours+':'+minutes+':'+seconds;
                        }
                        return y;
                    },
                },
                x: {
                    formatter: function (val, timestamp) {
                        return moment(new Date(val)).format("DD MMM YYYY")
                    }
                }
            }

        }
        var w_dfChart = new ApexCharts(
            document.querySelector("#w-df"),
            dfChart_options
        );

        w_dfChart.render();

        function progress(prefixSelector, progValue, posLogique, isTime, isTextColor=true) {

            var id = '#' + prefixSelector;
            var progressSelectorValue = $(id + 'value');
            var progressSelectorColor = $(id + 'color');
            var upSelectorIcon   = $(id+ 'up-icon');
            var downSelectorIcon = $(id+ 'down-icon');
            var greenColor = isTextColor ? 'text-success' : 'rate-inc';//
            var redColor = isTextColor ? 'text-danger' : 'rate-dec';//

            if (!isTime) {//On teste s'il s'agit d'une progression numérique
                var val = progValue !== 'INF' ? String(parseFloat(progValue).toFixed(2)) : progValue;
                progressSelectorValue.html(progValue === null ? 0 : (progValue > 0 || progValue === 'INF') ? ('+' + val) : val);
            }
            else {//s'il s'agit d'une progression de date
                var diff = new Date(Math.abs(progValue));
                var $dat = new moment(diff).subtract(timeZoneOffset, 'hours');
                var str = $dat.format('HH:mm:ss').toString()
                progressSelectorValue.html(progValue === null ? 0 : progValue > 0 ? '+' + str : '-' + str);
            }

            if (posLogique) {// Logique positive
                if (progValue > 0 || progValue === 'INF') {//Si la valeur de progression est positive
                    //On met la valeur et l'îcone en vert
                    progressSelectorColor.removeClass(redColor).addClass(greenColor);

                    //On affiche l'îcone svg arrow-up
                    upSelectorIcon.removeClass('d-none');

                    //On masque l'îcone svg arrow-down
                    downSelectorIcon.addClass('d-none');

                    /*if (selectorIcon.hasClass(oldClass)) {
                        // it has class
                    } else {
                        // it doesn't have specified class
                    }*/
                }
                else {//Si la valeur de progression est négative
                    //On met la valeur et l'îcone en rouge
                    progressSelectorColor.removeClass(greenColor).addClass(redColor);

                    //On affiche l'îcone svg arrow-down
                    downSelectorIcon.removeClass('d-none');

                    //On masque l'îcone svg arrow-up
                    upSelectorIcon.addClass('d-none');
                }
            }
            else {// Logique négative
                if (progValue > 0 || progValue === 'INF') {//Si la valeur de progression est positive

                    //On met la valeur et l'îcone en rouge
                    progressSelectorColor.removeClass(greenColor).addClass(redColor);

                    //On affiche l'îcone svg arrow-up
                    upSelectorIcon.removeClass('d-none');

                    //On masque l'îcone svg arrow-down
                    downSelectorIcon.addClass('d-none');

                }
                else {//Si la valeur de progression est négative

                    //On met la valeur et l'îcone en vert
                    progressSelectorColor.removeClass(redColor).addClass(greenColor);

                    //On affiche l'îcone svg arrow-down
                    downSelectorIcon.removeClass('d-none');

                    //On masque l'îcone svg arrow-up
                    upSelectorIcon.addClass('d-none');

                }
            }
        }

        {% endif %}

        var url_ = "{{ path('update_zone_overview_graphs') }}";
        {# console.log('startDate = '+moment().format("YYYY-MM-DD") + ' 00:00:00')
        console.log('endDate = '+moment().format("YYYY-MM-DD") + ' 00:00:00') #}
        var $data_ = JSON.stringify({
            "startDate": moment().format("YYYY-MM-DD") + ' 00:00:00',
            "endDate": moment().format("YYYY-MM-DD") + ' 23:59:59',
            "zoneId": {{zone.id}},
        });
        setTimeout(
            function(){ 
                swal.queue([{
                    title: 'Waiting...',
                    confirmButtonText: 'Confirm',
                    text: 'Please wait !',
                    //showCancelButton: true,
                    showLoaderOnConfirm: true,
                    //confirmButtonClass: 'btn btn-primary',
                    //cancelButtonClass: 'btn btn-danger ml-2',
                    preConfirm: function () {
                        return new Promise(function (resolve) { 
                            $.ajax({
                                type: "POST", // method type
                                contentType: "application/json; charset=utf-8",
                                url: url_, // /Target function that will be return result
                                data: $data_, // parameter pass data is parameter name param is value
                                dataType: "json",
                                timeout: 120000, // 64241
                                success: function (result) {
                                    // $('.fa-sync').removeClass('fa-spin');
                                    //console.log(result);
                                    
                                    swal({
                                        type: 'success', 
                                        title: 'The graphs have been updated !',
                                        // html: 'Submitted email: ' + email
                                    });
                                    setTimeout(function () {
                                        resolve()
                                    }, 2000);
                                    if( Object.keys(result).length > 0 ){
                                        
                                        console.log(result);
                                        {# {% for smartMod in zone.smartMods %}
                                            {% if smartMod.modType ==  'Load Meter' %}
                                            $('#p_{{smartMod.id}}_overview').text(Object.values(result['P'])[{{loop.index0}}])
                                            $('#s_{{smartMod.id}}_overview').text(Object.values(result['S'])[{{loop.index0}}])
                                            $('#fp_{{smartMod.id}}_overview').text(Object.values(result['FP'])[{{loop.index0}}])
                                            {% endif %}
                                        {% endfor %} #}
                                        
                                        {# displayPieNewData(ActiveEnergy_Piechart, dateLabel, Object.values(result['PieActiveEnergy']), [startDate, endDate], {{ zone.smartMods|length }}, 'day');#}
                                        {# displayPieNewData(ReactiveEnergy_Piechart, dateLabel, Object.values(result['PieReactiveEnergy']), [startDate, endDate], {{ zone.smartMods|length }}, 'day');#}
                                        
                                        if(result['Date1'] !== '') $('#update').text(String( moment( new Date(result['Date1']) ).format("DD MMM YYYY HH:mm:ss")) )

                                        {% if zone.type == 'PUE Calculation' %}    
                                            var dateLabel = Object.values(result['date']);
                         
                                            $("#instPUE").text(result['InstantPUE']);
                                            $("#it_power").text(result['InstantIT_AP']);
                                            $("#datacenter_power").text(result['InstantTotal_AP']);

                                            $('#temp_indoor').text(String(result['Intemp']));
                                            $('#temp_outdoor').text(String(result['Outtemp']));
                                            $('#hum_indoor').text(String(result['Inhum']));
                                            $('#hum_outdoor').text(String(result['Outhum']));
                                            $('#update').text(String( moment( new Date(result['ClimDate']) ).format("DD MMM YYYY HH:mm:ss")) )

                                        //$("#intPUE").text(result['IntervalPUE']);
                                            //console.log(Object.values(result['climateDate']));
                                            var dataLabel = Object.values(result['date']);
                                            displayNewData(Mixed_Pue_Power_Linechart_overview, Object.values(result['dateP']), Object.values(result['PUE']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                                            displayNewData(Mixed_Climate_Linechart_overview, Object.values(result['climateDate']), Object.values(result['MixedClimate']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 4, 'day');
                                            displayNewData(Mixed_Pue_Energy_Linechart_overview, dateLabel, Object.values(result['MixedEnergy']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                                        {% elseif zone.type == 'No PUE Calculation' %}
                                            console.log(Object.values( result['PieActiveEnergy']) );
                                            $('#p_overview').text(String(result['P']))
                                            $('#ea_overview').text(String(result['EA']))
                                            $('#emission_overview').text(String(result['kgCO2']))
                                            
                                            displayNewData(Mixed_PSCosfi_Linechart_overview, Object.values(result['datePSCosfi']), Object.values(result['MixedPSCosfi']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                                            
                                            var dataArray = [{% for smartMod in zone.smartMods %}
                                                {% if smartMod.modType ==  'Load Meter' %}parseFloat(Object.values(result['PieActiveEnergy'])[{{loop.index0}}]){% if loop.last == false %},{% endif %}{% endif %}
                                                {% endfor %}
                                            ];
                                            updateDonutChart(ActiveEnergy_Piechart_overview, [{% for smartMod in zone.smartMods %}
                                                {% if smartMod.modType ==  'Load Meter' %}String("{{smartMod.name}} : " + parseFloat(Object.values(result['PieActiveEnergy'])[{{loop.index0}}]) + " kWh"){% if loop.last == false %},{% endif %}{% endif %}
                                                {% endfor %}
                                            ], dataArray);
                                            dataArray = [{% for smartMod in zone.smartMods %}
                                                {% if smartMod.modType ==  'Load Meter' %}parseFloat(Object.values(result['PieReactiveEnergy'])[{{loop.index0}}]){% if loop.last == false %},{% endif %}{% endif %}
                                                {% endfor %}
                                            ];
                                            updateDonutChart(ReactiveEnergy_Piechart_overview, [{% for smartMod in zone.smartMods %}
                                                {% if smartMod.modType ==  'Load Meter' %}String("{{smartMod.name}} : " + parseFloat(Object.values(result['PieReactiveEnergy'])[{{loop.index0}}]) + " kVAR"){% if loop.last == false %},{% endif %}{% endif %}
                                                {% endfor %}
                                            ], dataArray);
                                        {% elseif zone.type == 'Air Conditioner' %}
                                            console.log('Air Conditioner')
                                            displayNewData(Mixed_Unit_1_1_Linechart_overview, Object.values(result['ACDate11']), Object.values(result['MixedAC11']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                                            displayNewData(Mixed_Unit_1_2_Linechart_overview, Object.values(result['ACDate12']), Object.values(result['MixedAC12']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                                        {% elseif zone.type == 'AVR' %}
                                            $('#vr_overview').text(String(result['V'][0]))
                                            $('#vs_overview').text(String(result['V'][1]))
                                            $('#vt_overview').text(String(result['V'][2]))
                                            displayNewData(Mixed_Voltage_Linechart_overview, Object.values(result['dateVoltage']), Object.values(result['MixedVoltage']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                                        {% elseif zone.type == 'Genset' %}
                                            if(parseInt(result['overviewData']['Gensetrunning'])){//Genset running = 1
                                                $('#genset-status').removeClass('badge-danger')
                                                $('#genset-status').addClass('badge-success')
                                                $('#genset-status').text('RUNNING')
                                            }
                                            else{
                                                $('#genset-status').removeClass('badge-success')
                                                $('#genset-status').addClass('badge-danger')
                                                $('#genset-status').text('STOP')
                                            }

                                            //#### Mise à jour de la Jauge indiquant le niveau de Fuel
                                            fuel_level.refresh( parseInt(result['overviewData']['Level'][0]) );
                                            // fuel_level.refresh( parseFloat(result['Level'][0]) ?? 0);
                                            // fuel_level.refresh(70);

                                            //#### Mise à jour des données de la card Consommation en FUEL du mois en cours
                                            //Valeur de la consommation du FUEL du mois en cours en L
                                            $('#conso-fuel-value').text(String(parseFloat(result['overviewData']['currentConsoFuel']).toFixed(2)))
                                            //Valeur de la consommation du FUEL du mois en cours en XAF
                                            $('#conso-fuel-xaf-value').text(String(parseFloat(result['overviewData']['currentConsoFuelXAF']).toFixed(2)))
                                            //On gère la progression de la consommation de FUEL
                                            progress(prefixSelector='conso-fuel-value-progress-', progValue=result['overviewData']['currentConsoFuelProgress'], posLogique=false, isTime=false);
                                            //MAJ de la courbe d'évolution de la consommation en kWh jour après jour
                                            displayNewData(w_consoChart, Object.values(result['overviewData']['dayBydayConsoData']['dateConso']), Object.values(result['overviewData']['dayBydayConsoData']['consoFuel']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day');

                                            //#### Mise à jour des données de la card Approvisionnenent en FUEL du mois en cours
                                            //Valeur de l'approvisionnenent en FUEL du mois en cours en L
                                            $('#approv-fuel-value').text(String(parseFloat(result['overviewData']['currentApproFuel']).toFixed(2)))
                                            //On gère la progression de l'approvisionnement en FUEL
                                            progress(prefixSelector='approv-fuel-value-progress-', progValue=result['overviewData']['currentApproFuelProgress'], posLogique=false, isTime=false);
                                            //MAJ de la courbe d'évolution de la consommation de FUEL en Litre jour après jour
                                            displayNewData(w_approChart, Object.values(result['overviewData']['dayBydayConsoData']['dateConso']), Object.values(result['overviewData']['dayBydayConsoData']['approFuel']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day');

                                            //#### Mise à jour des données de la card Durée de fonctionnement du mois en cours
                                            //Valeur de la durée de fonctionnement du mois en cours en HH:mm:ss
                                            $('#duree-fonct').text(result['overviewData']['dureeFonctionnement'])
                                            //On gère la progression de la durée de fonctionnement
                                            progress(prefixSelector='duree-fonct-value-progress-', progValue=result['overviewData']['dureeFonctionnementProgress'], posLogique=false, isTime=false);
                                            //MAJ de la courbe des Durées de fonctionnement du Groupe électrogène en heure jour après jour
                                            displayNewData(w_dfChart, Object.values(result['overviewData']['dayBydayConsoData']['dateConso']), Object.values(result['overviewData']['dayBydayConsoData']['duree']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day');

                                            if(result['overviewData']['Date'] !== '') $('#last_update').text(String( moment( new Date(result['overviewData']['Date']) ).format("DD MMM YYYY HH:mm:ss")) )
                                        {% endif %}

                                    }
                                },
                                error: function (result) {
                                    // console.log("Error");
                                    // console.log(result);
                                    swal('Oops...', 'Something went wrong!', 'error'
                                    // footer: '<a href>Why do I have this issue?</a>'
                                    );
                                    setTimeout(function () {
                                        resolve()
                                    }, 5000);
                                }
                            });
                        })
                    },
                    allowOutsideClick: false
                }]);

                $(".swal2-confirm").click();
                //alert("Hello"); 
                    
            }
        , 500);

        setInterval(function () {
            $data_ = JSON.stringify({
                "startDate": moment().format("YYYY-MM-DD") + ' 00:00:00',
                "endDate": moment().format("YYYY-MM-DD") + ' 23:59:59',
                "zoneId": {{zone.id}},
            });

            $.ajax({
                type: "POST", // method type
                contentType: "application/json; charset=utf-8",
                url: url_, // /Target function that will be return result
                data: $data_, // parameter pass data is parameter name param is value
                dataType: "json",
                timeout: 120000, // 64241
                success: function (result) {
                    // $('.fa-sync').removeClass('fa-spin');
                    console.log(result);
                    
                    if( Object.keys(result).length > 0 ){
                        {# console.log(result); #}
                        {# {% for smartMod in zone.smartMods %}
                            {% if smartMod.modType ==  'Load Meter' %}
                            $('#p_{{smartMod.id}}_overview').text(Object.values(result['P'])[{{loop.index0}}])
                            $('#s_{{smartMod.id}}_overview').text(Object.values(result['S'])[{{loop.index0}}])
                            $('#fp_{{smartMod.id}}_overview').text(Object.values(result['FP'])[{{loop.index0}}])
                            {% endif %}
                        {% endfor %} #}
                        
                        //displayPieNewData(ActiveEnergy_Piechart, dateLabel, Object.values(result['PieActiveEnergy']), [startDate, endDate], {{ zone.smartMods|length }}, 'day');
                        //displayPieNewData(ReactiveEnergy_Piechart, dateLabel, Object.values(result['PieReactiveEnergy']), [startDate, endDate], {{ zone.smartMods|length }}, 'day');
                        
                        if(result['Date1'] !== '') $('#update').text(String( moment( new Date(result['Date1']) ).format("DD MMM YYYY HH:mm:ss")) )
                    
                        {% if zone.type == 'PUE Calculation' %}     
                            var dateLabel = Object.values(result['date']);
                        
                            $("#instPUE").text(result['InstantPUE']);
                            $("#it_power").text(result['InstantIT_AP']);
                            $("#datacenter_power").text(result['InstantTotal_AP']);
                            //$("#intPUE").text(result['IntervalPUE']);
                            //console.log(Object.values(result['climateDate']));

                            $('#temp_indoor').text(String(result['Intemp']));
                            $('#temp_outdoor').text(String(result['Outtemp']));
                            $('#hum_indoor').text(String(result['Inhum']));
                            $('#hum_outdoor').text(String(result['Outhum']));
                            $('#update').text(String( moment( new Date(result['ClimDate']) ).format("DD MMM YYYY HH:mm:ss")) )

                            displayNewData(Mixed_Pue_Power_Linechart_overview, Object.values(result['dateP']), Object.values(result['PUE']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                            displayNewData(Mixed_Climate_Linechart_overview, Object.values(result['climateDate']), Object.values(result['MixedClimate']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 4, 'day');
                            displayNewData(Mixed_Pue_Energy_Linechart_overview, dateLabel, Object.values(result['MixedEnergy']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                        {% elseif zone.type == 'No PUE Calculation' %}
                            console.log(Object.values(result['PieActiveEnergy']));
                            $('#p_overview').text(String(result['P']))
                            $('#ea_overview').text(String(result['EA']))
                            $('#emission_overview').text(String(result['kgCO2']))
                            
                            displayNewData(Mixed_PSCosfi_Linechart_overview, Object.values(result['datePSCosfi']), Object.values(result['MixedPSCosfi']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                            var dataArray = [{% for smartMod in zone.smartMods %}
                                {% if smartMod.modType ==  'Load Meter' %}parseFloat(Object.values(result['PieActiveEnergy'])[{{loop.index0}}]){% if loop.last == false %},{% endif %}{% endif %}
                                {% endfor %}
                            ];
                            updateDonutChart(ActiveEnergy_Piechart_overview, [{% for smartMod in zone.smartMods %}
                                {% if smartMod.modType ==  'Load Meter' %}String("{{smartMod.name}} : " + parseFloat(Object.values(result['PieActiveEnergy'])[{{loop.index0}}]) + " kWh"){% if loop.last == false %},{% endif %}{% endif %}
                                {% endfor %}
                            ], dataArray);
                            dataArray = [{% for smartMod in zone.smartMods %}
                                {% if smartMod.modType ==  'Load Meter' %}parseFloat(Object.values(result['PieReactiveEnergy'])[{{loop.index0}}]){% if loop.last == false %},{% endif %}{% endif %}
                                {% endfor %}
                            ];
                            updateDonutChart(ReactiveEnergy_Piechart_overview, [{% for smartMod in zone.smartMods %}
                                {% if smartMod.modType ==  'Load Meter' %}String("{{smartMod.name}} : " + parseFloat(Object.values(result['PieReactiveEnergy'])[{{loop.index0}}]) + " kVAR"){% if loop.last == false %},{% endif %}{% endif %}
                                {% endfor %}
                            ], dataArray);
                        {% elseif zone.type == 'Air Conditioner' %}
                            displayNewData(Mixed_Unit_1_1_Linechart_overview, Object.values(result['ACDate11']), Object.values(result['MixedAC11']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                            displayNewData(Mixed_Unit_1_2_Linechart_overview, Object.values(result['ACDate12']), Object.values(result['MixedAC12']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                        {% elseif zone.type == 'AVR' %}
                            $('#vr_overview').text(String(result['V'][0]))
                            $('#vs_overview').text(String(result['V'][1]))
                            $('#vt_overview').text(String(result['V'][2]))
                            displayNewData(Mixed_Voltage_Linechart_overview, Object.values(result['dateVoltage']), Object.values(result['MixedVoltage']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                        {% elseif zone.type == 'Genset' %}
                            if(parseInt(result['overviewData']['Gensetrunning'])){//Genset running = 1
                                $('#genset-status').removeClass('badge-danger')
                                $('#genset-status').addClass('badge-success')
                                $('#genset-status').text('RUNNING')
                            }
                            else{
                                $('#genset-status').removeClass('badge-success')
                                $('#genset-status').addClass('badge-danger')
                                $('#genset-status').text('STOP')
                            }

                            //#### Mise à jour de la Jauge indiquant le niveau de Fuel
                            fuel_level.refresh( parseInt(result['overviewData']['Level'][0]) );
                            // fuel_level.refresh( parseFloat(result['Level'][0]) ?? 0);
                            // fuel_level.refresh(70);

                            //#### Mise à jour des données de la card Consommation en FUEL du mois en cours
                            //Valeur de la consommation du FUEL du mois en cours en L
                            $('#conso-fuel-value').text(String(parseFloat(result['overviewData']['currentConsoFuel']).toFixed(2)))
                            //Valeur de la consommation du FUEL du mois en cours en XAF
                            $('#conso-fuel-xaf-value').text(String(parseFloat(result['overviewData']['currentConsoFuelXAF']).toFixed(2)))
                            //On gère la progression de la consommation de FUEL
                            progress(prefixSelector='conso-fuel-value-progress-', progValue=result['overviewData']['currentConsoFuelProgress'], posLogique=false, isTime=false);
                            //MAJ de la courbe d'évolution de la consommation en kWh jour après jour
                            displayNewData(w_consoChart, Object.values(result['overviewData']['dayBydayConsoData']['dateConso']), Object.values(result['overviewData']['dayBydayConsoData']['consoFuel']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day');

                            //#### Mise à jour des données de la card Approvisionnenent en FUEL du mois en cours
                            //Valeur de l'approvisionnenent en FUEL du mois en cours en L
                            $('#approv-fuel-value').text(String(parseFloat(result['overviewData']['currentApproFuel']).toFixed(2)))
                            //On gère la progression de l'approvisionnement en FUEL
                            progress(prefixSelector='approv-fuel-value-progress-', progValue=result['overviewData']['currentApproFuelProgress'], posLogique=false, isTime=false);
                            //MAJ de la courbe d'évolution de la consommation de FUEL en Litre jour après jour
                            displayNewData(w_consoChart, Object.values(result['overviewData']['dayBydayConsoData']['dateConso']), Object.values(result['overviewData']['dayBydayConsoData']['consoFuel']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day');

                            //#### Mise à jour des données de la card Durée de fonctionnement du mois en cours
                            //Valeur de la durée de fonctionnement du mois en cours en HH:mm:ss
                            $('#duree-fonct').text(result['overviewData']['dureeFonctionnement'])
                            //On gère la progression de la durée de fonctionnement
                            progress(prefixSelector='duree-fonct-value-progress-', progValue=result['overviewData']['dureeFonctionnementProgress'], posLogique=false, isTime=false);
                            //MAJ de la courbe des Durées de fonctionnement du Groupe électrogène en heure jour après jour
                            displayNewData(w_dfChart, Object.values(result['overviewData']['dayBydayConsoData']['dateConso']), Object.values(result['overviewData']['dayBydayConsoData']['duree']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day');

                            if(result['overviewData']['Date'] !== '') $('#last_update').text(String( moment( new Date(result['overviewData']['Date']) ).format("DD MMM YYYY HH:mm:ss")) )
                        {% endif %}

                    }
                },
                error: function (result) {
                    console.log("Something went wrong!");
                    // console.log(result);
                }
            });
        }, 30000);
    </script>

    {# Historical/Billing panel first show script #}
    <script>
        var firstTabHistorical = true; 
        var firstTabEnergyBilling = true; 
        $('.nav-tabs a').on('shown.bs.tab', function(event){
            var x = $(event.target).text();         // active tab
            var y = $(event.relatedTarget).text();  // previous tab
            if( $(event.target).text() === 'Historicals'){
                if(firstTabHistorical){
                  firstTabHistorical = false; 
                  //$('#dpstrv_0_1_1194').text(100)
                  var url_ = "{{ path('update_zone_graphs') }}";
                  var drp_ = $('#daterange').data('daterangepicker');
                  console.log('drp = ' + drp_.startDate.format('YYYY-MM-DD'));
                  var startDate_ = drp_.startDate.format('YYYY-MM-DD');
                  var endDate_ = drp_.endDate.format('YYYY-MM-DD');

                  var $data_ = JSON.stringify({
                    "startDate": startDate_ + ' 00:00:00',
                    "endDate": endDate_ + ' 23:59:59', 
                    {# "productionIds":{{smartModsProduction}}, #}
                    "zoneId": {{zone.id}},
                  });

                    // Danger

                  swal.queue([{
                        title: 'Waiting...',
                        confirmButtonText: 'Confirm',
                        text: 'Please wait !',
                        //showCancelButton: true,
                        showLoaderOnConfirm: true,
                        //confirmButtonClass: 'btn btn-primary',
                        //cancelButtonClass: 'btn btn-danger ml-2',
                    
                        //title: 'The graphs will be updated for the date range :',
                        //confirmButtonText: 'Confirm',
                        //text: 'From ' + startDate_ + ' To ' + endDate_,
                        //showCancelButton: true,
                        //showLoaderOnConfirm: true,
                        //confirmButtonClass: 'btn btn-primary',
                        //cancelButtonClass: 'btn btn-danger ml-2',
                        preConfirm: function () {
                            return new Promise(function (resolve) { 
                                
                                $.ajax({
                                    type: "POST", // method type
                                    contentType: "application/json; charset=utf-8",
                                    url: url_, // /Target function that will be return result
                                    data: $data_, // parameter pass data is parameter name param is value
                                    dataType: "json",
                                    timeout: 120000, // 64241
                                    success: function (result) {
                                        // $('.fa-sync').removeClass('fa-spin');
                                        //console.log(result);
                                        
                                        swal({
                                            type: 'success', 
                                            title: 'The graphs have been updated !',
                                            // html: 'Submitted email: ' + email
                                        });

                                        setTimeout(function () {
                                            resolve()
                                        }, 2000);

                                        if( Object.keys(result).length > 0 ){
                                            console.log(result);

                                            {#{% for smartMod in zone.smartMods %}
                                                {% if smartMod.modType ==  'Load Meter' %}
                                                console.log({{loop.index0}});
                                                $('#smax_{{smartMod.id}}').text(Object.values(result['Smax'])[{{loop.index0}}])
                                                $('#fp_{{smartMod.id}}').text(Object.values(result['FP'])[{{loop.index0}}])
                                                {% endif %}
                                            {% endfor %}#}
                                            /*Object.values(result['Smax']).forEach(function (item, index) {
                                                var id = '#smax_' + index;
                                                console.log(item);
                                                $(id).text(item)
                                            });
                                            Object.values(result['Smax']).forEach(function (item, index) {
                                                var id  = '#fp_' + index;
                                                console.log(id);
                                                $(id).text(item)
                                            });*/
                                            /*$.each(Object.values(result['Smax']) , function( key, value ) {
                                                $('#smax_' + key).text(value)
                                            });
                                            $.each( Object.values(result['FP']), function( key, value ) {
                                                $('#fp_' + key).text(value)
                                            }); */           
                                            
                                            //displayPieNewData(ActiveEnergy_Piechart, dateLabel, Object.values(result['PieActiveEnergy']), [startDate, endDate], {{ zone.smartMods|length }}, 'day');
                                            //displayPieNewData(ReactiveEnergy_Piechart, dateLabel, Object.values(result['PieReactiveEnergy']), [startDate, endDate], {{ zone.smartMods|length }}, 'day');
                                            
                                            
                                            {% if zone.type == 'PUE Calculation' %}
                                            var dateLabel = Object.values(result['date']);
                                                 
                                            //$("#instPUE").text(result['InstantPUE']);
                                            //$("#intPUE").text(result['IntervalPUE']);
                                            //console.log(Object.values(result['climateDate']));
                                            displayNewData(Mixed_Pue_Power_Linechart, Object.values(result['dateP']), Object.values(result['PUE']), [startDate, endDate], 3, 'day');
                                            displayNewData(Mixed_Climate_Linechart, Object.values(result['climateDate']), Object.values(result['MixedClimate']), [startDate, endDate], 4, 'day');
                                            displayNewData(Mixed_Pue_Energy_Linechart, dateLabel, Object.values(result['MixedEnergy']), [startDate, endDate], 3, 'day');
                                            {% elseif zone.type == 'No PUE Calculation' %}
                                                $('#ea').text(String(result['EA']))
                                                $('#emission').text(String(result['kgCO2']))
                                                displayNewData(Mixed_PSCosfi_Linechart, Object.values(result['datePSCosfi']), Object.values(result['MixedPSCosfi']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                                                console.log(Object.values(result['PieActiveEnergy']));
                                                var nb = 0;
                                                {% for smartMod in zone.smartMods %}
                                                    {% if smartMod.modType ==  'Load Meter' %}
                                                    console.log(nb);
                                                    $('#smax_{{smartMod.id}}').text(Object.values(result['Smax'])[nb])
                                                    $('#fp_{{smartMod.id}}').text(Object.values(result['FP'])[nb])
                                                    nb++;
                                                    {% endif %}
                                                {% endfor %}

                                                /*var dataArray = [{% for smartMod in zone.smartMods %}
                                                    {% if smartMod.modType ==  'Load Meter' %}parseFloat(Object.values(result['PieActiveEnergy'])[{{loop.index0}}]){% if loop.last == false %},{% endif %}{% endif %}
                                                    {% endfor %}
                                                ];*/
                                                var dataArray = Object.values(result['PieActiveEnergy']);
                                                console.log("====== Array ======")
                                                console.log(dataArray);
                                                updateDonutChart(ActiveEnergy_Piechart, [
                                                    {% set nb = 0 %}
                                                    {% for smartMod in zone.smartMods %}
                                                    {% if smartMod.modType ==  'Load Meter' %}
                                                    String("{{smartMod.name}} : " + parseFloat(Object.values(result['PieActiveEnergy'])[{{nb}}]) + " kWh")
                                                    {% if loop.last == false %}
                                                    ,
                                                    {% endif %}
                                                    {% set nb = nb + 1 %}
                                                    {% endif %}
                                                    {% endfor %}
                                                ], dataArray);

                                                /*dataArray = [{% for smartMod in zone.smartMods %}
                                                    {% if smartMod.modType ==  'Load Meter' %}parseFloat(Object.values(result['PieReactiveEnergy'])[{{loop.index0}}]){% if loop.last == false %},{% endif %}{% endif %}
                                                    {% endfor %}
                                                ];*/
                                                dataArray = Object.values(result['PieReactiveEnergy']);
                                                console.log(dataArray);
                                                updateDonutChart(ReactiveEnergy_Piechart, [
                                                    {% set nb = 0 %}
                                                    {% for smartMod in zone.smartMods %}
                                                    {% if smartMod.modType ==  'Load Meter' %}
                                                    String("{{smartMod.name}} : " + parseFloat(Object.values(result['PieReactiveEnergy'])[{{nb}}]) + " kVAR")
                                                    {% if loop.last == false %}
                                                    ,
                                                    {% endif %}
                                                    {% set nb = nb + 1 %}
                                                    {% endif %}
                                                    {% endfor %}
                                                ], dataArray);
                                            {% elseif zone.type == 'Air Conditioner' %}
                                                console.log('Air Conditioner')
                                                displayNewData(Mixed_Unit_1_1_Linechart, Object.values(result['ACDate11']), Object.values(result['MixedAC11']), [startDate, endDate], 3, 'day');
                                                displayNewData(Mixed_Unit_1_2_Linechart, Object.values(result['ACDate12']), Object.values(result['MixedAC12']), [startDate, endDate], 3, 'day');
                                            {% elseif zone.type == 'AVR' %}
                                                displayNewData(Mixed_Voltage_Linechart, Object.values(result['dateVoltage']), Object.values(result['MixedVoltage']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                                            {% elseif zone.type == 'Genset' %}
                                                console.log(Object.values(result['dataFL']))
                                                console.log(Object.values(result['Mixed_Conso']))
                                                displayNewData(FuelLevelChart, Object.values(result['dataFL']['date']), Object.values(result['dataFL']['FL']), [startDate, endDate], 1, 'day');

                                                displayNewData(MixedConsoChart, result['Mixed_Conso']['date'], Object.values(result['Mixed_Conso']['conso']), [startDate, endDate], 3, 'day');
                                                {# //displayNewData(PowerProfile_Linechart, dateLabel, Object.values(result['Mix2']), date, 3, 'day');
                                                MixedConsoChart.toggleSeries('Durée de fonctionnement')
                                                MixedConsoChart.toggleSeries('Durée de fonctionnement') #}

                                                {# MixedConsoChart.updateOptions({
                                                    series: [{
                                                        name: 'Consommation Fuel',
                                                        type: 'column',
                                                        data: []
                                                    }, {
                                                        name: 'Appro Fuel',
                                                        type: 'column',
                                                        data: []
                                                    }, {
                                                        name: 'Durée de fonctionnement',
                                                        type: 'column',
                                                        data: []
                                                    }],
                                                    xaxis: {
                                                        categories: [],
                                                    }
                                                })

                                                MixedConsoChart.updateOptions({
                                                    series: [{
                                                        name: 'Consommation Fuel',
                                                        type: 'column',
                                                        data: Object.values(result['Mixed_Conso']['conso'][0])
                                                    }, {
                                                        name: 'Appro Fuel',
                                                        type: 'column',
                                                        data: Object.values(result['Mixed_Conso']['conso'][1])
                                                    }, {
                                                        name: 'Durée de fonctionnement',
                                                        type: 'column',
                                                        data: Object.values(result['Mixed_Conso']['conso'][2])
                                                    }],
                                                    xaxis: {
                                                        categories: Object.values(result['Mixed_Conso']['date']),

                                                    }
                                                })#}

                                                //Valeur de la durée totale de fonctionnement du GE
                                                $('#t-duree-totale').text(result['statsDureeFonctionnement']['totale']);
                                                {# //On gère la progression de la durée totale de fonctionnement du GE
                                                progress(prefixSelector='t-duree-totale-progress-', progValue=result['statsDureeFonctionnement']['totaleProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée moyenne de fonctionnement du GE
                                                $('#t-duree-moy').text(result['statsDureeFonctionnement']['mean']);
                                                {# //On gère la progression de la durée moyenne de fonctionnement du GE
                                                progress(prefixSelector='t-duree-moy-progress-', progValue=result['statsDureeFonctionnement']['meanProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée Médiane de fonctionnement du GE
                                                $('#t-duree-mediane').text(result['statsDureeFonctionnement']['median']);
                                                {# //On gère la progression de la durée Médiane de fonctionnement du GE
                                                progress(prefixSelector='t-duree-mediane-progress-', progValue=result['statsDureeFonctionnement']['medianProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée Min de fonctionnement du GE
                                                $('#t-duree-min').text(result['statsDureeFonctionnement']['min']);
                                                {# //On gère la progression de la durée Min de fonctionnement du GE
                                                progress(prefixSelector='t-duree-min-progress-', progValue=result['statsDureeFonctionnement']['minProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée Max de fonctionnement du GE
                                                $('#t-duree-max').text(result['statsDureeFonctionnement']['max']);
                                                {# //On gère la progression de la durée Max de fonctionnement du GE
                                                progress(prefixSelector='t-duree-max-progress-', progValue=result['statsDureeFonctionnement']['maxProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée Q1 de fonctionnement du GE
                                                $('#t-duree-Q1').text(result['statsDureeFonctionnement']['Q1']);
                                                {# //On gère la progression de la durée Q1 de fonctionnement du GE
                                                progress(prefixSelector='t-duree-Q1-progress-', progValue=result['statsDureeFonctionnement']['maxProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée Q3 de fonctionnement du GE
                                                $('#t-duree-Q3').text(result['statsDureeFonctionnement']['Q3']);
                                                {# //On gère la progression de la durée Q3 de fonctionnement du GE
                                                progress(prefixSelector='t-duree-Q3-progress-', progValue=result['statsDureeFonctionnement']['maxProgress'], posLogique=false, isTime=false); #}

                                                displayNewData(NPSChart, result['NPSchart']['date'], Object.values(result['NPSchart']['NPS']), [startDate, endDate], 1, 'day');
                                                //displayNewData(PowerProfile_Linechart, dateLabel, Object.values(result['Mix2']), date, 3, 'day');
                                                /*NPSChart.toggleSeries('Nombre de démarrage')
                                                NPSChart.toggleSeries('Nombre de démarrage')*/

                                                //Valeur de la durée total de fonctionnement du GE
                                                $('#t-nps-totale').text(result['statsNPS']['total']);
                                                {# //On gère la progression de la durée totale de fonctionnement du GE
                                                progress(prefixSelector='t-nps-totale-progress-', progValue=result['statsNPS']['totaleProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée moyen de fonctionnement du GE
                                                $('#t-nps-moy').text(result['statsNPS']['mean']);
                                                {# //On gère la progression de la durée moyenne de fonctionnement du GE
                                                progress(prefixSelector='t-nps-moy-progress-', progValue=result['statsNPS']['meanProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée Médian de fonctionnement du GE
                                                $('#t-nps-mediane').text(result['statsNPS']['median']);
                                                {# //On gère la progression de la durée Médiane de fonctionnement du GE
                                                progress(prefixSelector='t-nps-mediane-progress-', progValue=result['statsNPS']['medianProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée Min de fonctionnement du GE
                                                $('#t-nps-min').text(result['statsNPS']['min']);
                                                {# //On gère la progression de la durée Min de fonctionnement du GE
                                                progress(prefixSelector='t-nps-min-progress-', progValue=result['statsNPS']['minProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée Max de fonctionnement du GE
                                                $('#t-nps-max').text(result['statsNPS']['max']);
                                                {# //On gère la progression de la durée Max de fonctionnement du GE
                                                progress(prefixSelector='t-nps-max-progress-', progValue=result['statsNPS']['maxProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée Q1 de fonctionnement du GE
                                                $('#t-nps-Q1').text(result['statsNPS']['Q1']);
                                                {# //On gère la progression de la durée Q1 de fonctionnement du GE
                                                progress(prefixSelector='t-nps-Q1-progress-', progValue=result['statsNPS']['maxProgress'], posLogique=false, isTime=false); #}

                                                //Valeur de la durée Q3 de fonctionnement du GE
                                                $('#t-nps-Q3').text(result['statsNPS']['Q3']);
                                                {# //On gère la progression de la durée Q3 de fonctionnement du GE
                                                progress(prefixSelector='t-nps-Q3-progress-', progValue=result['NPSchart']['maxProgress'], posLogique=false, isTime=false); #}

                                            {% endif %}

                                        }
                                    },
                                    error: function (result) {
                                        // console.log("Error");
                                        // console.log(result);
                                        swal('Oops...', 'Something went wrong!', 'error'
                                        // footer: '<a href>Why do I have this issue?</a>'
                                        );

                                        setTimeout(function () {
                                            resolve()
                                        }, 5000);
                                    }
                                });
                            })
                        },
                        allowOutsideClick: false
                  }]); 

                  $(".swal2-confirm").click();
                }
                //alert("Active tab " + x);
            }

            {% if zone.type == 'No PUE Calculation' %}
            if( $(event.target).text() === 'Billing'){
                if(firstTabEnergyBilling){
                  //alert("Active tab " + x);
                  firstTabEnergyBilling = false; 
                  var drp_ = $('#daterangebilling').data('daterangepicker');
                  console.log('drp = ' + drp_.startDate.format('YYYY-MM-DD'));
                  startDate = drp_.startDate.format('YYYY-MM-DD');
                  endDate = drp_.endDate.format('YYYY-MM-DD');
                  
                  var $data_ = JSON.stringify({
                     //"selectedDate": $dat,
                     "startDate": startDate + ' 00:00:00',
                     "endDate": endDate + ' 23:59:59',
                     //"type": "zone",
                     "id":{{smartMod.id ?? 0}},
                     "zoneId": {{zone.id}},
                  });

                    // Danger

                  swal.queue([{
                        title: 'Waiting...',
                        confirmButtonText: 'Confirm',
                        text: 'Please wait !',
                        //showCancelButton: true,
                        showLoaderOnConfirm: true,
                        //confirmButtonClass: 'btn btn-primary',
                        //cancelButtonClass: 'btn btn-danger ml-2',
                    
                        //title: 'The graphs will be updated for the date range :',
                        //confirmButtonText: 'Confirm',
                        //text: 'From ' + startDate_ + ' To ' + endDate_,
                        //showCancelButton: true,
                        //showLoaderOnConfirm: true,
                        //confirmButtonClass: 'btn btn-primary',
                        //cancelButtonClass: 'btn btn-danger ml-2',
                        preConfirm: function () {
                            return new Promise(function (resolve) { 
                                
                                $.ajax({
                                    type: "POST", // method type
                                    contentType: "application/json; charset=utf-8",
                                    url: urlBilling, // /Target function that will be return result
                                    data: $data_, // parameter pass data is parameter name param is value
                                    dataType: "json",
                                    timeout: 120000, // 64241
                                    success: function (result) {
                                        // $('.fa-sync').removeClass('fa-spin');
                                        console.log(result);
                                        
                                        swal({
                                            type: 'success', 
                                            title: 'The Bill have been updated !',
                                            // html: 'Submitted email: ' + email
                                        });
                                        setTimeout(function () {
                                            resolve()
                                        }, 2000);
                                        if( Object.keys(result).length > 0 ){
                                            //var dateLabel = Object.values(result['date']);
                                            //console.log(Object.values(result['CourbeCroisé']));
                                            //console.log(result);
                                            {# $('#PF').text(result['FP']); 
                                            $('#NHU_Psous').text(result['NHU_Psous']); 
                                            $('#NHU_Grid').text(result['NHU_Grid']); 
                                            $('#NHU_GE').text(result['NHU_FUEL']);  #}
                                            {# $('#DuréeDépassement').text(result['NHD_Psous']);  #}
                                            {# $('#SmaxLue').text(result['Smax']);  #}
                                            var Smax = parseFloat(result['Smax']);
                                            {# $('#EAP').text(result['EAP']); 
                                            $('#EAP_Amount').text(result['amountEAP']); 
                                            $('#EAHP').text(result['EAHP']); 
                                            $('#EAHP_Amount').text(result['amountEAHP']); 
                                            $('#sTotal').text(result['amountEA']); #}
                                            var prime = parseFloat($('#primeFixe').text());
                                            var amount = 0;
                                            var diffP = 0.0;
                                            console.log("Prime Fixe = " + prime);
                                            if( Smax > {{zone.powerSubscribed}}){
                                                diffP = Smax - {{zone.powerSubscribed}};
                                                amount = (diffP/1000.0)*prime;
                                                //$('#amount').text(amount.toFixed(2))
                                            }
                                            else{
                                                //$('#amount').text(0);
                                                amount = 0;
                                                diffP = 0.0;
                                            }
                                            //tableBilling.cell(0,1).data(value['AVG']).draw();
                                            tableBilling.cell(1,1).data(Smax.toFixed(2)).draw();
                                            tableBilling.cell(2,1).data(diffP.toFixed(2)).draw();
                                            tableBilling.cell(3,1).data(result['NHD_Psous']).draw();
                                            //tableBilling.cell(3,1).data(data['available'][index]['av']).draw();
                                            tableBilling.cell(5,1).data(amount.toFixed(0)).draw();
                                            {# var amountHT = parseFloat(result['amountEA']) + prime; #}
                                            
                                            {# $('#Amount_HT').text(amountHT.toFixed(2)); 
                                            var taxes = (amountHT*{{zone.site.tarification.tva}})/100.0;
                                            $('#taxes').text(taxes.toFixed(2)); 
                                            var amountTTC = amountHT + taxes;
                                            $('#Amount_TTC').text(amountTTC.toFixed(2));  #}
                                                                                
                                            
                                        }
                                    },
                                    error: function (result) {
                                        // console.log("Error");
                                        // console.log(result);
                                        swal('Oops...', 'Something went wrong!', 'error'
                                        // footer: '<a href>Why do I have this issue?</a>'
                                        );
                                        setTimeout(function () {
                                            resolve()
                                        }, 5000);
                                    }
                                });
                            })
                        },
                        allowOutsideClick: false
                  }]); 

                  $(".swal2-confirm").click();
                }
                
            }
            {% endif %}
            
        });
    </script>

    {# Historical panel script #}
    <script>
        {% if zone.type == 'No PUE Calculation' %}
            //Mixed Apparent Power - Active Power - Cosphi charts
            var options = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                plotOptions: {
                    bar: {
                        columnWidth: '50%'
                    }
                },
                colors: ["#1ecab8", "#fbb624", "#f93b7a"],
                series: [{
                    name: 'Apparent Power',
                    type: 'line',
                    //data: [23, 11, 22, 27, 13, 22, 37, 21, 44, 22, 30]
                    data: []
                }, {
                    name: 'Active Power',
                    type: 'line',
                    //data: [44, 55, 41, 67, 22, 43, 21, 41, 56, 27, 43]
                    data: []
                }, {
                    name: 'CosPhi',
                    type: 'line',
                    //data: [30, 25, 36, 30, 45, 35, 64, 52, 59, 36, 39]
                    data: []
                }],
                fill: {
                    opacity: [1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                //labels: ['01/01/2003', '02/01/2003', '03/01/2003', '04/01/2003', '05/01/2003', '06/01/2003', '07/01/2003', '08/01/2003', '09/01/2003', '10/01/2003', '11/01/2003'],
                labels: [],
                markers: {
                    size: 0
                },
                legend: {
                    offsetY: -10,
                    position: 'bottom',
                },
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM YYYY').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#1ecab8'
                        },
                        labels: {
                            style: {
                                color: '#1ecab8',
                            }
                        },
                        title: {
                            text: "VA"
                        },
                    },

                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            },
                            offsetX: 10
                        },
                        title: {
                            text: "Watts",
                        },
                    },
                    {
                        opposite: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#f93b7a'
                        },
                        labels: {
                            style: {
                                color: '#f93b7a',
                            }
                        },
                        title: {
                            text: ""
                        }
                    },

                ],    
                tooltip: {
                    shared: true,
                    intersect: false,
                    theme: "dark",
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2) + "";
                            }
                            return y;

                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                }
            }
            
            var Mixed_PSCosfi_Linechart = new ApexCharts(
                document.querySelector("#apex_mixed_PSCosfi"),
                options
            );

            Mixed_PSCosfi_Linechart.render();

            var options = {
                chart: {
                    height: 320,
                    type: 'pie',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                stroke: {
                    show: true,
                    width: 2,
                    colors: ['transparent']
                },
                series: [{% for smartMod in zone.smartMods %}{% if smartMod.modType ==  'Load Meter' %}{{ random(0, 0) }}{% if loop.last == false %},{% endif %}{% endif %}{% endfor %}],
                labels: [{% for smartMod in zone.smartMods %}{% if smartMod.modType ==  'Load Meter' %}"{{smartMod.name}}"{% if loop.last == false %},{% endif %}{% endif %}{% endfor %}],
                //colors: ["#a3cae0", "#232f5b","#f06a6c", "#f1e299", "#08aeb0"],
                legend: {
                    show: true,
                    position: 'bottom',
                    horizontalAlign: 'center',
                    verticalAlign: 'middle',
                    floating: false,
                    fontSize: '14px',
                    offsetX: 0,
                    offsetY: -10
                },
                tooltip: {
                    theme: "dark",
                    style: {
                        color: '#fff',
                    }
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        chart: {
                            height: 240
                        },
                        legend: {
                            show: false
                        },
                    }
                }]
            }
            var ActiveEnergy_Piechart = new ApexCharts(
                document.querySelector("#apex_pie_active_energy_flow"),
                options
            );
            ActiveEnergy_Piechart.render();
            
            var options = {
                chart: {
                    height: 320,
                    type: 'pie',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                stroke: {
                    show: true,
                    width: 2,
                    colors: ['transparent']
                },
                series: [{% for smartMod in zone.smartMods %}{% if smartMod.modType ==  'Load Meter' %}{{ random(0, 0) }}{% if loop.last == false %},{% endif %}{% endif %}{% endfor %}],
                labels: [{% for smartMod in zone.smartMods %}{% if smartMod.modType ==  'Load Meter' %}"{{smartMod.name}}"{% if loop.last == false %},{% endif %}{% endif %}{% endfor %}],
                //colors: ["#a3cae0", "#232f5b","#f06a6c", "#f1e299", "#08aeb0"],
                legend: {
                    show: true,
                    position: 'bottom',
                    horizontalAlign: 'center',
                    verticalAlign: 'middle',
                    floating: false,
                    fontSize: '14px',
                    offsetX: 0,
                    offsetY: -10
                },
                tooltip: {
                    theme: "dark",
                    style: {
                        color: '#fff',
                    },
                    
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        chart: {
                            height: 240
                        },
                        legend: {
                            show: false
                        },
                    }
                }]
            }
            var ReactiveEnergy_Piechart = new ApexCharts(
                document.querySelector("#apex_pie_reactive_energy_flow"),
                options
            );
            ReactiveEnergy_Piechart.render();
        {% endif %}
                
        {% if zone.type == 'PUE Calculation' %}
            //Mixed IT Active Power Zone - Active Power Equipments - PUE charts
            var options = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            position: 'top', // top, center, bottom
                        },
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                series: [{
                    name: 'IT Power',
                    type: 'line',
                    data: []
                    //data: [1.4, 2, 2.5, 1.5, 2.5, 2.8, 3.8, 4.6]
                }, {
                    name: 'DataCenter Power',
                    type: 'line',
                    data: []
                    //data: [1.1, 3, 3.1, 4, 4.1, 4.9, 6.5, 8.5]
                }, {
                    name: 'PUE',
                    type: 'line',
                    data: []
                    //data: [1.20, 1.829, 1.37, 1.36, 1.44, 1.45, 1.50, 1.58]
                }],
                fill: {
                    opacity: [1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                colors: ["#fbb624", "#77d0ba", "#e02040"], //
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            }
                        },
                        title: {
                            text: "IT Power (kW)"
                        },
                    },
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#77d0ba'
                        },
                        labels: {
                            style: {
                                color: '#77d0ba',
                            },
                            offsetX: 10
                        },
                        title: {
                            text: "DataCenter Power (kW)",
                        },
                    },
                    {
                        opposite: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#e02040'
                        },
                        labels: {
                            style: {
                                color: '#e02040',
                            }
                        },
                        title: {
                            text: "PUE"
                        }
                    },
                ],
                tooltip: {
                    theme: "dark",
                    followCursor: true,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2)
                            } 
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm:ss")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                },
                legend: {
                    offsetY: -10,
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        yaxis: {
                            show: false
                        },
                        legend: {
                            show: false
                        }
                    }
                }]
            }
            
            var Mixed_Pue_Power_Linechart = new ApexCharts(
                document.querySelector("#apex_mixed_pue_power"),
                options
            );
            Mixed_Pue_Power_Linechart.render();

            //Mixed Temperature Indoor-Outdoor - Humidity Indoor-Outdoor
            var options = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            position: 'top', // top, center, bottom
                        },
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [2, 2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet available',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                series: [{
                    name: 'Temperature Indoor',
                    type: 'line',
                    data: []
                    //data: [25, 24.8, 25.2, 25.8, 25.4, 25.6, 25.1, 25.7]
                }, {
                    name: 'Temperatue Outdoor',
                    type: 'line',
                    data: []
                    //data: [28, 30.1, 29.3, 29.5, 28.7, 29.7, 30.5, 31]
                }, {
                    name: 'Humidity Indoor',
                    type: 'line',
                    data: []
                    //data: [84, 90, 94, 97, 95, 93, 80, 82]
                }, {
                    name: 'Humidity Outdoor',
                    type: 'line',
                    data: []
                    //data: [90, 84, 97, 94, 93, 95, 84, 87]
                }],
                fill: {
                    opacity: [1, 1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                colors: ["rgb(0, 143, 251)","#fbb624", "#77d0ba", "#e02040"], //
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: 'rgb(0, 143, 251)'
                        },
                        labels: {
                            style: {
                                color: 'rgb(0, 143, 251)',
                            }
                        },
                        title: {
                            text: "Temperature Indoor (°C)"
                        },
                    },
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            }
                        },
                        title: {
                            text: "Temperature Outdoor (°C)"
                        },
                    },
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#77d0ba'
                        },
                        labels: {
                            style: {
                                color: '#77d0ba',
                            },
                            offsetX: 10
                        },
                        title: {
                            text: "Humidity Indoor (%)",
                        },
                    },
                    {
                        opposite: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#e02040'
                        },
                        labels: {
                            style: {
                                color: '#e02040',
                            }
                        },
                        title: {
                            text: "Humidity Outdoor (%)"
                        }
                    },
                ],
                tooltip: {
                    theme: "dark",
                    followCursor: true,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2)
                            } 
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm:ss")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                },
                legend: {
                    offsetY: -10,
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        yaxis: {
                            show: false
                        },
                        legend: {
                            show: false
                        }
                    }
                }]
            }
            
            var Mixed_Climate_Linechart = new ApexCharts(
                document.querySelector("#apex_mixed_climate"),
                options
            );
            Mixed_Climate_Linechart.render();

            //Mixed Energy charts
            var options = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            position: 'top', // top, center, bottom
                        },
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet available',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                series: [{
                    name: 'Active Energy of {{zone.name}}',
                    type: 'column',
                    data: []
                    //data: [1.4, 2, 2.5, 1.5, 2.5, 2.8, 3.8, 4.6]
                }, {
                    name: 'Active Energy of Production equipments',
                    type: 'column',
                    data: []
                    //data: [1.1, 3, 3.1, 4, 4.1, 4.9, 6.5, 8.5]
                }, {
                    name: 'Interval PUE',
                    type: 'area',
                    data: []
                    //data: [20, 29, 37, 36, 44, 45, 50, 58]
                }],
                fill: {
                    opacity: [1, 1, 0.25],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                colors: ["#fbb624", "#77d0ba", "#e02040"],
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            }
                        },
                        title: {
                            text: "Active Energy of {{zone.name}} (kWh)"
                        },
                    },
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#77d0ba'
                        },
                        labels: {
                            style: {
                                color: '#77d0ba',
                            },
                            offsetX: 10
                        },
                        title: {
                            text: "Active Energy of Production Equipments (kWh)",
                        },
                    },
                    {
                        opposite: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#e02040'
                        },
                        labels: {
                            style: {
                                color: '#e02040',
                            }
                        },
                        title: {
                            text: "Interval PUE"
                        }
                    },
                ],
                tooltip: {
                    theme: "dark",
                    followCursor: true,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2) + ""
                            } 
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                },
                legend: {
                    offsetY: -10,
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        yaxis: {
                            show: false
                        },
                        legend: {
                            show: false
                        }
                    }
                }]
            }
            var Mixed_Pue_Energy_Linechart = new ApexCharts(
                document.querySelector("#apex_mixed_pue_energy"),
                options
            );
            Mixed_Pue_Energy_Linechart.render();
        {% endif %}

        {% if zone.type == 'Air Conditioner' %}
            //Mixed Unit 1-1 Return Air Temperature - Return Air Humidity - Fan Speed 1 Historicals Charts
            var options11 = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            position: 'top', // top, center, bottom
                        },
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                series: [{
                    name: 'Return Air Temperature',
                    type: 'line',
                    data: []
                    //data: [25, 24.8, 25.2, 25.8, 25.4, 25.6, 25.1, 25.7]
                }, {
                    name: 'Return Air Humidity',
                    type: 'line',
                    data: []
                    //data: [28, 30.1, 29.3, 29.5, 28.7, 29.7, 30.5, 31]
                }, {
                    name: 'Fan Speed 1',
                    type: 'line',
                    data: []
                    //data: [84, 90, 94, 97, 95, 93, 80, 82]
                }],
                fill: {
                    opacity: [1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                colors: ["rgb(0, 143, 251)","#fbb624", "#77d0ba"], //
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: 'rgb(0, 143, 251)'
                        },
                        labels: {
                            style: {
                                color: 'rgb(0, 143, 251)',
                            }
                        }, 
                        title: {
                            text: "Return Air Temperature (°C)"
                        },
                    },
                    {
                        show: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            }
                        },
                        title: {
                            text: "Return Air Humidity (%rH)"
                        }, 
                    },
                    {
                        opposite: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#77d0ba'
                        },
                        labels: {
                            style: {
                                color: '#77d0ba',
                            },
                            offsetX: 10
                        }, 
                        title: {
                            text: "Fan Speed (%)",
                        },
                    },
                ],
                tooltip: {
                    theme: "dark",
                    followCursor: true,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2)
                            } 
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm:ss")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                },
                legend: {
                    offsetY: -10,
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        yaxis: {
                            show: false
                        },
                        legend: {
                            show: false
                        }
                    }
                }]
            }
            
            var Mixed_Unit_1_1_Linechart = new ApexCharts(
                document.querySelector("#apex_mixed_unit_1-1"),
                options11
            );
            Mixed_Unit_1_1_Linechart.render();

            //Mixed Unit 1-2 Return Air Temperature - Return Air Humidity - Fan Speed 1 Historicals Charts
            var options12 = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            position: 'top', // top, center, bottom
                        },
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                series: [{
                    name: 'Return Air Temperature',
                    type: 'line',
                    data: []
                    //data: [25, 24.8, 25.2, 25.8, 25.4, 25.6, 25.1, 25.7]
                }, {
                    name: 'Return Air Humidity',
                    type: 'line',
                    data: []
                    //data: [28, 30.1, 29.3, 29.5, 28.7, 29.7, 30.5, 31]
                }, {
                    name: 'Fan Speed 1',
                    type: 'line',
                    data: []
                    //data: [84, 90, 94, 97, 95, 93, 80, 82]
                }],
                fill: {
                    opacity: [1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                colors: ["rgb(0, 143, 251)","#fbb624", "#77d0ba"], //
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: 'rgb(0, 143, 251)'
                        },
                        labels: {
                            style: {
                                color: 'rgb(0, 143, 251)',
                            }
                        }, 
                        title: {
                            text: "Return Air Temperature (°C)"
                        },
                    },
                    {
                        show: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#fbb624'
                        },
                        labels: {
                            style: {
                                color: '#fbb624',
                            }
                        },
                        title: {
                            text: "Return Air Humidity (%rH)"
                        }, 
                    },
                    {
                        opposite: true,
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            color: '#77d0ba'
                        },
                        labels: {
                            style: {
                                color: '#77d0ba',
                            },
                            offsetX: 10
                        }, 
                        title: {
                            text: "Fan Speed (%)",
                        },
                    },
                ],
                tooltip: {
                    theme: "dark",
                    followCursor: true,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2)
                            } 
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm:ss")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                },
                legend: {
                    offsetY: -10,
                },
                responsive: [{
                    breakpoint: 600,
                    options: {
                        yaxis: {
                            show: false
                        },
                        legend: {
                            show: false
                        }
                    }
                }]
            }
            
            var Mixed_Unit_1_2_Linechart = new ApexCharts(
                document.querySelector("#apex_mixed_unit_1-2"),
                options12
            );
            Mixed_Unit_1_2_Linechart.render();
        {% endif %}

        {% if zone.type == 'AVR' %}
            //Mixed Voltage per phase charts
            var options = {
                chart: {
                    height: 380,
                    type: 'line',
                    stacked: false,
                    toolbar: {
                        show: true
                    }
                },
                stroke: {
                    width: [2, 2, 2],
                    curve: 'smooth'
                },
                noData: {
                    text: 'Data not yet ',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '14px',
                        fontFamily: undefined
                    }
                },
                plotOptions: {
                    bar: {
                        columnWidth: '50%'
                    }
                },
                colors: ["#1ecab8", "#fbb624", "#f93b7a"],
                series: [{
                    name: 'Phase R ',
                    type: 'line',
                    // data: [23, 11, 22, 27, 13, 22, 37, 21, 44, 22, 30]
                    data: []
                }, {
                    name: 'Phase S ',
                    type: 'line',
                    // data: [44, 55, 41, 67, 22, 43, 21, 41, 56, 27, 43]
                    data: []
                }, {
                    name: 'Phase T ',
                    type: 'line',
                    // data: [30, 25, 36, 30, 45, 35, 64, 52, 59, 36, 39]
                    data: []
                }],
                fill: {
                    opacity: [1, 1, 1],
                    gradient: {
                        inverseColors: false,
                        shade: 'light',
                        type: "vertical",
                        opacityFrom: 0.85,
                        opacityTo: 0.55,
                        stops: [0, 100, 100, 100]
                    }
                },
                // labels: ['01/01/2003', '02/01/2003', '03/01/2003', '04/01/2003', '05/01/2003', '06/01/2003', '07/01/2003', '08/01/2003', '09/01/2003', '10/01/2003', '11/01/2003'],
                labels: [],
                markers: {
                    size: 0
                },
                legend: {
                    offsetY: -10,
                    position: 'bottom',
                },
                xaxis: {
                    type: 'datetime',
                    categories: [],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM YYYY').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: [
                    {
                        axisTicks: {
                            show: true,
                        },
                        axisBorder: {
                            show: true,
                            // color: '#1ecab8'
                        },
                        labels: {
                            style: {
                                // color: '#1ecab8',
                            }
                        },
                        title: {
                            text: "Volt"
                        },
                    },
                ],
                tooltip: {
                    shared: true,
                    intersect: false,
                    theme: "dark",
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return parseFloat(y).toFixed(2) + " V";
                            }
                            return y;

                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm")
                        }
                    }
                },
                grid: {
                    borderColor: '#f1f3fa'
                }
            }

            var Mixed_Voltage_Linechart = new ApexCharts(
                document.querySelector("#apex_mixed_voltage"),
                options
            );

            Mixed_Voltage_Linechart.render();
        {% endif %}

        {% if zone.type == 'Genset' %}
        var now = new Date();
        //var jsDate = now.getDate()+'-'+(now.getMonth()+1)+'-'+now.getFullYear();
        var FileName = 'Historique Consommation | ' + now.getFullYear();
        var historicTable = $('#historic-dataTable').DataTable({
            //lengthChange: false,
            //buttons: ['copy', 'excel', 'pdf', 'colvis']
            //buttons: ['excel', 'pdf'],
            searching: false,
            paging: false,
            info: false,
            order: [],
            //ordering: false,
            lengthChange: false,
            //buttons: ['copy', 'excel', 'pdf', 'colvis']
            buttons: [
                {
                    //text: 'Exporter Disponibilité',
                    extend: 'pdfHtml5',
                    filename: 'Historique Consommation - ' + now.getFullYear(),//function () { return getExportFileName();},//
                    exportOptions: {
                        //columns: [ 0, 1, 4 ],
                        //columns: ':visible'
                        search: 'applied',
                        order: 'applied'
                    },
                    title: function( thead, data, start, end, display ) {
                        return "{{site.name}}\r\n" + FileName;
                    },
                    customize: function (doc) {
                        //Remove the title created by datatTables

                        //Create a date string that we use in the footer. Format is dd-mm-yyyy
                        var now = new Date();
                        var jsDate = now.getDate()+'-'+(now.getMonth()+1)+'-'+now.getFullYear();
                        // Logo converted to base64
                        // var logo = getBase64FromImageUrl('https://datatables.net/media/images/logo.png');
                        // The above call should work, but not when called from codepen.io
                        // So we use a online converter and paste the string in.
                        // Done on http://codebeautify.org/image-to-base64-converter
                        // It's a LONG string scroll down to see the rest of the code !!!
                        //var logo = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAICAgICAQICAgIDAgIDAwYEAwMDAwcFBQQGCAcJCAgHCAgJCg0LCQoMCggICw8LDA0ODg8OCQsQERAOEQ0ODg7/2wBDAQIDAwMDAwcEBAcOCQgJDg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg7/wAARCAAwADADASIAAhEBAxEB/8QAGgAAAwEAAwAAAAAAAAAAAAAABwgJBgIFCv/EADUQAAEDAgQDBgUDBAMAAAAAAAECAwQFBgAHESEIEjEJEyJBUXEUI0JhgRVSYhYXMpEzcrH/xAAYAQADAQEAAAAAAAAAAAAAAAAEBQYHAv/EAC4RAAEDAgMGBQQDAAAAAAAAAAECAxEABAUGEhMhMUFRcSIyYaHBFkKB0ZGx8P/aAAwDAQACEQMRAD8Avy44hlhTrqw22kEqUo6BIG5JPkMSxz67RlFPzFquWnDParOaN4QVlmqXDKcKKLS19CCsf8qh6A6e+OfaK573LDTanDJllVV0q8r3ZVIuGqR1fMpdJSdHCCOinN0j7e+FjymydjRKdSbGsikpbSlG5O3/AHfeX5nU6knck6DFdg+DovkquLlWllHE8yeg+f4FBPvluEpEqNC657/4yr4ecm3ZxH1OghzxfptpQERI7X8QrqdPXGNpucXGLltU0SbZ4jazW0tHX4C6IiJcd37HUEj8YoHNtTKOzwuHVPj79rTfhkfCudxEbUOqQQd9Pc4HlaoGRt2JVAcptRsOe54WZZkd6yFHpzakgD3098ahYWuVVDQ/YrKD9wJnvGqfb8UAHH584npWw4eu0+iVO+6Vl3xO2zHy1uKa4GafdcBwqos5w7AOE6lgk+epT68uK8MvNPxmnmHEvMuJCm3EKCkqSRqCCNiCPPHmbzdyWcozkq1rpitVSkzGyqHNbT4HU+S0H6Vp22/9Bw8XZkcQ1wuzLg4V8yqq5U69a0X42zalJXq5NpeuhZJO5LWo0/idPpxI5ryszgyG77D3Nrau+U8weh/cDgQRI3sGXi54VCCKXK6Ku5fnbOcTt2znO/8A0SfFtymcx17llpGqgPTUjDj5WOIOUmYFPpLgjXQ5ES627r43I6R40I9D16fuGEfzPZeyq7afiRtec0W03O/GuSj82wdbdb8ZB89FEjb0xvrIzGk2pmnSrgcdUttl3lkoB2UyrZadPbf8DFFhGHuX+W0bASUyY6kKJg96XPK0XJmt9MrkFuIQw2XNup8IwFbruVaWXkttMgadCCcEfNuPTbbzPkiK87+jVRsTqctlIKVNubkD2J/0RgBVFDVQUpTTEksjdTjpG4xc4TYOvBu5AhB3yf8AcfmgTIUUmiMxcs27+CG42Koy3JqFqym3YLytebuVfRr9gVD2AwvOWt5u2f2qXDle0FK4UhVwijzgFbPMSUlBSftqdcMAqN/TfCVV0yGBDl3O+huMwvZXw6Oqzr67n8jC85VWw/fnakZD2tAaL/wtwGsSuTfu2YyCeY+6ikY5x1yzVlDECB4C8Nn3lEx6SFe9MWtW3R1jfVTu0l4a7lv6wbaz8yqp6p2Z2X6FmXT2U6uVelq8TrQA3UtG6gPMFQG+mJe2Xf8ASL5s1qp0p35qfDLhuHR2M4P8kLT5aH/ePUSpIUnQjUemJh8SXZs2fmVf8/MvJevKyfzNkEuTPhGeamVNZ3JeZGnKonqpPXqQTjE8tZmdwF4hSdbSjvHMHqP1zo24tw8J4EUn9MvWz7iymo9tX27PgTqQ4tMCfGY735SuiFdenTTTyGOIrGV1DSJLCqndb7Z1aamIDEZJHQqGg5vyDga3Fw28bVhS1wqrlHAzAjtkhFSt2sIQHR5HkXoQftjrqJw5cYt81BESDkuxaCVnRU24K0Fpb+/I3qT7Y1b6kygptSi88lKiSWxIEkyRygE8tUUDsbieA71mM2M0mZxlVytTQ0w0jkQlIIQ2PpabR1JJ6Abk4oP2bHDhW6O9WuITMKlLplxV9hMeg06Sn5lPgjdIUPJayedX4HljvOHvs16VbF7Uy/c86/8A3DuyIoOwoAaDdPgL66ts7gqH7lan2xVaJEjQaezFiMIjx2khLbaBoEgYyzMmZTjWi2t0bK3b8qfk+v8AW/jNMGWdn4lGVGv/2SAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA=';
                        // A documentation reference can be found at
                        // https://github.com/bpampuch/pdfmake#getting-started
                        // Set page margins [left,top,right,bottom] or [horizontal,vertical]
                        // or one number for equal spread
                        // It's important to create enough space at the top for a header !!!
                        doc.pageMargins = [60,60,60,30];
                        // Set the font size fot the entire document
                        doc.defaultStyle.fontSize = 12;
                        // Set the fontsize for the table header
                        doc.styles.tableHeader.fontSize = 13;
                        //doc.styles.tableBodyOdd.fillColor = "yellow";
                        doc.styles.tableBodyOdd.alignment = function (rowIndex, node, columnIndex) {
                            return (rowIndex >= 0) ? 'center' : null;
                        };
                        doc.styles.tableHeader.fillColor = "#6c757d";
                        console.log(doc);
                        var objTable = {};
                        //objTable['heights'] = (function(i) { return 100; });
                        //objTable['widths'] = ['*', 'auto', '*', 'auto', 'auto', 'auto'];
                        //objTable['widths']   = (function(i) { return ['*', 'auto', '*', 'auto', 'auto', 'auto']; });
                        //doc.content[1].table = objTable;
                        doc.content[1].table.widths = ['auto', '*', 'auto', '*', 'auto', '*'];
                        //doc.content[1].table.heights = (function(i) { return 100; });
                        doc.content[1].layout = {
                            fillColor: function (rowIndex, node, columnIndex) {
                                return (rowIndex % 2 === 0) ? '#CCCCCC' : null;
                            }
                        };

                        // Create a header object with 3 columns
                        // Left side: Logo
                        // Middle: brandname
                        // Right side: A document title
                        /*doc['header']=(function() {
                            return {
                                columns: [
                                    {
                                        //image: logo,
                                        "width": 24
                                    },
                                    {
                                        alignment: 'left',
                                        italics: true,
                                        text: 'dataTables',
                                        fontSize: 18,
                                        margin: [10,0]
                                    },
                                    {
                                        alignment: 'right',
                                        fontSize: 14,
                                        text: 'Custom PDF export with dataTables'
                                    }
                                ],
                                margin: 20
                            }
                        });*/
                        // Create a footer object with 2 columns
                        // Left side: report creation date
                        // Right side: current page and total pages
                        doc['footer']=(function(page, pages) {
                            return {
                                columns: [
                                    {
                                        alignment: 'left',
                                        text: ['Crée le : ', { text: jsDate.toString() }]
                                    },
                                    {
                                        alignment: 'center',
                                        text: ['{{app.user.enterprise.socialReason}} {% if app.user.enterprise.niu is not empty %}- NIU : {{app.user.enterprise.niu}} {% endif %} {% if app.user.enterprise.rccm is not empty %}- RCCM : {{app.user.enterprise.rccm}}{% endif %}']
                                    },
                                    {
                                        alignment: 'right',
                                        text: ['page ', { text: page.toString() },	' de ',	{ text: pages.toString() }]
                                    }
                                ],
                                margin: 20
                            }
                        });
                        // Change dataTable layout (Table styling)
                        // To use predefined layouts uncomment the line below and comment the custom lines below
                        // doc.content[0].layout = 'lightHorizontalLines'; // noBorders , headerLineOnly
                        var objLayout = {};
                        objLayout['hLineWidth']   = (function(i) { return .5; });
                        objLayout['vLineWidth']   = (function(i) { return .5; });
                        objLayout['hLineColor']   = (function(i) { return '#ccc'; });
                        objLayout['vLineColor']   = (function(i) { return '#ccc'; });
                        objLayout['paddingLeft']  = (function(i) { return 4; });
                        objLayout['paddingRight'] = (function(i) { return 4; });
                        doc.content[0].layout = objLayout;
                    }
                },
                {
                    //text: 'Exporter Disponibilité',
                    extend: 'excel',
                    filename: FileName,
                    exportOptions: {
                        //columns: [ 0, 1, 4 ],
                        //columns: ':visible'
                        search: 'applied',
                        order: 'applied'
                    },
                }
            ]
        });

        historicTable.buttons().container().appendTo('#historic-dataTable_wrapper .col-md-6:eq(0)');

        {# $('.buttons-pdf').children('span').prepend('<i class="mdi mdi-download mr-3"></i>');
        $('.buttons-pdf').removeClass('btn-secondary')//.addClass('btn btn-outline-danger')
        $('.buttons-excel').removeClass('btn-secondary')//.addClass('btn btn-outline-success')#}

        var fuel_level_options = {
            chart: {
                height: 350,
                type: 'area',
                toolbar: {
                    show: true,
                }
            },
            dataLabels: {
                enabled: false
            },
            stroke: {
                curve: 'smooth'
            },
            series: [{
                name: 'Fuel Level ',
                 data: [31, 40, 28, 51, 42, 109, 100]
                // data: []
            }],

            xaxis: {
                type: 'datetime',
                // categories: [],
                 categories: ["2018-09-19T00:00:00", "2018-09-19T01:30:00", "2018-09-19T02:30:00", "2018-09-19T03:30:00", "2018-09-19T04:30:00", "2018-09-19T05:30:00", "2018-09-19T06:30:00"],
                labels: {
                    datetimeFormatter: {
                        year: 'yyyy',
                        month: 'MMM \'yy',
                        day: 'dd MMM',
                        hour: 'HH:mm'
                    }
                },
            },
            yaxis: [{
                title: {
                    text: 'Fuel Level (%)',
                },

            }],
            tooltip: {
                theme: "dark",
                //followCursor: true,
                y: {
                    formatter: function (y) {
                        //console.log(y)
                        if (typeof y !== "undefined") {
                            return y.toFixed(2) + "%"
                        }
                        return y;
                    }
                },
                x: {
                    formatter: function (val, timestamp) {
                        return moment(new Date(val)).format("DD MMM YYYY HH:mm")
                    }
                }
            },
        }

        var FuelLevelChart = new ApexCharts(
            document.querySelector("#fuel-level-chart-histo"),
            fuel_level_options
        );

        FuelLevelChart.render();

        var mixed_duree_conso_options = {
            chart: {
                fontFamily: 'Nunito, sans-serif',
                height: 350,
                type: 'line',
                toolbar: {
                    show: true,
                }
            },
            series: [{
                name: 'Fuel Consumption ',
                type: 'column',
                {# data: [23, 42, 35, 27, 43, 22, 17, 31, 22, 22, 12, 16] #}
                data: []
            }, {
                name: 'Fuel Supply ',
                type: 'column',
                {# data: [10, 22, 15, 17, 23, 12, 7, 11, 12, 12, 6, 4] #}
                data: []
            }, {
                name: 'Running Time ',
                type: 'column',
                {# data: [440, 505, 414, 671, 227, 413, 201, 352, 752, 320, 257, 160] #}
                data: []
            }],
            stroke: {
                curve: 'smooth',
                width: [4, 4, 2]
            },
            /* title: {
                text: 'Traffic Sources'
            }, */
            xaxis: {
                type: 'datetime',
                categories: [],
                {#  categories: ['01 Jan 2001', '02 Jan 2001', '03 Jan 2001', '04 Jan 2001', '05 Jan 2001', '06 Jan 2001', '07 Jan 2001', '08 Jan 2001', '09 Jan 2001', '10 Jan 2001', '11 Jan 2001', '12 Jan 2001'], #}
                labels: {
                    datetimeFormatter: {
                        year: 'yyyy',
                        month: 'MMM \'yy',
                        day: 'dd MMM',
                        hour: 'HH:mm'
                    }
                },
            },
            yaxis: [{
                seriesName: 'Fuel Consumption ',
                opposite: false,
                title: {
                    text: 'Liters'
                },labels: {
                    /**
                     * Allows users to apply a custom formatter function to yaxis labels.
                     *
                     * @param { String } value - The generated value of the y-axis tick
                     * @param { index } index of the tick / currently executing iteration in yaxis labels array
                     */
                    formatter: function(val, index) {
                        return parseFloat(val).toFixed(2);
                    }
                }
            }, {
                seriesName: 'Fuel Consumption ',
                show: false,
            }, {
                opposite: true,
                seriesName: 'Running Time ',
                title: {
                    text: 'Running Time (HH:mm:ss)'
                },
                labels: {
                    /**
                     * Allows users to apply a custom formatter function to yaxis labels.
                     *
                     * @param { String } value - The generated value of the y-axis tick
                     * @param { index } index of the tick / currently executing iteration in yaxis labels array
                     */
                    formatter: function(val, index) {
                        {# return val.toFixed(2); #}
                        var seconds = val * 60 * 60;
                        var hours = Math.floor(seconds / 3600);
                        var minutes = Math.floor((seconds / 60) % 60);
                        seconds = seconds % 60;
                        seconds = parseFloat(seconds).toFixed(0);

                        if (hours   < 10) {hours   = "0"+hours;}
                        if (minutes < 10) {minutes = "0"+minutes;}
                        if (seconds < 10) {seconds = "0"+seconds;}
                        {# console.log(hours+':'+minutes+':'+seconds) #}
                        return hours+':'+minutes+':'+seconds;
                    }
                }
            }],
            tooltip: {
                theme: "dark",
                //followCursor: true,
                y: {
                    formatter: function (value, s) {
                        var seriesIndex = s.seriesIndex;
                        {# console.log(seriesIndex) #}
                        if (typeof value !== "undefined") {
                            {# switch(seriesIndex){
                            case 0:
                                return value.toFixed(2) + " L"
                                break;
                            case 1:
                                return value.toFixed(2) + " L"
                                break;
                            case 2:
                                break;
                        } #}
                            if(seriesIndex < 2) return value.toFixed(2) + " L"
                            else if(seriesIndex === 2){
                                var seconds = value * 60 * 60;
                                var hours = Math.floor(seconds / 3600);
                                var minutes = Math.floor((seconds / 60) % 60);
                                seconds = seconds % 60;
                                seconds = parseFloat(seconds).toFixed(0);

                                if (hours   < 10) {hours   = "0"+hours;}
                                if (minutes < 10) {minutes = "0"+minutes;}
                                if (seconds < 10) {seconds = "0"+seconds;}
                                {# console.log(hours+':'+minutes+':'+seconds) #}
                                return hours+':'+minutes+':'+seconds;

                            }
                        }
                        return value;
                    }
                },
                x: {
                    formatter: function (val, timestamp) {
                        return moment(new Date(val)).format("DD MMM YYYY")
                    }
                }
            },

        }
        {# console.log("======== Options ========")
        console.log(mixed_duree_conso_options) #}
        var MixedConsoChart = new ApexCharts(
            document.querySelector("#mixed-duree-conso"),
            mixed_duree_conso_options
        );
        MixedConsoChart.render()

        var nps_options = {
            chart: {
                fontFamily: 'Nunito, sans-serif',
                height: 350,
                type: 'line',
                toolbar: {
                    show: true,
                }
            },
            series: [{
                name: 'Number of Start-ups',
                type: 'column',
                {# data: [23, 42, 35, 27, 43, 22, 17, 31, 22, 22, 12, 16] #}
                 data: []
            }{#, {
            name: 'Appro Fuel',
            type: 'column',
            data: [10, 22, 15, 17, 23, 12, 7, 11, 12, 12, 6, 4]
            //data: []
        }, {
            name: 'Durée de fonctionnement',
            type: 'column',
            data: [440, 505, 414, 671, 227, 413, 201, 352, 752, 320, 257, 160]
            //data: []
        } #}],
            stroke: {
                curve: 'smooth',
                width: [4, 4, 2]
            },
            /* title: {
                text: 'Traffic Sources'
            }, */
            xaxis: {
                type: 'datetime',
                categories: [],
                {# categories: ['01 Jan 2001', '02 Jan 2001', '03 Jan 2001', '04 Jan 2001', '05 Jan 2001', '06 Jan 2001', '07 Jan 2001', '08 Jan 2001', '09 Jan 2001', '10 Jan 2001', '11 Jan 2001', '12 Jan 2001'], #}
                labels: {
                    datetimeFormatter: {
                        year: 'yyyy',
                        month: 'MMM \'yy',
                        day: 'dd MMM',
                        hour: 'HH:mm'
                    }
                },
            },
            yaxis: [{
                seriesName: 'Nombre de démarrage',
                opposite: false,
                title: {
                    text: 'Number'
                }
            }{#, {
            seriesName: 'Consommation Fuel',
            show: false,
        }, {
            opposite: true,
            seriesName: 'Durée de fonctionnement',
            title: {
                text: 'Durée de fonctionnement (Heures)'
            }
        }#}],
            tooltip: {
                theme: "dark",
                //followCursor: true,
                y: {
                    formatter: function (y) {
                        //console.log(y)
                        /*if (typeof y !== "undefined") {
                            return y.toFixed(2) + ""
                        }*/
                        return y;
                    }
                },
                x: {
                    formatter: function (val, timestamp) {
                        return moment(new Date(val)).format("DD MMM YYYY")
                    }
                }
            },

        }

        var NPSChart = new ApexCharts(
            document.querySelector("#nps-chart"),
            nps_options
        );
        NPSChart.render()
        {% endif %}

        var _url = "{{ path('update_zone_graphs') }}";
        var drp = $('#daterange').data('daterangepicker');
        console.log('drp = ' + drp.startDate.format('YYYY-MM-DD'));
        var startDate = drp.startDate.format('YYYY-MM-DD');
        var endDate = drp.endDate.format('YYYY-MM-DD');
        
        $('#daterange').on('apply.daterangepicker', function (ev, picker) {
            //console.log(picker.startDate.format('YYYY-MM-DD'));
            //console.log(picker.endDate.format('YYYY-MM-DD'));
        
            startDate = picker.startDate.format('YYYY-MM-DD');
            endDate = picker.endDate.format('YYYY-MM-DD');
            
            console.log('startDate = ' + startDate);
            console.log('endDate = ' + endDate);
            updateDashboard();
            // block of code that runs when the click event triggers
        });
        
        function displayNewData(chart, label, data, dateopt, multiple, xscale){
            //chart.data.labels = [];
            chart.updateOptions({
                xaxis: {
                    categories: []
                },
            });
            /*chart.updateOptions({
                xaxis: {
                    categories: label
                },
            });*/
            //chart.opts.labels = label;
            chart.updateOptions({
                labels: label
                
            });
            if(multiple > 1){
                var i = 0;
                chart.opts.series.forEach((dataset) => {
                    if( i < multiple){
                        dataset.data = [];
                        dataset.data = data[i++];
                        console.log(dataset.name);
                    }
                });
            }
            else if(multiple == 1){
                chart.updateSeries([{
                    data: []
                }]);
            
                chart.updateSeries([{
                    data: data
                }]);
            }

            /*if(xscale === 'day'){
                chart.updateOptions({
                    xaxis: {
                        title: {
                            //text: moment(dateopt).format('DD MMMM').toString(),
                            text: moment(dateopt[0]).format('DD MMMM YYYY').toString(),
                        }
                    },
                    tooltip: {
                        x: {
                            formatter: function (val, timestamp) {
                                return moment(new Date(val)).format("DD MMM YYYY HH:mm:ss")
                            }
                        }
                    }
                });
            }
            else if( xscale === 'month'){
                chart.updateOptions({
                    xaxis: {
                        title: {
                            text: moment(dateopt[0]).format('DD MMMM YYYY').toString() + ' - ' + moment(dateopt[1]).format('DD MMMM YYYY').toString(),
                        }
                    },
                    tooltip: {
                        x: {
                            formatter: function (val, timestamp) {
                                return moment(new Date(val)).format("DD MMM YYYY")
                            }
                        }
                    }
                });
            }*/

            if(xscale === 'day'){
                chart.updateOptions({
                    xaxis: {
                        title: {
                            //text: moment(dateopt).format('DD MMMM').toString(),
                            text: moment(dateopt[0]).format('DD MMMM YYYY').toString() + ' - ' + moment(dateopt[1]).format('DD MMMM YYYY').toString(),
                        }
                    },
                });
            }
            else if( xscale === 'month'){
                chart.updateOptions({
                    xaxis: {
                        title: {
                            text: moment(dateopt[0]).format('MMMM YYYY').toString() + ' - ' + moment(dateopt[1]).format('MMMM YYYY').toString(),
                        }
                    },
                });
            }
            //console.log(chart.options.scales.xAxes[0].scaleLabel.labelString);
            //preloaderChart(id, false);
            //chart.render();
        }   

        function displayPieNewData(chart, label, data, dateopt, multiple, xscale){
            //chart.data.labels = [];
            chart.updateOptions({
                xaxis: {
                    categories: []
                },
            });
            /*chart.updateOptions({
                xaxis: {
                    categories: label
                },
            });*/
            //chart.opts.labels = label;
            /*chart.updateOptions({
                labels: label
                
            });*/
            chart.updateOptions({
                labels: label
                
            });

            {# if(multiple > 1){
                var i = 0;
                data.forEach(function (item, index) {
                    chart.data.series.push(item);
                });
                /*chart.opts.series.forEach((dataset) => {
                    if( i < multiple){
                        dataset.data = [];
                        dataset.data = data[i++];
                        //this.data.series.push(response.data[i].value);
                        //this.data.chartOptions.labels.push(response.data[i].key);
                        //console.log(dataset.name);
                    }
                });*/
            }
            else if(multiple == 1){
                chart.updateSeries([{
                    data: []
                }]);
            
                chart.data.series.push(data);
                
                /*chart.updateSeries([{
                    data: data
                }]);*/
            }
            if(xscale === 'day'){
                chart.updateOptions({
                    xaxis: {
                        title: {
                            //text: moment(dateopt).format('DD MMMM').toString(),
                            text: moment(dateopt[0]).format('DD MMMM YYYY').toString() + ' - ' + moment(dateopt[1]).format('DD MMMM YYYY').toString(),
                        }
                    },
                });
            }
            else if( xscale === 'month'){
                chart.updateOptions({
                    xaxis: {
                        title: {
                            text: moment(dateopt[0]).format('MMMM YYYY').toString() + ' - ' + moment(dateopt[1]).format('MMMM YYYY').toString(),
                        }
                    },
                });
            } #}
            if(multiple > 1){
                var i = 0;
                chart.opts.series.forEach((dataset) => {
                    if( i < multiple){
                        dataset.data = [];
                        dataset.data = data[i++];
                        console.log(dataset.name);
                    }
                });
            }
            else if(multiple == 1){
                chart.updateSeries([{
                    data: []
                }]);
            
                chart.updateSeries([{
                    data: data
                }]);
            }
            if(xscale === 'day'){
                chart.updateOptions({
                    xaxis: {
                        title: {
                            //text: moment(dateopt).format('DD MMMM').toString(),
                            text: moment(dateopt[0]).format('DD MMMM YYYY').toString() + ' - ' + moment(dateopt[1]).format('DD MMMM YYYY').toString(),
                        }
                    },
                });
            }
            else if( xscale === 'month'){
                chart.updateOptions({
                    xaxis: {
                        title: {
                            text: moment(dateopt[0]).format('MMMM YYYY').toString() + ' - ' + moment(dateopt[1]).format('MMMM YYYY').toString(),
                        }
                    },
                });
            }
            //console.log(chart.options.scales.xAxes[0].scaleLabel.labelString);
            //preloaderChart(id, false);
            //chart.render();
        }  

        function updateDonutChart(chart, label, data) {
            chart.updateOptions({labels: label});
            chart.updateSeries(newDataSeries(chart, data));
        }
        
        function newDataSeries(chart, data) {
            var i = 0;
            return chart.w.globals.series.map(function () {
                return data[i++];
            });
        }

        function updateDashboard(date){
            
            $data = JSON.stringify({
                "startDate": startDate + ' 00:00:00',
                "endDate": endDate + ' 23:59:59', 
                {# "productionIds":{{smartModsProduction}}, #}
                "zoneId": {{zone.id}},
            });
            
            swal.queue([{
                title: 'The graphs will be updated for the date range :',
                confirmButtonText: 'Confirm',
                text: 'From ' + startDate + ' To ' + endDate,
                showCancelButton: true,
                showLoaderOnConfirm: true,
                confirmButtonClass: 'btn btn-primary',
                cancelButtonClass: 'btn btn-danger ml-2',
                preConfirm: function () {
                    return new Promise(function (resolve) { 
                        
                        $.ajax({
                            type: "POST", // method type
                            contentType: "application/json; charset=utf-8",
                            url: _url, // /Target function that will be return result
                            data: $data, // parameter pass data is parameter name param is value
                            dataType: "json",
                            timeout: 120000, // 64241
                            success: function (result) {
                                // $('.fa-sync').removeClass('fa-spin');
                                //console.log(result);
                                
                                swal({
                                    type: 'success', 
                                    title: 'The graphs have been updated !',
                                    // html: 'Submitted email: ' + email
                                });
                                setTimeout(function () {
                                    resolve()
                                }, 2000);
                                if( Object.keys(result).length > 0 ){
                                    
                                    console.log(result);
                                       
                                     
                                    //displayPieNewData(ActiveEnergy_Piechart, dateLabel, Object.values(result['PieActiveEnergy']), [startDate, endDate], {{ zone.smartMods|length }}, 'day');
                                    //displayPieNewData(ReactiveEnergy_Piechart, dateLabel, Object.values(result['PieReactiveEnergy']), [startDate, endDate], {{ zone.smartMods|length }}, 'day');
                                    
                                    {% if zone.type == 'PUE Calculation' %}     
                                        var dateLabel = Object.values(result['date']);
                                        //$("#instPUE").text(result['InstantPUE']);
                                        //$("#intPUE").text(result['IntervalPUE']);
                                        //console.log(Object.values(result['climateDate']));
                                        displayNewData(Mixed_Pue_Power_Linechart, Object.values(result['dateP']), Object.values(result['PUE']), [startDate, endDate], 3, 'day');
                                        displayNewData(Mixed_Climate_Linechart, Object.values(result['climateDate']), Object.values(result['MixedClimate']), [startDate, endDate], 4, 'day');
                                        displayNewData(Mixed_Pue_Energy_Linechart, dateLabel, Object.values(result['MixedEnergy']), [startDate, endDate], 3, 'day');
                                    {% elseif zone.type == 'No PUE Calculation' %}  
                                        $('#ea').text(String(result['EA']))
                                        $('#emission').text(String(result['kgCO2']))
                                        displayNewData(Mixed_PSCosfi_Linechart, Object.values(result['datePSCosfi']), Object.values(result['MixedPSCosfi']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                                        console.log(Object.values(result['PieActiveEnergy']));
                                        {% set nb = 0 %}
                                        {% for smartMod in zone.smartMods %}
                                            {% if smartMod.modType ==  'Load Meter' %}
                                            $('#smax_{{smartMod.id}}').text(Object.values(result['Smax'])[{{nb}}])
                                            $('#fp_{{smartMod.id}}').text(Object.values(result['FP'])[{{nb}}])
                                            {% set nb = nb + 1 %}
                                            {% endif %}
                                        {% endfor %}
                                        /*Object.values(result['Smax']).forEach(function (item, index) {
                                            var id = '#smax_' + index;
                                            console.log(item);
                                            $(id).text(item)
                                        });
                                        Object.values(result['Smax']).forEach(function (item, index) {
                                            var id  = '#fp_' + index;
                                            console.log(id);
                                            $(id).text(item)
                                        });*/
                                        /*$.each(Object.values(result['Smax']) , function( key, value ) {
                                            $('#smax_' + key).text(value)
                                        });
                                        $.each( Object.values(result['FP']), function( key, value ) {
                                            $('#fp_' + key).text(value)
                                        }); */        

                                        /*var dataArray = [{% for smartMod in zone.smartMods %}
                                            {% if smartMod.modType ==  'Load Meter' %}parseFloat(Object.values(result['PieActiveEnergy'])[{{loop.index0}}]){% if loop.last == false %},{% endif %}{% endif %}
                                            {% endfor %}
                                        ];*/
                                        var dataArray = Object.values(result['PieActiveEnergy']);
                                        console.log("====== Array ======")
                                        console.log(dataArray);
                                        updateDonutChart(ActiveEnergy_Piechart, [
                                            {% set nb = 0 %}
                                            {% for smartMod in zone.smartMods %}
                                            {% if smartMod.modType ==  'Load Meter' %}
                                            String("{{smartMod.name}} : " + parseFloat(Object.values(result['PieActiveEnergy'])[{{nb}}]) + " kWh")
                                            {% if loop.last == false %}
                                            ,
                                            {% endif %}
                                            {% set nb = nb + 1 %}
                                            {% endif %}
                                            {% endfor %}
                                        ], dataArray);
                                        
                                        /*dataArray = [{% for smartMod in zone.smartMods %}
                                            {% if smartMod.modType ==  'Load Meter' %}parseFloat(Object.values(result['PieReactiveEnergy'])[{{loop.index0}}]){% if loop.last == false %},{% endif %}{% endif %}
                                            {% endfor %}
                                        ];*/
                                        dataArray = Object.values(result['PieReactiveEnergy']);
                                        console.log(dataArray);
                                        updateDonutChart(ReactiveEnergy_Piechart, [
                                            {% set nb = 0 %}
                                            {% for smartMod in zone.smartMods %}
                                            {% if smartMod.modType ==  'Load Meter' %}
                                            String("{{smartMod.name}} : " + parseFloat(Object.values(result['PieReactiveEnergy'])[{{nb}}]) + " kVAR")
                                            {% if loop.last == false %}
                                            ,
                                            {% endif %}
                                            {% set nb = nb + 1 %}
                                            {% endif %}
                                            {% endfor %}
                                        ], dataArray);
                                    {% elseif zone.type == 'Air Conditioner' %}
                                        console.log('Air Conditioner')
                                        displayNewData(Mixed_Unit_1_1_Linechart, Object.values(result['ACDate11']), Object.values(result['MixedAC11']), [startDate, endDate], 3, 'day');
                                        displayNewData(Mixed_Unit_1_2_Linechart, Object.values(result['ACDate12']), Object.values(result['MixedAC12']), [startDate, endDate], 3, 'day');
                                    {% elseif zone.type == 'AVR' %}
                                        displayNewData(Mixed_Voltage_Linechart, Object.values(result['dateVoltage']), Object.values(result['MixedVoltage']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 3, 'day');
                                    {% elseif zone.type == 'Genset' %}
                                    console.log(Object.values(result['dataFL']))
                                    console.log(Object.values(result['Mixed_Conso']))
                                    displayNewData(FuelLevelChart, Object.values(result['dataFL']['date']), Object.values(result['dataFL']['FL']), [startDate, endDate], 1, 'day');

                                    displayNewData(MixedConsoChart, result['Mixed_Conso']['date'], Object.values(result['Mixed_Conso']['conso']), [startDate, endDate], 3, 'day');
                                    {# //displayNewData(PowerProfile_Linechart, dateLabel, Object.values(result['Mix2']), date, 3, 'day');
                                                MixedConsoChart.toggleSeries('Durée de fonctionnement')
                                                MixedConsoChart.toggleSeries('Durée de fonctionnement') #}

                                    {# MixedConsoChart.updateOptions({
                                                    series: [{
                                                        name: 'Consommation Fuel',
                                                        type: 'column',
                                                        data: []
                                                    }, {
                                                        name: 'Appro Fuel',
                                                        type: 'column',
                                                        data: []
                                                    }, {
                                                        name: 'Durée de fonctionnement',
                                                        type: 'column',
                                                        data: []
                                                    }],
                                                    xaxis: {
                                                        categories: [],
                                                    }
                                                })

                                                MixedConsoChart.updateOptions({
                                                    series: [{
                                                        name: 'Consommation Fuel',
                                                        type: 'column',
                                                        data: Object.values(result['Mixed_Conso']['conso'][0])
                                                    }, {
                                                        name: 'Appro Fuel',
                                                        type: 'column',
                                                        data: Object.values(result['Mixed_Conso']['conso'][1])
                                                    }, {
                                                        name: 'Durée de fonctionnement',
                                                        type: 'column',
                                                        data: Object.values(result['Mixed_Conso']['conso'][2])
                                                    }],
                                                    xaxis: {
                                                        categories: Object.values(result['Mixed_Conso']['date']),

                                                    }
                                                })#}

                                    //Valeur de la durée totale de fonctionnement du GE
                                    $('#t-duree-totale').text(result['statsDureeFonctionnement']['totale']);
                                    {# //On gère la progression de la durée totale de fonctionnement du GE
                                                progress(prefixSelector='t-duree-totale-progress-', progValue=result['statsDureeFonctionnement']['totaleProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée moyenne de fonctionnement du GE
                                    $('#t-duree-moy').text(result['statsDureeFonctionnement']['mean']);
                                    {# //On gère la progression de la durée moyenne de fonctionnement du GE
                                                progress(prefixSelector='t-duree-moy-progress-', progValue=result['statsDureeFonctionnement']['meanProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée Médiane de fonctionnement du GE
                                    $('#t-duree-mediane').text(result['statsDureeFonctionnement']['median']);
                                    {# //On gère la progression de la durée Médiane de fonctionnement du GE
                                                progress(prefixSelector='t-duree-mediane-progress-', progValue=result['statsDureeFonctionnement']['medianProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée Min de fonctionnement du GE
                                    $('#t-duree-min').text(result['statsDureeFonctionnement']['min']);
                                    {# //On gère la progression de la durée Min de fonctionnement du GE
                                                progress(prefixSelector='t-duree-min-progress-', progValue=result['statsDureeFonctionnement']['minProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée Max de fonctionnement du GE
                                    $('#t-duree-max').text(result['statsDureeFonctionnement']['max']);
                                    {# //On gère la progression de la durée Max de fonctionnement du GE
                                                progress(prefixSelector='t-duree-max-progress-', progValue=result['statsDureeFonctionnement']['maxProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée Q1 de fonctionnement du GE
                                    $('#t-duree-Q1').text(result['statsDureeFonctionnement']['Q1']);
                                    {# //On gère la progression de la durée Q1 de fonctionnement du GE
                                                progress(prefixSelector='t-duree-Q1-progress-', progValue=result['statsDureeFonctionnement']['maxProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée Q3 de fonctionnement du GE
                                    $('#t-duree-Q3').text(result['statsDureeFonctionnement']['Q3']);
                                    {# //On gère la progression de la durée Q3 de fonctionnement du GE
                                                progress(prefixSelector='t-duree-Q3-progress-', progValue=result['statsDureeFonctionnement']['maxProgress'], posLogique=false, isTime=false); #}

                                    displayNewData(NPSChart, result['NPSchart']['date'], Object.values(result['NPSchart']['NPS']), [startDate, endDate], 1, 'day');
                                    //displayNewData(PowerProfile_Linechart, dateLabel, Object.values(result['Mix2']), date, 3, 'day');
                                    /*NPSChart.toggleSeries('Nombre de démarrage')
                                    NPSChart.toggleSeries('Nombre de démarrage')*/

                                    //Valeur de la durée total de fonctionnement du GE
                                    $('#t-nps-totale').text(result['statsNPS']['total']);
                                    {# //On gère la progression de la durée totale de fonctionnement du GE
                                                progress(prefixSelector='t-nps-totale-progress-', progValue=result['statsNPS']['totaleProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée moyen de fonctionnement du GE
                                    $('#t-nps-moy').text(result['statsNPS']['mean']);
                                    {# //On gère la progression de la durée moyenne de fonctionnement du GE
                                                progress(prefixSelector='t-nps-moy-progress-', progValue=result['statsNPS']['meanProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée Médian de fonctionnement du GE
                                    $('#t-nps-mediane').text(result['statsNPS']['median']);
                                    {# //On gère la progression de la durée Médiane de fonctionnement du GE
                                                progress(prefixSelector='t-nps-mediane-progress-', progValue=result['statsNPS']['medianProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée Min de fonctionnement du GE
                                    $('#t-nps-min').text(result['statsNPS']['min']);
                                    {# //On gère la progression de la durée Min de fonctionnement du GE
                                                progress(prefixSelector='t-nps-min-progress-', progValue=result['statsNPS']['minProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée Max de fonctionnement du GE
                                    $('#t-nps-max').text(result['statsNPS']['max']);
                                    {# //On gère la progression de la durée Max de fonctionnement du GE
                                                progress(prefixSelector='t-nps-max-progress-', progValue=result['statsNPS']['maxProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée Q1 de fonctionnement du GE
                                    $('#t-nps-Q1').text(result['statsNPS']['Q1']);
                                    {# //On gère la progression de la durée Q1 de fonctionnement du GE
                                                progress(prefixSelector='t-nps-Q1-progress-', progValue=result['statsNPS']['maxProgress'], posLogique=false, isTime=false); #}

                                    //Valeur de la durée Q3 de fonctionnement du GE
                                    $('#t-nps-Q3').text(result['statsNPS']['Q3']);
                                    {# //On gère la progression de la durée Q3 de fonctionnement du GE
                                                progress(prefixSelector='t-nps-Q3-progress-', progValue=result['NPSchart']['maxProgress'], posLogique=false, isTime=false); #}

                                    {% endif %}
                                }
                            },
                            error: function (result) {
                                // console.log("Error");
                                // console.log(result);
                                swal('Oops...', 'Something went wrong!', 'error'
                                // footer: '<a href>Why do I have this issue?</a>'
                                );
                                setTimeout(function () {
                                    resolve()
                                }, 5000);
                            }
                        });
                    })
                },
                allowOutsideClick: false
            }]);
        }

    </script>

    {% if zone.type == 'PUE Calculation' or zone.type == 'Air Conditioner'  %}
    <script src="/js/mqttws31.js" type="text/javascript"></script>

    {# Climate params script #}
    <script>
        var mess = {
            From: "user",
            To: "Devices",
            Object: "Connexion Status",
            message: ""
        };

        var isConnected = false;
        var wsbroker = "192.168.10.40";//location.hostname;  //mqtt websocket enabled broker
        var wsport = 15675; // port for above 1883

        var client = new Paho.MQTT.Client(wsbroker, wsport, "/ws", "user_{{app.user.id}}_" + parseInt(Math.random() * 100, 10) + parseInt(Math.random() * 100, 10));

        client.onConnectionLost = function (responseObject) {
            isConnected = false;
            console.log("CONNECTION LOST - " + responseObject.errorMessage);
        };

        client.onMessageArrived = function (message) {
            console.log("RECEIVE ON " + message.destinationName + " PAYLOAD " + message.payloadString);
            //print_first(message.payloadString);
            var result;
            var parse = true;
            try {
                result = JSON.parse(message.payloadString);
            } catch (e) {
                parse = false;
                console.error("Parsing error:", e);
            }

            if(parse){
                console.log("Received: " + message.payloadString);
                {% if zone.type == 'PUE Calculation' %}
                if (result.hasOwnProperty("Intemp")) {
                    $('#temp_indoor').text(String(result.Intemp))
                    $('#temp_outdoor').text(String(result.Outtemp))
                    $('#hum_indoor').text(String(result.Inhum))
                    $('#hum_outdoor').text(String(result.Outhum))
                    $('#update').text(String( moment( new Date(result.date) ).format("DD MMM YYYY HH:mm:ss")) )
                    
                }
                {% elseif zone.type == 'Air Conditioner' %}
                if (result.hasOwnProperty("dpstrv_0_1_1013")) {
                    $.each(result, function (key, value) {
                        console.log(String(value))
                        id = '#' + key
                        if(String(value) === 'off' || String(value) === 'Défaut' || String(value) === 'offline'){
                            if($(id).hasClass('badge-soft-success')){
                                $(id).toggleClass('badge-soft-success').toggleClass('badge-soft-pink')
                            }else if($(id).hasClass('badge-soft-pink') == false){
                                $(id).toggleClass('badge-soft-pink')
                            }
                        }

                        if(String(value) === 'online' || String(value) === 'on'){
                            if($(id).hasClass('badge-soft-pink')){
                                $(id).toggleClass('badge-soft-success').toggleClass('badge-soft-pink')
                            }else if($(id).hasClass('badge-soft-success') == false){
                                $(id).toggleClass('badge-soft-success')
                            }
                        }

                        $(id).text(String(value))
                    })
                }
                {% endif %}
            }
        };

        if (location.protocol == "https:") {
            options.useSSL = true;
        }
        //console.log("CONNECT TO " + wsbroker + ":" + wsport);
        //client.connect(options);
        //client.reconnect();
        // Try to reconnect after a few seconds
        setInterval(function () {
            if(isConnected === false){
                console.log("CONNECT TO " + wsbroker + ":" + wsport);
                client.connect({
                    timeout: 3,
                    keepAliveInterval: 30,
                    userName: "mqtt-ESP-device",
                    password: "mqtt-ESP-device",
                    onSuccess: function () {
                        isConnected = true;
                        console.log("CONNECTION SUCCESS");
                        //client.subscribe("/#", {qos: 1});
                        {% if zone.type == 'PUE Calculation' %}
                            client.subscribe("/from/raspb/#", {qos: 2});
                        {% elseif zone.type == 'Air Conditioner'  %}
                            client.subscribe("/from/stulz/#", {qos: 2});
                        {% endif %}
                    },
                    onFailure: function (message) {
                        console.log("CONNECTION FAILURE - " + message.errorMessage);
                    }
                });
            }
            else{
                //console.log("CONNECTED TO " + wsbroker + ":" + wsport);
            } 
        }, 10000);
    </script>
    {% endif %}
   
   {# Alarm panel script #}
   {# <script>
        var alarmTable = $('#datatable-buttons-alarm').DataTable({
            //sDom: 'lrtip',
            searching: true, 
            paging: true, 
            //info: false,
            ordering: false,
            lengthChange: false,
            //buttons: ['copy', 'excel', 'pdf', 'colvis']
            buttons: ['excel', 'pdf', 'colvis']
        });
        alarmTable.buttons().container().appendTo('#datatable-buttons-alarm_wrapper .col-md-6:eq(0)');
        
        var urlAlarmReport = "{{ path('update_alarm_report') }}";
        var start = moment().subtract(29, 'days');
        var end = moment();
        function cb(start, end) {
            $('#daterangeAlarm span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
        }
        $('#daterangeAlarm').daterangepicker({
            startDate: start,
            endDate: end,
            maxSpan: {
                "days": 31
            },
            maxDate: moment().endOf('month'),
            ranges: {
                'Today': [moment(), moment()],
                'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                'This Month': [moment().startOf('month'), moment().endOf('month')],
                'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
            }
        }, cb);
        
        $('#daterangeAlarm').on('apply.daterangepicker', function (ev, picker) {
            //console.log(picker.startDate.format('YYYY-MM-DD'));
            //console.log(picker.endDate.format('YYYY-MM-DD'));
        
            startDate = picker.startDate.format('YYYY-MM-DD');
            endDate = picker.endDate.format('YYYY-MM-DD');
            
            console.log('startDate = ' + startDate);
            console.log('endDate = ' + endDate);
            updateAlarmReport();
            // block of code that runs when the click event triggers
        });
        function updateAlarmReport(){
            
            $data = JSON.stringify({
                //"selectedDate": $dat,
                "startDate": startDate + ' 00:00:00',
                "endDate": endDate + ' 23:59:59',
                //"type": "zone",
                "zoneId": {{zone.id}},
            });
            // Danger
            swal.queue([{
                title: 'The report will be updated for the date range :',
                confirmButtonText: 'Confirm',
                text: 'From ' + startDate + ' To ' + endDate,
                showCancelButton: true,
                showLoaderOnConfirm: true,
                confirmButtonClass: 'btn btn-primary',
                cancelButtonClass: 'btn btn-danger ml-2',
                preConfirm: function () {
                    return new Promise(function (resolve) { 
                        
                        $.ajax({
                            type: "POST", // method type
                            contentType: "application/json; charset=utf-8",
                            url: urlAlarmReport, // /Target function that will be return result
                            data: $data, // parameter pass data is parameter name param is value
                            dataType: "json",
                            timeout: 120000, // 64241
                            success: function (result) {
                                // $('.fa-sync').removeClass('fa-spin');
                                console.log(result);
                                
                                swal({
                                    type: 'success', 
                                    title: 'The report have been updated !',
                                    // html: 'Submitted email: ' + email
                                });
                                setTimeout(function () {
                                    resolve()
                                }, 2000);
                                if( Object.keys(result).length > 0 ){
                                    //var dateLabel = Object.values(result['date']);
                                    //console.log(Object.values(result['CourbeCroisé']));
                                    //console.log(result);
                                    /*console.log(Object.values(result['SymI']));
                                    console.log(Object.values(result['SymV'])); */
                                                              
                                    
                                }
                            },
                            error: function (result) {
                                // console.log("Error");
                                // console.log(result);
                                swal('Oops...', 'Something went wrong!', 'error'
                                // footer: '<a href>Why do I have this issue?</a>'
                                );
                                setTimeout(function () {
                                    resolve()
                                }, 5000);
                            }
                        });
                    })
                },
                allowOutsideClick: false
            }]);
        }
   </script> #}
{% endblock %}